Introduction__. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .ix__PART I:PROGRAMMING__FUNDAMENTALS . . . . . . . . . . . . . . 1Chapter__1:Python__Basics . . . . . . . . . . . . . . . . . . . . . . . . . . . 3Chapter__2: if-elseand__FlowControl__. . . . . . . . . . . . . . . . . . . 27Chapter__3:Loops__. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49Chapter__4:Functions__. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73Chapter__5:Debugging__. . . . . . . . . . . . . . . . . . . . . . . . . . . 95Chapter__6:Lists__. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109Chapter__7:Dictionaries__andStructuring__Data . . . . . . . . . . . 139Chapter__8:Strings__andText__Editing . . . . . . . . . . . . . . . . . . 159PART__II:AUTOMATING__TASKS . . . . . . . . . . . . . . . . . . . . . 183Chapter__9:Text__PatternMatching__withRegular__Expressions . . 185Chapter__10:Reading__andWriting__Files . . . . . . . . . . . . . . . 217Chapter__11:Organizing__Files . . . . . . . . . . . . . . . . . . . . . . 243Chapter__12:Designing__andDeploying__CommandLine__Programs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 257Chapter__13:Web__Scraping . . . . . . . . . . . . . . . . . . . . . . . 289Chapter__14:Excel__Spreadsheets . . . . . . . . . . . . . . . . . . . . 331Chapter__15:Google__Sheets . . . . . . . . . . . . . . . . . . . . . . . 359Chapter__16:SQLite__Databases . . . . . . . . . . . . . . . . . . . . . 383Chapter__17:PDF__andWord__Documents . . . . . . . . . . . . . . . 413Chapter__18: CSV, JSON,and__XMLFiles__. . . . . . . . . . . . . . . 439Chapter__19:Keeping__Time,Scheduling__Tasks,and__LaunchingPrograms__. . . . . . . . . . . . . . . . . . . . . . . . . . 461Chapter__20:Sending__Email, Texts,and__PushNotifications__. . 481Chapter__21:Making__Graphsand__ManipulatingImages__. . . . 495Chapter__22:Recognizing__Textin__Images . . . . . . . . . . . . . . . 529Chapter__23:Controlling__theKeyboard__andMouse__. . . . . . . . 541Chapter__24: Text-to-Speechand__SpeechRecognition__Engines 567Appendix__A:Installing__Third-PartyPackages__. . . . . . . . . . . . 579Appendix__B:Answers__tothe__PracticeProblems__. . . . . . . . . . 583The__chaptersin__redare__includedin__thisIntroduction__Automatethe__BoringStuff__with Python, 3rdedition__(Introductionxi__Automatethe__BoringStuff__with Python, 3rdedition__(IntroductionAutomate__theBoring__Stuffwith__Python, 3rdedition__(Introductionxiii__Automatethe__BoringStuff__with Python, 3rdedition__(IntroductionAutomate__theBoring__Stuffwith__Python, 3rdedition__(Introductionxv__Automatethe__BoringStuff__with Python, 3rdedition__(chaptersof__PartI__in order,then__skippingto__thechapters__inPart__IIthat__interest you.Here__sa__briefrundown__ofwhat__youll__findin__each chapter.Part__I:Programming__FundamentalsChapter__1:Python__BasicsCovers__expressions,the__mostbasic__typeof__Python instruction,and__howto__usethe__Pythoninteractive__shellsoft__wareto__experimentwith__code.xvi__IntroductionAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2: if-elseand__FlowControl__Explainshow__tomake__programsdecide__whichinstructions__toexecute__sothat__yourcode__canintelligently__respondto__different conditions.Chapter__3:Loops__Explainshow__tomake__programsrepeat__instructionsa__setnumber__of times,or__foras__longas__acertain__condition holds.Chapter__4:Functions__Instructsyou__onhow__todefine__yourown__functions__sothat__youcan__organizeyour__codeinto__moremanageable__chunks.Chapter__5:Debugging__Showshow__touse__Pythons__various bug-findingand__bug-fixing tools.Chapter__6:Lists__Introducesthe__listdata__typeand__explainshow__toorganize__data.Chapter__7:Dictionaries__andStructuring__DataIntroduces__thediction__arydata__typeand__showsyou__morepowerful__waysto__organize data.Chapter__8:Strings__andText__EditingCovers__workingwith__textdata__(calledstrings__in Python).Part__II:Automating__TasksChapter__9:Text__PatternMatching__withRegular__ExpressionsCovers__howPython__canmanipulate__stringsand__searchfor__textpatterns__withregular__expressions.Chapter__10:Reading__andWriting__FilesExplains__howyour__programcan__readthe__contentsof__textfiles__andsave__informationto__fileson__yourhard__drive.Chapter__11:Organizing__FilesShows__howPython__can copy, move, rename,and__deletelarge__numbersof__filesmuch__fasterthan__ahuman__user can.Also__explainscompressing__anddecompressing__files.Chapter__12:Designing__andDeploying__CommandLine__ProgramsExplains__howyou__canpackage__yourPython__programsto__easilyrun__themeither__onyour__owncomputer__oron__co-workers computers.Chapter__13:Web__ScrapingShows__howto__writeprograms__thatcan__automaticallydownload__webpages__andparse__themfor__information.This__iscalled__web scraping.Chapter__14:Excel__SpreadsheetsCovers__programmaticallymanipu__latingExcel__spreadsheetsso__thatyou__dont__haveto__read them.This__ishelpful__whenthe__numberof__documentsyou__haveto__analyzeis__inthe__hundredsor__thousands.Chapter__15:Google__SheetsCovers__howto__readand__updateGoogle__Sheets,a__popular web-basedspreadsheet__application,using__Python.Chapter__16:SQLite__DatabasesExplains__howto__userelational__databases__with SQLite,the__tinybut__powerfulopen__sourcedatabase__thatcomes__with Python.Chapter__17:PDF__andWord__DocumentsCovers__programmaticallyreading__Wordand__PDF documents.Introduction__xviiAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18: CSV, JSON,and__XMLFiles__Continuesto__explainhow__toprogrammatically__manipulate documents,now__discussingthe__dataseri__alizationformats__CSV, JSON, XML, YAML,and__TOML.Chapter__19:Keeping__Time,Scheduling__Tasks,and__LaunchingPrograms__Explainshow__Pythonprograms__handletime__anddates__andhow__toschedule__yourcomputer__toperform__tasksat__certain times.Also__showshow__yourPython__programscan__launch non-Python programs.Chapter__20:Sending__Email, Texts,and__PushNotifications__Explainshow__towrite__programsthat__cannotify__youvia__emailor__mobilecommu__nications,or__sendthese__messagesto__others.Chapter__21:Making__Graphsand__ManipulatingImages__Explainshow__toprogrammatically__manipulate images,such__asJPEG__orPNG__files,and__workwith__theMatplotlib__graph-making library.Chapter__22:Recognizing__Textin__ImagesCovers__howto__extracttext__fromimages__andscanned__documentsfor__furtherprocessing__withthe__PyTesseract package.Chapter__23:Controlling__theKeyboard__andMouse__Explainshow__toprogrammatically__controlthe__mouseand__keyboardto__automateclicks__and keypresses.Chapter__24: Text-to-Speechand__SpeechRecognition__EnginesCovers__howto__useadvanced__computerscience__packagesto__notonly__generatespoken__audiofrom__text,but__alsoconvert__spokenaudio__to text.You__candownload__sourcecode__andother__resourcesfor__theexamples__inthis__bookat__https://nostarch .com /automate -boring -stuff -python -3rd -edition.To__seemany__ofthis__books__programsin__action,visit__https://autbor .com /3.Downloading__andInstalling__PythonYou__candownload__Pythonfor__Windows, macOS,and__UbuntuLinux__forfree__at https://python .org /downloads.The__downloadpage__detectsyour__operatingsystem__andrecommends__thedownload__packagefor__your computer.There__areunofficial__Pythoninstall__ersfor__Androidand__iOSmobile__operating systems,but__thoseare__beyondthe__scopeof__this book. Windows, macOS,and__Linuxhave__theirown__installation__optionsas__well.Download__theinstaller__foryour__operatingsystem__andrun__theprogram__toinstall__thePython__interpreter software.New__versionsof__Pythonor__youroperating__systemmay__changethe__stepsneeded__toinstall__Python.If__youencounter__difficulties,you__canconsult__https://autbor .com /install /for__up-to-date instructions.Downloading__andInstalling__MuWhile__thePython__interpreteris__thesoftware__thatruns__yourPython__programs,the__Mueditor__softwareis__whereyou__llenter__your programs,much__theway__youenter__textin__aword__processor.You__candownload__Mufrom__https://codewith .mu.xviii__IntroductionAutomate__theBoring__Stuffwith__Python, 3rdedition__(Introductionxix__Automatethe__BoringStuff__with Python, 3rdedition__(IntroductionAutomate__theBoring__Stuffwith__Python, 3rdedition__(Introductionxxi__Automatethe__BoringStuff__with Python, 3rdedition__(IntroductionAutomate__theBoring__Stuffwith__Python, 3rdedition__(chapterhas__afew__examplesthat__encourageyou__toenter__codeinto__theinteractive__shell,also__calledthe__read-evaluate-print-loop (REPL),which__letsyou__run (or execute)Python__instructionsone__ata__timeand__instantlyshows__youthe__results.Using__theinteractive__shellis__greatfor__learningwhat__basicPython__instructions do,so__giveit__atry__asyou__follow along.You__llremember__thethings__youdo__muchbetter__thanthe__thingsyou__only read. 1PYT__HONBA__SIC__S 4Chapter__1Automate__theBoring__Stuffwith__Python, 3rdedition__(Introductionprovides__setupinstructions__fordownloading__andinstalling__it.On__Windows,open__theStart__menu,enter__Mu,and__openthe__Mu app.On__macOS,open__yourApplications__folderand__double-click Mu.Click__theNew__buttonand__savean__emptyfile__as blank.py.When__yourun__thisblank__fileby__clickingthe__Runbutton__orpressing__F5,it__willopen__theinteractive__shell,which__willopen__asa__newpane__atthe__bottomof__theMu__editors__window.You__shouldsee__a >>>prompt__inthe__interactive shell.You__canalso__runthe__interactiveshell__fromthe__commandline__Terminal (onmacOS__and Linux)or__WindowsTerminal__(on Windows,where__youcould__alsouse__theolder__CommandPrompt__application).After__openingthese__commandline__windows,enter__python (on Windows)or__python3 (onmacOS__and Linux).You__llsee__thesame__>>>prompt__forthe__interactive shell.If__youwant__torun__a program,run__pythonor__python3followed__bythe__nameof__theprogram__s .py file,such__aspython__blank.py.Be__sureyou__dont__runpython__onmacOS__s Terminal,as__thismay__launchthe__older, backward-incompatiblePython__2.7version__oncertain__versionsof__macOS.You__mayeven__seea__message__saying WARNING:Python__2.7is__not recommended.Exit__the 2.7interactive__shelland__run python3 instead.Enter__2 + 2at__theprompt__tohave__Pythondo__somesimple__math.The__Muwindow__shouldnow__looklike__this: >>> 2 + 2 4 >>>In__Python, 2 + 2is__calledan__expression,which__isthe__mostbasic__kindof__programminginstruction__inthe__language.Expressions__consistof__values (suchas__2)and__operators (suchas__+),and__theycan__alwaysevaluate__(that is, reduce)down__toa__single value.That__meansyou__canuse__expressionsany__wherein__Pythoncode__thatyou__couldalso__usea__value.In__theprevious__example, 2 + 2is__evaluateddown__toa__single value, 4.A__singlevalue__withno__operatorsis__alsoconsidered__an expression,though__itevaluates__onlyto__itself,as__shown here: >>> 2 2The__Mueditor__hasa__REPLbutton__thatshows__aninteractive__shellwith__aprompt__thatlooks__likeIn__[1]:.The__popularJupyter__Notebookeditor__usesthis__kindof__interactive shell.You__canuse__thisinteractive__shellthe__sameway__asthe__normalPython__interactiveshell__withthe__>>> prompt.REPLs__arenot__uniqueto__Python;many__programminglanguages__alsooffer__REPLsso__thatyou__canexperiment__withtheir__code.Python__Basics 5Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8.You__maysee__theerror__message SyntaxError:unterminated__string literal,as__inthis__example: >>> 'Hello, world! SyntaxError:unterminated__stringliteral__(detectedat__line 1)This__errormeans__youprobably__forgotthe__final single-quotecharacter__atthe__endof__the string.String__Concatenationand__ReplicationThe__meaningof__anoperator__maychange__basedon__thedata__typesof__thevalues__nextto__it.For__example, +is__theaddition__operatorwhen__itoperates__ontwo__integersor__floating-point values. However,when__+is__usedto__combinetwo__string values,it__joinsthe__stringsas__thestring__concatenation operator.Enter__thefollowing__intothe__interactive shell: >>> 'Alice' + 'Bob' 'AliceBob'Python__Basics 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6explains__howa__nametag__attachedto__thevalue__mightbe__abetter__metaphor.Both__areshown__inFigure__1-1.Figure__1-1:The__codespam__= 42is__liketelling__the program,The__variablespam__nowhas__theinteger__value 42in__it.For__example,enter__thefollowing__intothe__interactive shell: 1 >>>spam__= 40 >>>spam__40 >>>eggs__= 2 2 >>>spam__+eggs__42 >>>spam__+eggs__+spam__82 3 >>>spam__=spam__+ 2 >>>spam__42A__variableis__initialized (or created)the__firsttime__avalue__isstored__init__1.After__that,you__canuse__itin__expressionswith__othervariables__andvalues__2.When__avariable__isassigned__anew__value 3,the__oldvalue__isfor__gotten,which__iswhy__spamevaluated__to 42instead__of 40at__theend__ofthe__example.This__iscalled__overwritingthe__variable.Enter__thefollowing__codeinto__theinteractive__shellto__tryoverwriting__a string: >>>spam__= 'Hello' >>>spam__PythonBasics__11Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3describes__functionsin__more detail.The__input()Function__The input()function__waitsfor__theuser__totype__sometext__onthe__keyboardand__press enter:my_name__= input('>')This__functioncall__evaluatesto__astring__identicalto__theuser__s text,and__therest__ofthe__codeassigns__themy_name__variableto__thisstring__value.The__'>'string__passedto__thefunction__causesthe__>prompt__to appear,which__servesas__anindicator__tothe__userthat__theyare__expectedto__enter something.Your__programs__dont__haveto__passa__stringto__the input() function;if__youcall__input(),the__programwill__waitfor__theuser__stext__withoutdisplaying__any prompt.THE__>AND__>>>PROMPTS__Youcan__passany__stringto__input()to__changethe__promptthat__appearswhen__yourprogram__runs.Calling__input('>')puts__anangle__bracket >on__thescreen__asthe__prompt.This__isdifferent__fromthe__>>>prompt__thatappears__inthe__Pythoninteractive__shell.In__this book,the__>>>prompt__indicatesa__responseto__thePython__interactiveshell__andthe__>prompt__indicatesa__responseto__aprogram__runningthe__input('>') call.My__choiceof__'>'was__arbitrary;you__canuse__anyprompt__youwant__orno__promptat__all.You__canthink__ofthe__input()function__callas__anexpression__thatevalu__atesto__whateverstring__theuser__typed.If__theuser__entered 'Al',the__assignment__statementwould__effectivelybe__my_name = 'Al'.If__youcall__input()and__seean__error message,like__NameError:name__'Al'is__not defined,the__problemis__thatyou__rerunning__thecode__withPython__2instead__ofPython__3.The__GreetingMessage__Thefollowing__callto__print()contains__theexpression__'Itis__goodto__meet you, ' +my_name__betweenthe__parentheses: print('Itis__goodto__meet you, ' + my_name) 16Chapter__1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21covers__imagedata__inmore__detail.)But__fora__short example,the__numbers 255, 0,and__255could__representa__pixelwith__themaximum__amountof__redand__bluebut__zero green,resulting__ina__purple pixel.Sound__ismade__upof__wavesof__compressedair__thatreach__our ears,which__ourbrains__interpretas__audio sensation.We__cangraph__theintensity__andfrequency__ofthese__wavesover__time.The__numberson__thisgraph__canthen__beconverted__tobinary__numbersand__storedon__a computer,which__latercon__trolspeakers__toreproduce__the sound.This__isa__simplificationof__howcom__puteraudio__works,but__describeshow__numberscan__representBeethoven__sSymphony__No. 5.The__datafor__severalimages__combineswith__audiodata__tostore__videos.All__formsof__informationcan__beencoded__intobinary__numbers.There__is,of__course,a__greatdeal__moredetail__toit__than this,but__thisis__how 1sand__0srep__resentthe__widevariety__ofdata__inour__information age.Summary__Youcan__computeexpressions__witha__calculatoror__enterstring__concatenations__witha__word processor.You__caneven__dostring__replicationeasily__bycopying__andpasting__text.But__expressions,and__theircomponent__values operators, variables,and__functioncalls__arethe__basicbuilding__blocksthat__makeup__programs.Once__youknow__howto__handlethese__elements,you__willbe__ableto__instructPython__tooperate__onlarge__amountsof__datafor__you. 24Chapter__1Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.I__introduceda__fewdifferent__functionsas__well.The__print()and__input()functions__handlesimple__textoutput__(tothe__screen)and__input (fromthe__keyboard).The__len()function__takesa__stringand__evaluatesto__anint__ofthe__numberof__charactersin__the string.The__str(), int(),and__float()functions__willevaluate__tothe__string, integer,or__floating-pointnumber__formof__thevalue__theyare__passed.The__round()function__returnsthe__rounded integer,and__the abs()function__returnsthe__absolutevalue__ofthe__arguments.In__thenext__chapter,you__lllearn__howto__tellPython__tomake__intelligentdecisions__aboutwhat__codeto__run,what__codeto__skip,and__whatcode__torepeat__basedon__thevalues__it has.This__isknown__asflow__control,and__itallows__youto__writeprograms__thatmake__intelligent decisions.Practice__Questions 1.Which__ofthe__followingare__operators,and__whichare__values? * 'hello' -88.8 - / + 5 2.Which__ofthe__followingis__a variable,and__whichis__a string?spam__'spam' 3.Name__threedata__types. 4.What__isan__expressionmade__up of?What__doall__expressions do? 5.This__chapterintroduced__assignment statements,like__spam = 10.What__isthe__differencebetween__anexpression__anda__statement? 6.What__doesthe__variablebacon__containafter__thefollowing__code runs?bacon__= 20bacon__+ 1 7.What__shouldthe__followingtwo__expressionsevaluate__to? 'spam' + 'spamspam' 'spam' * 3 8.Why__iseggs__avalid__variablename__while 100is__invalid?Python__Basics 25Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.Figure__2-1shows__aflowchart__forwhat__todo__ifit__s raining.Follow__thepath__madeby__thearrows__fromStart__to End.No__YesYes__NoNo__Go outside.Wait__a while.Start__EndIs__raining?Have__umbrella?Is__raining?Yes__Figure 2-1:A__flowchartto__tellyou__whatto__doif__itis__rainingIn__a flowchart,there__isusually__morethan__oneway__togo__fromthe__startto__the end.The__sameis__truefor__linesof__codein__acomputer__program.Flowcharts__representthese__branchingpoints__with diamonds,the__othersteps__with rectangles,and__thestarting__andending__stepswith__rounded rectangles.But__beforeyou__learnabout__flowcontrol__statements,you__firstneed__tolearn__howto__representthose__yesand__no options,and__youneed__tounder__standhow__towrite__thosebranching__pointsas__Python code.To__that end,let__sexplore__Boolean values,comparison__operators,and__Boolean operators.Boolean__ValuesWhile__the integer, floating-point,and__stringdata__typeshave__anunlimited__numberof__possible values,the__Booleandata__typehas__onlytwo__values:True__and False. (Booleanis__capitalizedbecause__thedata__typeis__namedafter__mathematicianGeorge__Boole.)When__enteredas__Python code,the__Booleanvalues__Trueand__Falselack__thequotation__marksyou__placearound__strings,and__theyalways__startwith__acapital__Tor__F,with__therest__ofthe__wordin__low ercase.Note__thatthese__Booleanvalues__dont__have quotes,because__theyare__If-elseand__FlowControl__29Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(chapters__hello.py program,Python__startedexecuting__instructions__atthe__topof__theprogram__going down,one__after another.Program__execution__(or simply, execution)is__aterm__forthe__currentinstruction__being executed.If__youput__yourfinger__oneach__lineon__yourscreen__asthe__lineis__executed,you__canthink__ofyour__fingeras__theprogram__execution.Not__allprograms__executeby__simplygoing__straight down, however.If__youuse__yourfinger__totrace__througha__programwith__flowcontrol__statements,you__lllikely__findyour__fingerjumping__aroundto__differentplaces__inthe__sourcecode__basedon__conditions. If-elseand__FlowControl__35Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 2Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1,I__showedhow__harddrive__andflash__memorymanufacturers__lieabout__theadvertised__capacitiesof__theirproducts__byusing__adifferent__definition__ofTB__and GB.Let__swrite__aprogram__tocalculate__howmisleading__theiradvertised__capacities are.Enter__thefollowing__codeinto__anew__fileand__saveit__as dishonestcapacity.py: print('EnterTB__orGB__forthe__advertised unit:')unit__= input('>') #Calculate__theamount__thatthe__advertisedcapacity__lies:if__unit == 'TB'or__unit == 'tb':discrepancy__= 1000000000000 / 1099511627776elif__unit == 'GB'or__unit == 'gb':discrepancy__= 1000000000 / 1073741824 print('Enterthe__advertised capacity:')advertised_capacity__= input('>')advertised_capacity__= float(advertised_capacity) #Calculate__thereal__capacity,round__itto__thenearest__hundredths, #and__convertit__toa__stringso__itcan__be concatenated:real_capacity__= str(round(advertised_capacity * discrepancy, 2)) print('Theactual__capacityis__' +real_capacity__+ ' ' + unit)This__programasks__theuser__toenter__whatunit__thehard__driveadvertises__itselfas__having,either__TBor__GB: #Calculate__theamount__thatthe__advertisedcapacity__lies:if__unit == 'TB'or__unit == 'tb':discrepancy__= 1000000000000 / 1099511627776elif__unit == 'GB'or__unit == 'gb':discrepancy__= 1000000000 / 1073741824TBs__arelarger__than GBs,and__thelarger__the unit,the__widerthe__discrepancy__betweenadvertised__andreal__capacities.The__ifand__elifstatements__usea__Booleanor__operatorso__thatthe__programworks__nomatter__whetherthe__46Chapter__2Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.)The__finalline__inthe__programdisplays__theactual__harddrive__capacityby__concatenatinga__messagestring__tothe__real_capacityand__unit strings: print('Theactual__capacityis__' +real_capacity__+ ' ' + unit)As__itturns__out,hard__drivesand__flashmemory__manufacturerslie__even more:I__havea__256GBSD__cardin__mylaptop__thatI__usefor__backups.In__real If-elseand__FlowControl__47Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,we__usedblocks__aspart__of if, elif,and__else statements,but__asyou__ll see,several__otherPython__statementsuse__blocksas__well.These__flowcontrol__statementswill__letyou__writemore__intelligent programs.Practice__Questions 1.What__arethe__twovalues__ofthe__Booleandata__type?How__doyou__write them? 2.What__arethe__threeBoolean__operators? 3.Write__outthe__truthtables__ofeach__Booleanoperator__(that is,every__possible__combinationof__Booleanvalues__forthe__operatorand__whatthey__evaluate to). 4.What__dothe__followingexpressions__evaluate to? (5 > 4)and__(3 == 5)not__(5 > 4) (5 > 4)or__(3 == 5)not__((5 > 4)or__(3 == 5)) (Trueand__True)and__(True == False) (not False)or__(not True) 5.What__arethe__sixcomparison__operators? 6.What__isthe__differencebetween__theequal__tooperator__andthe__assignment__operator? 7.Explain__whata__conditionis__andwhere__youwould__use one. 8.Identify__thethree__blocksin__this code:spam__= 0if__spam == 10: print('eggs')if__spam > 5: print('bacon') 48Chapter__2Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,you__learnedhow__tomake__programsrun__certainblocks__ofcode__whileskipping__others.But__theres__moreto__flowcontrol__than this.In__this chapter,you__lllearn__howto__repeatedlyexecute__blocksof__codeusing__loops.Python__stwo__kindsof__loops,while__and for,open__upthe__fullpower__of automation,because__theycan__runlines__ofcode__millionsof__timesper__second.You__llalso__learnhow__toimport__code libraries,called__modules,to__makeeven__morefunctions__availableto__your programs.while__LoopStatements__Youcan__makea__blockof__codeexecute__overand__overagain__usinga__while statement.The__codein__awhile__clausewill__beexecuted__aslong__asthe__3L__OOPS__50Chapter__3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.Practice__Questions 1.What__keyscan__youpress__ifyour__Pythonprogram__isstuck__inan__infinite loop? 2.What__isthe__differencebetween__breakand__continue?Loops__71Automate__theBoring__Stuffwith__Python, 3rdedition__(chapters,but__youcan__alsowrite__your own.In__this chapter,you__llcreate__func tions,explore__thecall__stackused__todetermine__theorder__inwhich__functionsin__aprogram__run,and__learnabout__thescope__ofvariables__insideand__outside functions.Creating__FunctionsTo__betterunderstand__howfunctions__work,let__screate__one.Enter__thispro__graminto__thefile__editorand__saveit__as helloFunc.py:def__hello(): #Prints__threegreetings__4F__UNC__TION__S 74Chapter__4Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter means.Return__Valuesand__returnStatements__Whenyou__callthe__len()function__andpass__itan__argumentsuch__as 'Hello',the__functioncall__evaluatesto__theinteger__value 5,which__isthe__lengthof__thestring__youpassed__it.In__general,the__valueto__whicha__functioncall__evaluatesis__calledthe__returnvalue__ofthe__function.When__creatinga__functionusing__thedef__statement,you__canspecify__thereturn__valuewith__areturn__statement,which__consistsof__the following:The__returnkeyword__Thevalue__orexpression__thatthe__functionshould__returnIn__thecase__ofan__expression,the__returnvalue__iswhatever__thisexpres__sionevaluates__to.For__example,the__followingprogram__definesa__functionthat__returnsa__differentstring__dependingon__thenumber__itis__passedas__an argument.Enter__thiscode__intothe__fileeditor__andsave__itas__magic8Ball.py: 1import__random 2def__get_answer(answer_number): #Returns__afortune__answerbased__onwhat__intanswer_number__is, 1to__9 3if__answer_number == 1:return__'Itis__certain'elif__answer_number == 2:return__'Itis__decidedly so'elif__answer_number == 3:return__'Yes'elif__answer_number == 4:return__'Replyhazy__try again'Functions__77Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapters 6and__7.For__now,just__knowthat__somefunctions__haveoptional__namedparameters__youcan__specifywhen__callingthe__function. 80Chapter__4Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptersin__thisbook__willshow__youseveral__moduleswith__functionsthat__werewritten__byother__people.While__youcan__takea__peekat__thesource__codeif__youre__curious,you__dont__needto__knowhow__thesefunctions__workin__orderto__use them.And__becausewrit__ingfunctions__withoutglobal__variablesis__encouraged,you__usuallydon__thave__toworry__aboutthe__functions__codeinteracting__withthe__restof__your program.Exception__HandlingRight__now,getting__an error,or__exception,in__yourPython__programmeans__theentire__programwill__crash.You__dont__wantthis__tohappen__in real-world programs. Instead,you__wantthe__programto__detect errors,handle__them,and__thencontinue__to run.For__example,consider__thefollowing__program,which__hasa__divide-by-zero error.Open__afile__editorwindow__andenter__thefollowing__code,saving__itas__zeroDivide.py:def__spam(divide_by):return__42 /divide_by__print(spam(2)) print(spam(12)) print(spam(0)) print(spam(1))We__vedefined__afunction__called spam,given__ita__parameter,and__thenprinted__thevalue__ofthat__functionwith__variousparameters__tosee__whathap__pens.This__isthe__outputyou__getwhen__yourun__theprevious__code: 21.0 3.5Traceback__(mostrecent__call last):File__"C:/zeroDivide.py",line__6,in__print(spam(0)) 88Chapter__4Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10you__lllearn__howto__readtext__from files.If__youspec__ifya__filenamefor__afile__thatdoesn__t exist,Python__raisesa__FileNotFoundError exception.You__mightwant__tohandle__thisexception__byasking__theuser__toenter__thefilename__againrather__thanhaving__thisunhandled__exceptionimmediately__crashyour__program.Errors__canbe__handledwith__tryand__except statements.The__codethat__couldpotentially__havean__erroris__putin__atry__clause.The__programexecu__tionmoves__tothe__startof__afollowing__exceptclause__ifan__error happens.You__canput__theprevious__divide-by-zerocode__ina__tryclause__andhave__anexcept__clausecontain__codeto__handlewhat__happenswhen__thiserror__occurs:def__spam(divideBy): try: #Any__codein__thisblock__thatcauses__ZeroDivisionError won'tcrash__the program:return__42 /divideBy__except ZeroDivisionError: #If__ZeroDivisionError happened,the__codein__thisblock__runs: print('Error:Invalid__argument.') print(spam(2)) print(spam(12)) print(spam(0)) print(spam(1))When__codein__atry__clausecauses__an error,the__programexecution__immediately__movesto__thecode__inthe__except clause.After__runningthat__code,the__executioncontinues__as normal.If__theprogram__doesnt__raisean__exceptionin__thetry__clause,the__programskips__thecode__inthe__except clause.The__outputof__theprevious__programis__as follows: 21.0 3.5 Error:Invalid__argument.None__42.0Note__thatany__errorsthat__occurin__functioncalls__ina__tryblock__willalso__be caught.Consider__thefollowing__program,which__insteadhas__the spam()calls__inthe__try block:def__spam(divideBy):return__42 /divideBy__Functions 89Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4Automate__theBoring__Stuffwith__Python, 3rdedition__(chapters,a__singleerror__couldcause__yourprograms__to crash.In__this chapter,you__learnedabout__tryand__except statements,which__canrun__codewhen__anerror__hasbeen__detected.This__canmake__yourprograms__moreresilient__tocommon__error cases.Practice__Questions 1.Why__arefunctions__advantageousto__havein__your programs? 2.When__doesthe__codein__afunction__execute:when__thefunction__isdefined__orwhen__thefunction__is called? 3.What__statementcreates__a function? 4.What__isthe__differencebetween__afunction__anda__function call? 5.How__manyglobal__scopesare__therein__aPython__program?How__manylocal__scopesare__there? 6.What__happensto__variablesin__alocal__scopewhen__thefunction__call returns? 7.What__isa__return value?Can__areturn__valuebe__partof__an expression? 8.If__afunction__doesnot__havea__return statement,what__isthe__returnvalue__ofa__callto__that function? 9.How__canyou__forcea__variablein__afunction__torefer__tothe__global variable? 10.What__isthe__datatype__of None? 11.What__doesthe__importareallyourpetsnamederic__statement do? 12.If__youhad__afunction__named bacon()in__amodule__named spam,how__wouldyou__callit__afterimporting__spam? 13.How__canyou__preventa__programfrom__crashingwhen__itgets__an error? 14.What__goesin__thetry__clause?What__goesin__theexcept__clause? 15.Write__thefollowing__programin__afile__named notrandomdice.pyand__run it.Why__doeseach__functioncall__returnthe__same number?import__randomrandom_number__= random.randint(1, 6)def__get_random_dice_roll(): #Returns__arandom__integerfrom__1to__6.return__random_number 94Chapter__4Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__sometools__andtechniques__forfinding__theroot__causeof__bugsin__yourprogram__tohelp__youfix__themmore__quicklyand__withless__effort.To__paraphrasean__oldjoke__among programmers,writing__codeaccounts__for 90percent__of programming.Debugging__codeaccounts__forthe__other 90 percent.Your__computerwill__doonly__whatyou__tellit__to do;it__wont__readyour__mindand__dowhat__youintended__itto__do.Even__professionalprogrammers__createbugs__allthe__time,so__dont__feeldiscouraged__ifyour__programhas__a problem. Fortunately,a__fewtools__andtechniques__canidentify__exactlywhat__yourcode__isdoing__andwhere__its__going wrong.You__lluse__the debugger,a__featureof__Muthat__executesa__programone__instructionat__a time,giving__youa__chanceto__inspectthe__valuesin__variableswhile__yourcode__runs,and__track 5DE__BUGG__ING 96Chapter__5Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4,you__handledPython__sexceptions__withtry__andexcept__statementsso__thatyour__programcould__recoverfrom__exceptionsyou__anticipated.But__youcan__alsoraise__yourown__exceptionsin__your code.Raising__anexception__isa__wayof__saying,Stop__runningthis__code,and__movethe__programexecution__tothe__except statement.We__raiseexceptions__witha__raise statement,which__consistsof__the following:The__raisekeyword__Acall__tothe__Exception()function__Astring__witha__helpfulerror__messagepassed__tothe__Exception()function__For example,enter__thefollowing__intothe__interactive shell: >>>raise__Exception('Thisis__theerror__message.')Traceback__(mostrecent__call last):File__"",line__1,in__raise Exception('Thisis__theerror__message.') Exception:This__isthe__error message.If__notry__andexcept__statementscover__theraise__statementthat__raisedthe__exception,the__programsimply__crashesand__displaysthe__exceptions__error message. Often,it__sthe__codethat__callsthe__functioncontaining__araise__statement,rather__thanthe__function itself,that__knowshow__tohandle__an exception.That__meansyou__llcommonly__seea__raisestatement__insidea__function,and__thetry__andexcept__statementsin__thecode__callingthe__function.For__example,open__anew__fileeditor__tab,enter__thefollowing__code,and__savethe__programas__boxPrint.py:def__box_print(symbol, width, height):if__len(symbol) != 1: 1raise__Exception('Symbolmust__bea__singlecharacter__string.')if__width <= 2: 2raise__Exception('Widthmust__begreater__than 2.')if__height <= 2: 3raise__Exception('Heightmust__begreater__than 2.')Debugging__97Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 5Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 5Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__somedictionary__valueyou__needto__seeto__helpwith__debugging;use__alog__messagefor__somethinglike__that.For__errormessages__thatthe__usershould__see,like__Filenot__foundor__Invalid input,please__entera__number,use__a print() call.You__dont__wantto__deprivethe__userof__helpfulinformation__theycan__useto__solvetheir__problem.Logging__LevelsLogging__levelsprovide__away__tocategorize__yourlog__messagesby__importance__sothat__youcan__filterless__importantmessages__whiletesting__yourpro__grams.There__arefive__logging levels,described__inTable__5-1from__leastto__most important.Your__programcan__logmessages__ateach__levelusing__different__logging functions.Table__5-1:Logging__Levelsin__PythonLevel__Loggingfunction__DescriptionDEBUG__logging.debug()The__lowest level,used__forsmall__details. Usually,you__llcare__aboutthese__messagesonly__whendiag__nosing problems.INFO__logging .info()Used__torecord__informationabout__generalevents__inyour__programor__toconfirm__thatit__sworking__atvarious__points.WARNING__logging.warning()Used__toindicate__apotential__problemthat__doesnt__preventthe__programfrom__workingbut__mightdo__soin__the future.ERROR__logging.error()Used__torecord__anerror__thatcaused__theprogram__tofail__todo__something.CRITICAL__logging.critical()The__highest level,used__toindicate__afatal__errorthat__has caused,or__isabout__to cause,the__program__tostop__running entirely. 102Chapter__5Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.)If__youre__donedebugging__andwant__theprogram__tocontinue__normally,click__theContinue__button.Clicking__theStep__Inbutton__willcause__thedebugger__toexecute__thenext__lineof__codeand__thenpause__again.If__thenext__lineof__codeis__afunction__call,the__debuggerwill__stepinto__that function,jumping__tothe__functions__firstline__of code.Clicking__theStep__Overbutton__willexecute__thenext__lineof__code,similar__tothe__StepIn__button. However,if__thenext__lineof__codeis__afunction__call, 104Chapter__5Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 5Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 5Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,I__lldiscuss__thebasics__of lists.I__llalso__teachyou__about methods,which__arefunctions__thatare__tiedto__valuesof__acertain__data type. Then,I__llbriefly__coverthe__sequencedata__types (lists, tuples,and__strings)and__showtheir__differences.In__thenext__chapter,I__llintroduce__youto__thedictionary__data type. 6LISTS__110Chapter__6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3,you__learnedabout__usingfor__loopsto__executea__blockof__codea__certainnumber__of times. Technically,a__forloop__repeatsthe__codeblock__oncefor__eachitem__ina__list value.For__example,if__youran__thiscode__fori__in range(4): print(i) 116Chapter__6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4s__magic8ball.py program.Instead__ofseveral__linesof__nearlyidentical__elifstate__ments,you__cancreate__asingle__listthat__thecode__works with.Open__anew__fileeditor__windowand__enterthe__following code.Save__itas__magic8Ball2.py:import__randommessages__= ['Itis__certain', 'Itis__decidedly so', 'Yes definitely', 'Replyhazy__try again', 'Askagain__later', 'Concentrateand__ask again', 'Myreply__is no', 'Outlooknot__so good', 'Very doubtful'] print('Aska__yesor__no question:') input('>') print(messages[random.randint(0, len(messages) - 1)])When__yourun__it,you__llsee__thatit__worksthe__sameas__theprevious__magic8Ball.py program.The__random.randint(0, len(messages) - 1)call__producesa__randomnum__berto__usefor__the index,regardless__ofthe__sizeof__messages.That__is,you__llget__arandom__numberbetween__0and__thevalue__of len(messages) - 1.The__benefitof__thisapproach__isthat__youcan__easilyadd__andremove__stringsto__andfrom__themessages__listwithout__changingother__linesof__code.If__youlater__updateyour__code,you__llhave__tochange__fewer lines,producing__fewerchances__foryou__tointroduce__bugs.Selecting__arandom__itemfrom__alist__iscommon__enoughthat__Pythonhas__the random.choice(messages)function__thatdoes__thesame__thingas__random.rand__int(0, len(messages) 1).Sequence__DataTypes__Listsaren__tthe__onlydata__typesthat__representordered__sequencesof__values.For__example,strings__andlists__areactually__similarif__youconsider__astring__to 126Chapter__6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsdon__t change,Python__canimplement__optimizationsthat__makecode__usingtuples__slightlyfaster__thancode__using lists.List__andTuple__TypeConversion__Justas__str(42)will__return '42',the__stringrepresentation__ofthe__integer 42,the__functions list()and__tuple()will__returnlist__andtuple__versionsof__thevalues__passedto__them.Enter__thefollowing__intothe__interactive shell,and__noticethat__thereturn__valueis__ofa__differentdata__typethan__thevalue__passed: >>> tuple(['cat', 'dog', 5]) ('cat', 'dog', 5) >>> list(('cat', 'dog', 5)) ['cat', 'dog', 5] >>> list('hello') ['h', 'e', 'l', 'l', 'o']Converting__atuple__toa__listis__handyif__youneed__amutable__versionof__atuple__value.Lists__129Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7),this__meansthe__codein__thefunction__modifiesthe__originalvalue__in place.To__seethe__consequences__ofthis__fact,open__anew__fileeditor__window,enter__thefollowing__code,and__saveit__as passingReference.py:def__eggs(some_parameter): some_parameter.append('Hello')spam__= [1, 2, 3] eggs(spam) print(spam) #Prints__[1, 2, 3, 'Hello']Lists__131Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6Automate__theBoring__Stuffwith__Python, 3rdedition__(contentscan__change.Tuples__and strings,though__alsosequence__data types,are__immutable__andcannot__be changed.We__canoverwrite__avariable__thatcontains__atuple__orstring__valuewith__anew__tupleor__string value,which__isnt__thesame__thingas__modifyingthe__existingvalue__inplace__as, say,the__append()or__remove()method__doeson__lists.Variables__dont__storelist__values directly;they__storereferences__to lists.This__isan__importantdistinction__whenyou__recopying__variablesor__passinglists__asarguments__infunction__calls.Because__thevalue__thatis__beingcopied__isthe__list reference,be__awarethat__anychanges__youmake__tothe__listmight__impactanother__variablein__your program.You__canuse__copy()or__deepcopy()if__youwant__tomake__changesto__alist__inone__variablewithout__modifyingthe__original list. 136Chapter__6Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__thedictionary__data type,which__providesa__flexibleway__toaccess__andorganize__data.By__combiningdictionaries__withyour__knowledgeof__listsfrom__theprevious__chap ter,you__llalso__learnhow__tocreate__adata__structureto__modela__chessboard.The__DictionaryData__TypeLike__a list,a__dictionaryis__amutable__collectionof__many values.But__unlikeindexes__for lists,indexes__fordictionaries__canuse__manydifferent__data types,not__just integers.These__dictionaryindexes__arecalled__keys,and__akey__withits__associatedvalue__iscalled__a key-value pair.In__code,a__dictionaryis__enteredbetween__curlybrackets__({}).Enter__thefollowing__intothe__interactive shell: >>>my_cat__= {'size': 'fat', 'color': 'gray', 'age': 17} 7DIC__TION__AR__IESAND__ST__RUCTUR__INGDATA__140Chapter__7Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10.Returning__Keysand__ValuesThree__dictionarymethods__willreturn__list-likevalues__ofthe__dictionarys__keys, values,or__bothkeys__and values: keys(), values(),and__items().The__values__returnedby__thesemethods__arent__true lists:they__cant__bemodified__anddon__thave__an append() method.But__thesedata__types (dict_keys, dict_values,and__dict_items, respectively)can__beused__infor__loops.To__seehow__thesemeth__ods work,enter__thefollowing__intothe__interactive shell: >>>spam__= {'color': 'red', 'age': 42} >>>for__vin__spam.values(): ... print(v)red__42 Here,a__forloop__iteratesover__eachof__thevalues__inthe__spam dictionary.A__forloop__canalso__iterateover__thekeys__orboth__thekeys__and values: >>>for__kin__spam.keys(): ... print(k)color__age >>> 'color'in__spam.keys()True__>>> 'age'not__in spam.keys()False__>>> 'red'in__spam.values()True__>>>for__iin__spam.items(): ... print(i) ('color', 'red') ('age', 42)When__youuse__the keys(), values(),and__items() methods,a__forloop__caniterate__overthe__keys, values,or__key-valuepairs__ina__dictionary, respectively,and__youcan__usethe__inand__notin__operatorsto__determineif__avalue__existsas__akey__orvalue__inthe__dictionary.Notice__thatthe__valuesin__thedict_items__valuereturned__bythe__items()method__aretuples__ofthe__keyand__value.Dictionaries__andStructuring__Data 143Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter:BOARD_TEMPLATE__= """a__bc__de__fg__h________________________________________ |||||| |||||| |||||| |||||| | 8 ||{}|| {} ||{}|| {} ||{}|| {} ||{}|| {} | ||||||____||||||____||||||____||||||____| | |||||| |||||| |||||| |||||| 7 | {} ||{}|| {} ||{}|| {} ||{}|| {} ||{}|| |____||||||____||||||____||||||____|||||| |||||| |||||| |||||| |||||| | 6 ||{}|| {} ||{}|| {} ||{}|| {} ||{}|| {} | ||||||____||||||____||||||____||||||____| | |||||| |||||| |||||| |||||| 150Chapter__7Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.Let__stake__alook__atthe__codein__print_chessboard():def__print_chessboard(board):squares__= []is_white_square__=True__fory__in '87654321':for__xin__'abcdefgh': #print(x, y, is_white_square) # DEBUG:Show__coordinatesThere__are 64squares__ona__chessboardand__64 {}pairs__inthe__BOARD_TEMPLATE__string.We__mustbuild__upa__listof__64strings__toreplace__these {} pairs.We__storethis__listin__thesquares__variable.The__stringsin__thislist__represent__eitherchess__pieces,like__'wB'and__'bQ',or__empty squares.Depending__onwhether__theempty__squareis__whiteor__black,we__mustuse__theWHITE_SQUARE__string ('||')or__theBLACK_SQUARE__string (' ').We__lluse__aBoolean__valuein__theis_white_square__variableto__keeptrack__ofwhich__squaresare__whiteand__whichare__black.Two__nestedfor__loopswill__loopover__all 64squares__onthe__board,start__ingwith__the upper-leftsquare__andgoing__rightto__left,then__topto__bottom.The__squarein__theupper__leftis__awhite__square,so__well__startis_white_square__Dictionariesand__StructuringData__151Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.Lists__anddictionaries__arevalues__thatcan__containmultiple__values,including__otherlists__anddic__tionaries.Dictionaries__areuseful__becauseyou__canmap__oneitem__(the key)to__anotheritem__(the value),whereas__listssimply__containa__seriesof__valuesin__order.Code__canaccess__valuesinside__adictionary__usingsquare__bracketsjust__aswith__lists.Instead__ofinteger__indexes,dictionaries__canhave__keysof__avariety__ofdata__types: integers, floats, strings,or__tuples.By__organizinga__program__svalues__intodata__structures,you__cancreate__representationsof__real-world__objects,such__asthe__chessboardmodeled__inthis__chapter.Practice__Questions 1.What__doesthe__codefor__anempty__dictionarylook__like? 2.What__doesa__dictionaryvalue__witha__key 'foo'and__avalue__42look__like? 3.What__isthe__maindifference__betweena__dictionaryand__a list? 4.What__happensif__youtry__toaccess__spam['foo']if__spamis__{'bar': 100}? 5.If__adictionary__isstored__in spam,what__isthe__differencebetween__theexpressions__'cat'in__spamand__'cat'in__spam.keys()? 6.If__adictionary__isstored__in spam,what__isthe__differencebetween__theexpressions__'cat'in__spamand__'cat'in__spam.values()? 7.What__isa__shortcutfor__thefollowing__code?if__'color'not__in spam: spam['color'] = 'black' 8.What__moduleand__functioncan__beused__to pretty-printdictionary__values? 156Chapter__7Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,we__usedthe__dictionaryvalue__{'h1': 'bK', 'c6': 'wQ', 'g2': 'bB', 'h5': 'bQ', 'e3': 'wK'}to__representa__chessboard.Write__afunction__named isValidChessBoard()that__takesa__dictionaryargument__andreturns__Trueor__Falsedepending__onwhether__theboard__is valid.A__validboard__willhave__exactlyone__blackking__andexactly__onewhite__king.Each__playercan__haveat__most 16 pieces,of__whichonly__eightcan__be pawns,and__allpieces__mustbe__ona__validsquare__from '1a'to__'8h'.That__is,a__piececan__tbe__onsquare__'9z'.The__piecenames__shouldbegin__witheither__a 'w'or__a 'b'to__representwhite__or black,followed__by 'pawn', 'knight', 'bishop', 'rook', 'queen',or__'king'.This__functionshould__detectwhen__abug__hasresulted__inan__improper chessboard. (Thisisn__tan__exhaustivelist__of requirements,but__itis__closeenough__forthis__exercise.)Fantasy__GameInventory__Sayyou__recreating__amedieval__fantasyvideo__game.The__datastructure__tomodel__theplayer__sinventory__isa__dictionarywhose__keysare__stringsdescribing__theitem__inthe__inventoryand__whosevalues__areintegers__detailinghow__manyof__thatitem__theplayer__has.For__example,the__dictionaryvalue__{'rope': 1, 'torch': 6, 'gold coin': 42, 'dagger': 1, 'arrow': 12}means__theplayer__hasone__rope,six__torches, 42gold__coins,and__so on.Write__afunction__named display_inventory()that__wouldtake__anypossible__inventoryand__displayit__likethe__following: Inventory: 12arrow__42gold__coin 1rope__6torch__1dagger__Totalnumber__of items: 62 Hint:You__canuse__afor__loopto__loopthrough__allkeys__ina__dictionary.stuff__= {'rope': 1, 'torch': 6, 'gold coin': 42, 'dagger': 1, 'arrow': 12}def__display_inventory(inventory): print("Inventory:")item_total__= 0for__k,v__in inventory.items(): #FILL__THISPART__IN print("Totalnumber__of items: " + str(item_total)) display_inventory(stuff)Dictionaries__andStructuring__Data 157Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,you__lllearn__allof__thisand__more. Then,you__llwork__througha__programmingproject__toautomate__theboring__choreof__addingbullet__pointsto__text. 8STR__INGS__ANDTEXTEDI__TING__160Chapter__8Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.Multiline__StringsWhile__youcan__usethe__\nescape__characterto__inserta__newlineinto__a string,it__soften__easierto__usemultiline__strings.A__multilinestring__inPython__begins 162Chapter__8Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(contents,the__paste()function__willreturn__thatother__value.For__example,if__Icopied__thissentence__tothe__clipboardand__thencalled__paste(),it__wouldlook__like this: >>> pyperclip.paste() 'For example,if__Icopied__thissentence__tothe__clipboardand__thencalled__paste(),it__wouldlook__like this:'The__clipboardis__anexcellent__wayto__enterand__receivelarge__amountsof__textwithout__havingto__typeit__whenprompted__byan__input() call.For__example,say__youwant__aprogram__toturn__textinto__aLtErNaTiNgupper__caseand__lowercase letters.You__cancopy__thetext__youwant__toalternate__tothe__clipboard,and__thenrun__this program,which__takesthis__textand__putsthe__alternating-casetext__onthe__clipboard.Enter__thefollowing__codeinto__afile__named alternatingText.py:import__pypercliptext__= pyperclip.paste() #Get__thetext__offthe__clipboard.alt_text__= '' #This__stringholds__thealternating__case.make_uppercase__=False__forcharacter__in text: #Go__througheach__characterand__addit__to alt_text:if__make_uppercase:alt_text__+= character.upper() else:alt_text__+= character.lower() #Set__make_uppercaseto__itsopposite__value:make_uppercase__=not__make_uppercase 174Chapter__8Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsbecome__this:iF__YoUCoPy__sOmETeXt__tOThE__ClIpBoArD (fOr iNsTaNcE,tHiS__SeNtEnCe)AnD__RuNThIs__pRoGrAm,ThE__OuTpUtaNd__cLiPbOaRdcOnTeNtS__BeCoMe ThIs:The__pyperclipmodule__sability__tointeract__withthe__clipboardgives__youa__straightforwardway__toinput__andoutput__textto__andfrom__your programs.Project__2:Add__Bulletsto__WikiMarkup__Whenediting__aWikipedia__article,you__cancreate__abulleted__listby__puttingeach__listitem__onits__ownline__andplacing__astar__infront__of it.But__sayyou__havea__reallylarge__listthat__youwant__toadd__bulletpoints__to.You__couldtype__thosestars__atthe__beginningof__each line,one__by one.Or__youcould__automate__thistask__witha__shortPython__script.The__bulletPointAdder.pyscript__willget__thetext__fromthe__clipboard,add__astar__andspace__tothe__beginningof__each line,and__thenpaste__thisnew__textto__the clipboard.For__example,say__Icopied__thefollowing__text (forthe__Wikipediaarticle__Listof__Listsof__Lists )to__the clipboard:Lists__ofanimals__Listsof__aquariumlife__Listsof__biologistsby__authorabbreviation__Listsof__cultivars Then,if__Iran__the bulletPointAdder.py program,the__clipboardwould__containthe__following: *Lists__ofanimals__*Lists__ofaquarium__life *Lists__ofbiologists__byauthor__abbreviation *Lists__ofcultivars__This star-prefixedtext__isready__tobe__pastedinto__aWikipedia__articleas__abulleted__list.Step__1:Copy__andPaste__fromthe__ClipboardYou__wantthe__bulletPointAdder.pyprogram__todo__the following:Paste__textfrom__the clipboard.Do__somethingto__it.Copy__thenew__textto__the clipboard.Manipulating__thetext__isa__little tricky,but__copyingand__pastingare__pretty straightforward:they__justinvolve__thepyperclip__.copy()and__pyperclip.paste()Strings__andText__Editing 175Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.Enter__thefollowing__sourcecode__intothe__file editor,and__savethe__fileas__pigLat.py: #English__topig__latin print('Enterthe__Englishmessage__totranslate__intopig__latin:')message__= input()VOWELS__= ('a', 'e', 'i', 'o', 'u', 'y')pigLatin__= [] #A__listof__thewords__inpig__latinfor__wordin__message.split(): #Separate__the non-lettersat__thestart__ofthis__word:Strings__andText__Editing 177Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10.That__justabout__coversall__thebasic__conceptsof__Python programming!You__llcontinue__tolearn__newconcepts__throughoutthe__restof__this book,but__younow__knowenough__tostart__writingsome__usefulprograms__thatcan__automate tasks.If__youd__liketo__seea__collectionof__short,simple__Pythonprograms__builtfrom__thebasic__conceptsyou__velearned__so far,you__canread__myother__book,The__BigBook__ofSmall__PythonProjects__(chapter,you__lllearn__howto__writereal__programsto__douseful__automated tasks.Practice__Questions 1.What__areescape__characters? 2.What__dothe__\nand__\tescape__characters represent? 3.How__canyou__puta__\backslash__characterin__a string? 4.The__stringvalue__"Howl'sMoving__Castle"is__avalid__string.Why__isnt__ita__problem__thatthe__singlequote__characterin__theword__Howl'sisn__t escaped? 5.If__youdon__twant__toput__\nin__your string,how__canyou__writea__stringwith__newlinesin__it? 6.What__dothe__followingexpressions__evaluate to? 'Hello, world!'[1] 'Hello, world!'[0:5] 'Hello, world!'[:5] 'Hello, world!'[3:]Strings__andText__Editing 181Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,you__llstart__bywriting__aprogram__tofind__textpatterns__withoutusing__regularexpressions__andthen__learnhow__touse__regularexpres__sionsto__makethe__code simpler.I__llshow__youbasic__matchingwith__regular expressions,then__moveon__tosome__morepowerful__features,such__asstring__substitutionand__creatingyour__owncharacter__classes.You__llalso__learnhow__touse__theHumre__module,which__offers plain-Englishsubstitutes__forregular__expressionscryptic__symbol-based syntax.Finding__TextPatterns__WithoutRegular__ExpressionsSay__youwant__tofind__aUS__phonenumber__ina__string;you__relooking__forthree__numbers,a__hyphen,three__numbers,a__hyphen,and__four numbers.Here__san__example: 415-555-4242.Let__swrite__afunction__named is_phone_number()to__checkwhether__astring__matchesthis__patternand__returneither__Trueor__False.Open__anew__fileeditor__taband__enterthe__following code,then__savethe__fileas__isPhoneNumber.py:def__is_phone_number(text): 1if__len(text) != 12: #Phone__numbershave__exactly 12 characters.return__Falsefor__iin__range(0, 3): #The__firstthree__charactersmust__be numbers. 2if__not text[i].isdecimal():return__False 3if__text[3] != '-': #The__fourthcharacter__mustbe__a dash.return__Falsefor__iin__range(4, 7): #The__nextthree__charactersmust__be numbers. 4if__not text[i].isdecimal():return__False 5if__text[7] != '-': #The__eighthcharacter__mustbe__a dash.return__Falsefor__iin__range(8, 12): #The__nextfour__charactersmust__be numbers. 6if__not text[i].isdecimal():return__False 7return__TrueText__PatternMatching__withRegular__Expressions 187Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterwill__requirethe__re module,so__rememberto__importit__atthe__beginningof__the program. Otherwise,you__llget__a NameError:name__'re'is__notdefined__error message.As__withimporting__any module,you__needto__importit__onlyonce__perprogram__orinteractive__shell session.Passing__theregular__expressionstring__tore__.compile()returns__aPattern__object.You__onlyneed__tocompile__thePattern__object once;after__that,you__cancall__thePattern__objects__search()method__foras__manydifferent__textstrings__asyou__want.A__Patternobject__s search()method__searchesthe__stringit__ispassed__forany__matchesto__the regex.The__search()method__willreturn__Noneif__theregex__pattern__isnt__foundin__the string.If__thepattern__is found,the__search()method__returnsa__Match object,which__willhave__a group()method__thatreturns__astring__ofthe__matched text.NOTE__WhileI__encourageyou__toenter__theexample__codeinto__theinteractive__shell,you__couldalso__makeuse__of web-basedregular__expression testers,which__canshow__youexactly__howa__regexmatches__apiece__oftext__thatyou__enter.I__recommendthe__testersat__https://pythex__.organd__https://regex101 .com.Different__programminglanguages__haveslightly__differentregular__expression syntax,so__besure__toselect__thePython__flavoron__these websites.The__Syntaxof__RegularExpressions__Nowthat__youknow__thebasic__stepsfor__creatingand__findingregular__expression__objectsusing__Python,you__reready__tolearn__thefull__rangeof__regularexpression__syntax.In__this section,you__lllearn__howto__groupregular__expression__elementstogether__with parentheses,escape__special characters,match__severalalternative__groupswith__thepipe__character,and__returnall__matcheswith__the findall() method.Grouping__withParentheses__Sayyou__wantto__separateone__smallerpart__ofthe__matched text,such__asthe__area code,from__therest__ofthe__phonenumber__(to,for__example,perform__someoperation__on it).Adding__parentheseswill__creategroups__inthe__regex 190Chapter__9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterhas__covereda__lotof__notationso__far,so__heres__aquick__reviewof__whatyou__velearned__aboutbasic__regularexpression__syntax:The__?matches__zeroor__oneinstance__ofthe__preceding qualifier.The__*matches__zeroor__moreinstances__ofthe__preceding qualifier.The__+matches__oneor__moreinstances__ofthe__preceding qualifier.The__{n}matches__exactlyn__instancesof__thepreceding__qualifier.The__{n,}matches__nor__moreinstances__ofthe__preceding qualifier.The__{,m}matches__0to__minstances__ofthe__preceding qualifier.The__{n,m}matches__atleast__nand__atmost__minstances__ofthe__preceding qualifier. {n,m}?or__*?or__+?performs__a non-greedymatch__ofthe__preceding qualifier. ^spammeans__thestring__mustbegin__with spam. spam$means__thestring__mustend__with spam.The__.matches__any character,except__newline characters.The__\d, \w,and__\smatch__a digit, word,or__space character, respectively.The__\D, \W,and__\Smatch__anythingexcept__a digit, word,or__spacecharac__ter, respectively. [abc]matches__anycharacter__betweenthe__squarebrackets__(suchas__a, b,or__c). [^abc]matches__anycharacter__thatisn__tbetween__thesquare__brackets. (Hello)groups__'Hello'together__asa__single qualifier.Text__PatternMatching__withRegular__Expressions 203Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,to__improvethe__readabilityof__yourregular__expressions.Text__PatternMatching__withRegular__Expressions 205Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.The__functionsand__constantsin__Humrecan__producethe__sameregex__stringwith__plain English: >>>from__humreimport__* >>>phone_regex__= exactly(3, DIGIT) + '-' + exactly(3, DIGIT) + '-' + exactly(4, DIGIT) >>>phone_regex__'\\d{3}-\\d{3}-\\d{4}'Humre__sconstants__(like DIGIT)contain__strings,and__Humres__functions__(like exactly())return__strings.Humre__doesnt__replacethe__re module. Rather,it__producesregex__stringsthat__canbe__passedto__re .compile(): >>>import__re >>>pattern__=re__.compile(phone _regex) >>> pattern.search('Mynumber__is 415-555-4242')Humre__hasconstants__andfunctions__foreach__featureof__regularexpres__sion syntax.You__canthen__concatenatethe__constantsand__returnedstrings__likeany__other string.For__example,here__areHumre__sconstants__forthe__shorthand__character classes:DIGIT__andNONDIGIT__represent r'\d'and__r'\D', respectively.WORD__andNONWORD__represent r'\w'and__r'\W', respectively.WHITESPACE__andNONWHITESPACE__represent r'\s'and__r'\S', respectively.A__commonsource__ofregex__bugsis__forgettingwhich__charactersneed__tobe__escaped.You__canuse__Humres__constantsinstead__oftyping__theescaped__character__yourself.For__example,say__youwant__tomatch__a single-digit floating-pointnumber__withone__digitafter__thedecimal__point,like__'0.9'or__'4.5'. However,if__youuse__theregex__string r'\d.\d',you__mightnot__realizethat__thedot__matchesa__period (asin__'4.5')but__alsomatches__anyother__character (asin__'4A5'). Instead,use__Humres__PERIOD constant,which__containsthe__string r'\.'.The__expressionDIGIT__+PERIOD__+DIGIT__evaluatesto__r'\d\.\d'and__makesit__muchmore__obviouswhat__theregex__intendsto__match.The__followingHumre__constantsexist__forescaped__characters:PERIOD__DOLLAR_SIGNQUESTION_MARK__HASHTAGAMPERSAND__OPEN_PARENCLOSE_PAREN__ASTERISKPLUS__MINUSOPEN_BRACKET__CLOSE_BRACKETOPEN_BRACE__CLOSE_BRACEBACKSLASH__PIPECARET__TILDEThere__arealso__constantsfor__NEWLINE, TAB, QUOTE,and__DOUBLE_QUOTE.Back__referencesfrom__r'\1'to__r'\99'are__representedas__BACK_1to__BACK_99. However,you__llmake__thelargest__readabilitygains__byusing__Humres__functions.Table__9-2shows__thesefunctions__andtheir__equivalentregular__expression syntax.Text__PatternMatching__withRegular__Expressions 211Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__thephone_regex__variablein__thephone__numberextractor__projectare__as follows: r'((\d{3}|\(\d{3}\))?(\s|-|\.)?(\d{3})(\s|-|\.)(\d{4})(\s*(ext|x|ext\.)\s*(\d{2,5}))?)'Your__co-workeris__welcometo__usethis__regularexpression__stringif__theyfeel__itis__more appropriate.Summary__Whilea__computercan__searchfor__text quickly,it__mustbe__toldprecisely__whatto__look for.Regular__expressionsallow__youto__specifythe__patternof__characters__youare__looking for,rather__thanthe__exacttext__itself.In__fact,some__wordprocessing__andspreadsheet__applicationsprovide__find-and-replacefeatures__thatallow__youto__searchusing__regular expressions.The__punctuation-heavysyntax__ofregular__expressionsis__composedof__qualifiersthat__detailwhat__tomatch__andquantifiers__thatdetail__howmany__to match.The__remodule__thatcomes__withPython__letsyou__compilea__regexstring__intoa__Pattern object.These__objectshave__several methods: search(),to__find 214Chapter__9Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsas__asingle__string value,poten__tiallygigabytes__in size.In__this chapter,you__lllearn__howto__usePython__to create, read,and__savefiles__onthe__hard drive.Files__andFilepaths__Afile__hastwo__key properties:a__filename (usuallywritten__asone__word)and__a path.The__pathspecifies__thelocation__ofa__fileon__the computer.For__example,there__isa__fileon__myWindows__laptopwith__thefilename__project.docxin__thepath__C:\Users\Al\Documents.The__partof__thefilename__afterthe__lastperiod__iscalled__thefile__sextension__andtells__youa__files__type.The__filename project.docxis__aWord__10REA__DINGANDWRIT__INGF__ILE__S 218Chapter__10Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter exactly. Still,try__tofollow__alongusing__foldersthat__existon__your computer.Standardizing__PathSeparators__On Windows,paths__arewritten__usingbackslashes__(\)as__theseparator__betweenfolder__names.The__macOSand__Linuxoperating__systems, however,use__theforward__slash (/)as__theirpath__separator.The__Path()function__inthe__pathlibmodule__handlesall__operatingsys__tems,so__thebest__practiceis__touse__forwardslashes__inyour__Python code.If__youpass__itthe__stringvalues__ofindividual__fileand__foldernames__inyour__path, Path()will__returna__stringwith__afilepath__usingthe__correctpath__separators.Enter__thefollowing__intothe__interactive shell: >>>from__pathlibimport__Path >>> Path('spam', 'bacon', 'eggs') WindowsPath('spam/bacon/eggs')Reading__andWriting__Files 219Automate__theBoring__Stuffwith__Python, 3rdedition__(chapters__interactiveshell__exampleson__Windows,so__Path('spam', 'bacon', 'eggs')returned__aWindowsPath__objectfor__thejoined__path,represented__as WindowsPath('spam/bacon/eggs').Even__thoughWindows__uses backslashes,the__WindowsPathrepresentation__inthe__interactiveshell__displays__themusing__forward slashes,as__opensource__softwaredevelopers__havehistorically__favoredthe__Linuxoperating__system.If__youwant__toget__asimple__textstring__ofthis__path,you__canpass__itto__the str() function,which__inour__examplereturns__'spam\\bacon\\eggs'. (Noticethat__wedouble__thebackslashes__becausewe__needto__escapeeach__backslashwith__anotherbackslash__character.)If__Ihad__calledthis__functionon__macOSor__Linux, Path()would__havereturned__aPosixPath__object that,when__passedto__str(),would__havereturned__'spam/bacon/eggs'. (POSIXis__aset__ofstandards__for Unix-likeoperating__systems.)If__youwork__withPath__objects,WindowsPath__andPosixPath__neverhave__toappear__inyour__sourcecode__directly.These__Pathobjects__willbe__passedto__severalof__the file-relatedfunctions__introducedin__this chapter.For__example,the__followingcode__joinsnames__froma__listof__filenamesto__theend__ofa__folder__s name: >>>from__pathlibimport__Path >>>my_files__= ['accounts.txt', 'details.csv', 'invite.docx'] >>>for__filenamein__my_files: ... print(Path(r'C:\Users\Al', filename)) ... C:\Users\Al\accounts.txt C:\Users\Al\details.csv C:\Users\Al\invite.docxOn__Windows,the__backslashseparates__directories,so__youcan__tuse__itin__filenames. However,you__canuse__backslashesin__filenameson__macOSand__Linux. So,while__Path(r'spam\eggs')refers__totwo__separatefolders__(ora__fileeggs__ina__folder spam)on__Windows,the__samecommand__wouldrefer__toa__single__folder (or file)named__spam\eggson__macOSand__Linux.For__this reason,it__susually__agood__ideato__alwaysuse__forwardslashes__inyour__Pythoncode__(andI__llbe__doingso__forthe__restof__this chapter).The__pathlibmodule__willensure__thatyour__codealways__workson__alloperating__systems.Joining__PathsWe__normallyuse__the +operator__toadd__twointeger__or floating-pointnum__bers,such__asin__theexpression__2 + 2,which__evaluatesto__theinteger__value 4.But__wecan__alsouse__the +operator__toconcatenate__twostring__values,like__the 220Chapter__10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19)has__functionsfor__turningthis__numberinto__a human-readable form.The__stat_resultobject__hasseveral__useful attributes:st_size__Thesize__ofthe__filein__bytes.st_mtime__Thelast__modified timestamp,when__thefile__waslast__changed.st_ctime__Thecreation__timestamp.On__Windows,this__identifieswhen__thefile__was created.On__macOSand__Linux,this__identifiesthe__lasttime__thefile__smetadata__(suchas__its name)was__changed.st_atime__Thelast__accessed timestamp,when__thefile__waslast__read.Keep__inmind__thatthe__modified, creation,and__accesstimestamps__canbe__changed manually,and__arenot__guaranteedto__be accurate.Finding__FilesUsing__GlobPatterns__The *and__?characters__canbe__usedto__matchfolder__namesand__filenamesin__whatare__calledglob__patterns.Glob__patternsare__likea__simplifiedregex__language:the__*character__matchesany__text,and__the ?character__matchesexactly__one character.For__example,look__atthese__glob patterns: '*.txt'matches__allfiles__thatend__with .txt. 'project?.txt'matches__'project1.txt', 'project2.txt',or__'projectX.txt'. '*project?.*'matches__'catproject5.txt'or__'secret_project7.docx'. '*'matches__all filenames.Path__objectsof__foldershave__a glob()method__forlisting__anycontent__inthe__folderthat__matchesthe__glob pattern.The__glob()method__returnsa__generatorobject__(thetopic__ofwhich__isbeyond__thescope__ofthis__book)that__youll__needto__passto__list()to__easilyview__inthe__interactive shell: >>>from__pathlibimport__Path >>>p__= Path('C:/Users/Al/Desktop') >>> p.glob('*') >>> list(p.glob('*')) 228Chapter__10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12discusses__thecommand__linein__more detail.Checking__PathValidity__ManyPython__functionswill__crashwith__anerror__ifyou__supplythem__witha__paththat__doesnot__exist. Luckily,Path__objectshave__methodsto__checkwhether__agiven__pathexists__andwhether__itis__afile__or folder.Assuming__thata__variablep__holdsa__Path object,you__couldexpect__the following:Calling__p.exists()returns__Trueif__thepath__exists,and__returnsFalse__ifit__doesnt__exist.Calling__p.is_file()returns__Trueif__thepath__existsand__isa__file,and__returnsFalse__otherwise.Calling__p.is_dir()returns__Trueif__thepath__existsand__isa__directory,and__returnsFalse__otherwise.On__my computer,here__iswhat__Iget__whenI__trythese__methodsin__theinteractive__shell: >>>from__pathlibimport__Path >>>win_dir__= Path('C:/Windows') >>>not_exists_dir__= Path('C:/This/Folder/Does/Not/Exist') >>>calc_file_path__= Path('C:/Windows /System32/calc.exe') >>> win_dir.exists()True__>>> win_dir.is_dir()True__>>> not_exists_dir.exists()False__>>> calc_file_path.is_file()True__>>> calc_file_path.is_dir()False__Readingand__WritingFiles__229Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.The__pathlibmodule__s read_text()method__returnsthe__fullcontents__ofa__textfile__asa__string.Its__write_text()method__createsa__newtext__file (orover__writesan__existing one)with__thestring__passedto__it.Enter__thefollowing__intothe__interactive shell: >>>from__pathlibimport__Path >>>p__= Path('spam.txt') >>> p.write_text('Hello, world!') 13 >>> p.read_text() 'Hello, world!'These__methodcalls__createa__spam.txtfile__withthe__content 'Hello, world!'.The__13that__write_text()returns__indicatesthat__13characters__werewritten__tothe__file. (Youcan__oftendisregard__thisreturn__value.)The__read_text()call__readsand__returnsthe__contentsof__thenew__fileas__a string: 'Hello, world!'.Keep__inmind__thatthese__Pathobject__methodsallow__onlybasic__interactions__with files.The__morecommon__wayof__writingto__afile__involvesusing__the open()function__andfile__objects.There__arethree__stepsto__readingor__writingfiles__in Python: 1.Call__the open()function__toreturn__aFile__object. 2.Call__the read()or__write()method__onthe__File object. 3.Close__thefile__bycalling__the close()method__onthe__File object.We__llgo__overthese__stepsin__thefollowing__sections.Note__thatas__youbegin__workingwith__files,you__mayfind__ithelpful__tobe__ableto__quicklysee__theirextensions__(.txt, .pdf, .jpg,and__so on).Windows__andmacOS__mayhide__fileextensions__by default,showing__spam.txtas__simply spam.To__show extensions,open__thesettings__forFile__Explorer (on Windows)or__Finder (on macOS)and__lookfor__acheckbox__thatsays__somethinglike__Showall__filenameextensions__orHide__extensionsfor__knownfile__types. (Theexact__locationand__wordingof__thissetting__dependon__theversion__ofyour__operating system.)Opening__FilesTo__opena__filewith__the open() function,pass__ita__stringpath__indicatingthe__fileyou__wantto__open.This__canbe__eitheran__absolutepath__ora__relative path.The__open()function__returnsa__File object.Try__thisby__creatinga__textfile__named hello.txtusing__Notepador__TextEdit.Enter__Hello, world!as__thecontent__ofthis__textfile__andsave__itin__youruser__home folder. Then,enter__thefollowing__inthe__interactive shell: >>>from__pathlibimport__Path >>>hello_file__= open(Path.home() / 'hello.txt', encoding='UTF-8')Reading__andWriting__Files 231Automate__theBoring__Stuffwith__Python, 3rdedition__(Contentsof__FilesNow__thatyou__havea__File object,you__canstart__readingfrom__it.If__youwant__toread__theentire__contentsof__afile__asa__string value,use__theFile__objects__read() method.Let__scontinue__withthe__hello.txtFile__objectyou__storedin__hello_file.Enter__thefollowing__intothe__interactive shell: >>>hello_content__= hello_file.read() >>>hello_content__'Hello, world!'You__canthink__ofthe__contentsof__afile__asa__singlelarge__string value;the__read()method__merelyreturns__thestring__thatis__storedin__the file. Alternatively,you__canuse__the readlines()method__toget__alist__ofstring__valuesfrom__the file,one__foreach__lineof__text.For__example,create__afile__named sonnet29.txtin__thesame__directoryas__hello.txtand__placethe__followingtext__in it: When,in__disgracewith__fortuneand__men's eyes,I__allalone__beweepmy__outcast state,And__troubledeaf__heavenwith__mybootless__cries,And__lookupon__myselfand__cursemy__fate, 232Chapter__10Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__thefile__insteadof__replacingthe__stringwe__just wrote,we__openthe__filein__append mode.We__write 'Baconis__nota__vegetable.'to__thefile__andclose__it. Finally,to__printthe__filecontents__tothe__screen,we__openthe__filein__itsdefault__read mode,call__read(),store__theresulting__Fileobject__in content,close__the file,and__print content.Note__thatthe__write()method__doesnot__automaticallyadd__anewline__characterto__theend__ofthe__stringlike__the print()function__does.You__willhave__toadd__thischaracter__yourself.You__canalso__passa__Pathobject__tothe__open()function__insteadof__thefile__nameas__a string.Using__withStatements__Everyfile__onwhich__yourprogram__calls open()needs__close()called__onit__as well,but__youmay__forgetto__includethe__close() function,or__yourprogram__mightskip__overthe__close()call__incertain__circumstances.Python__swith__statementmakes__iteasier__toautomatically__close files.A__withstatement__createssomething__calleda__contextmanager__thatPython__usesto__manage resources.These__resources,such__as files,network__connections,or__segmentsof__memory,often__havesetup__andteardown__stepsduring__whichthe__resourceis__allocatedand__laterreleased__sothat__otherprograms__canmake__useof__it. (Mostof__the time, however,you__llencounter__withstatements__usedto__open files.)The__withstatement__addsa__blockof__codethat__beginsby__allocatingthe__resourceand__thenreleases__itwhen__theprogram__executionleaves__the block,which__couldhappen__dueto__areturn__statement,an__unhandledexception__being raised,or__someother__reason.Here__istypical__codethat__writesand__readsthe__contentof__a file:file_obj__= open('data.txt', 'w', encoding='utf-8') file_obj.write('Hello, world!') file_obj.close()file_obj__= open('data.txt', encoding='utf-8')content__= file_obj.read() file_obj.close()Here__isthe__equivalentcode__usinga__with statement:with__open('data.txt', 'w', encoding='UTF-8')as__file_obj: file_obj.write('Hello, world!')with__open('data.txt', encoding='UTF-8')as__file_obj:content__= file_obj.read()In__thewith__statement example,notice__thatthere__areno__callsto__close()at__allbecause__thewith__statementautomatically__callsit__whenthe__programexecution__leavesthe__block.The__withstatement__knowsto__dothis__basedon__thecontext__managerit__obtainsfrom__the open() function.Creating__yourown__234Chapter__10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__text files.The__open()function__canopen__thesefiles__toread__intheir__contentsas__onelarge__string (withthe__read() method)or__asa__listof__strings (withthe__readlines() method).The__open()function__canalso__openfiles__inwrite__orappend__modeto__createnew__textfiles__oradd__toexisting__text files, respectively.In__previous chapters,you__usedthe__clipboardas__away__ofgetting__largeamounts__oftext__intoa__program,rather__thantyping__it directly.Now__youcan__haveyour__programsread__filesfrom__thehard__drive,which__isa__bigimprove__ment,as__filesare__muchless__volatilethan__the clipboard.In__thenext__chapter,you__willlearn__howto__handlethe__filesthemselves__bycopying__them,deleting__them,renaming__them,moving__them,and__more.Practice__Questions 1.What__isa__relativepath__relative to? 2.What__doesan__absolutepath__start with? 3.What__does Path('C:/Users') / 'Al'evaluate__toon__Windows? 4.What__does 'C:/Users' / 'Al'evaluate__toon__Windows? 5.What__dothe__os.getcwd()and__os.chdir()functions__do? 6.What__arethe__.and__.. folders? 7.In__C:\bacon\eggs\spam.txt,which__partis__thedirectory__name,and__whichpart__isthe__base name? 8.What__threemode__argumentscan__youpass__tothe__open()function__forplaintext__files? 9.What__happensif__anexisting__fileis__openedin__write mode? 10.What__isthe__differencebetween__the read()and__readlines() methods? 11.What__datastructure__doesa__shelfvalue__resemble?Practice__ProgramsFor__practice,design__andwrite__thefollowing__programs.Mad__LibsCreate__aMad__Libsprogram__thatreads__intext__filesand__letsthe__useradd__theirown__textanywhere__theword__ADJECTIVE, NOUN, ADVERB,or__VERBappears__inthe__text file.For__example,a__textfile__maylook__like this:The__ADJECTIVEpanda__walkedto__theNOUN__andthen__VERB.A__nearbyNOUN__wasunaffected__bythese__events.Reading__andWriting__Files 241Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__severalfolders__intoone__ZIPfile__(whichcould__serveas__asimple__backup system)All__thisboring__stuffis__justbegging__tobe__automatedin__Python.By__programmingyour__computerto__dothese__tasks,you__cantransform__itinto__a quick-workingfile__clerkthat__nevermakes__mistakes. 11ORG__ANIZING__FIL__ES__244Chapter__11Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterwill__useforward__slashes (/) instead,as__theywork__onall__operating systems.The__shutilModule__Theshutil__modulehas__functionsto__letyou__copy, move, rename,and__deletefiles__inyour__Python programs. (Themodule__sname__isshort__forshell__utili ties,where__shellis__anotherterm__fora__terminalcommand__line.)To__usethe__shutil functions,you__llfirst__needto__runimport__shutil.To__createan__examplefile__andfolder__towork__with,run__thefollowing__codebefore__theinteractive__shellexamples__inthis__chapter: >>>from__pathlibimport__Path >>>h__= Path.home() >>> (h / 'spam').mkdir(exist_ok=True) >>>with__open(h / 'spam/file1.txt', 'w', encoding='utf-8')as__file: ... file.write('Hello') ...This__willcreate__afolder__namedspam__witha__textfile__named file1.txt.The__examplesin__thischapter__will copy, move, rename,and__deletethis__fileand__folder.All__shutilfunctions__cantake__filepatharguments__thatare__eitherstrings__orPath__objects.Copying__Filesand__FoldersThe__shutilmodule__providesfunctions__forcopying__files,as__wellas__entire folders.Calling__shutil .copy(source, destination)will__copythe__fileat__thepath__sourceto__thefolder__atthe__path destination.Both__sourceand__destinationcan__bestrings__orPath__objects.If__destinationis__a filename,it__willbe__usedas__thenew__nameof__thecopied__file.If__destinationis__a folder,the__filewill__becopied__tothat__folderwith__itsoriginal__name.This__functionreturns__thepath__ofthe__copied file.Enter__thefollowing__intothe__interactiveshell__tosee__howshutil__.copy() works: >>>import__shutil >>>from__pathlibimport__Path >>>h__= Path.home() 1 >>>shutil__.copy(h / 'spam/file1.txt', h) 'C:\\Users\\Al\\file1.txt' 2 >>>shutil__.copy(h / 'spam/file1.txt',h__/ 'spam/file2.txt') WindowsPath('C:/Users/Al/spam/file2.txt')The__firstshutil__.copy()call__copiesthe__fileat__C:\Users\Al\spam\file1.txtto__thehome__folder C:\Users\Al.The__returnvalue__isthe__pathof__thenewly__copied file.Note__thatsince__wespecified__afolder__asthe__destination 1,the__new,copied__filewill__havethe__samefilename__asthe__original file1.txt file.Organizing__Files 245Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11Automate__theBoring__Stuffwith__Python, 3rdedition__(contents,you__usethe__shutil module:Calling__shutil.rmtree(path)will__delete (that is, remove)the__entirefolder__treeat__path,including__allthe__filesand__subfoldersit__contains.Calling__os.unlink(path)will__deletethe__singlefile__at path.Calling__os.rmdir(path)will__deletethe__folderat__path.This__foldermust__be empty.Be__carefulwhen__usingthese__functionsin__your programs!It__soften__agood__ideato__firstrun__yourprogram__withthese__callscommented__outand__print()calls__addedto__showthe__filesthat__wouldbe__deleted.This__iscalled__adry__run.Here__isa__Pythonprogram__thatwas__intendedto__deletefiles__withthe__.txtfile__extension,but__ithas__atypo__(shownin__bold)that__causesit__todelete__.rxtfiles__instead:import__osfrom__pathlibimport__Pathfor__filenamein__Path.home().glob('*.rxt'): os.unlink(filename)If__youhad__anyimportant__filesending__with .rxt,they__wouldhave__been accidentally,permanently__deleted. Instead,you__shouldhave__firstrun__theprogram__like this:import__osfrom__pathlibimport__Pathfor__filenamein__Path.home().glob('*.rxt'): #os.unlink(filename) print('Deleting', filename)The__os.unlink()call__isnow__commented,so__Pythonignores__it. Instead,you__llprint__thefilename__ofthe__filethat__wouldhave__been deleted.Running__thisversion__ofthe__programfirst__willshow__youthat__youve__accidentallytold__theprogram__todelete__.rxtfiles__insteadof__.txt files.You__shouldalso__dodry__runsfor__programsthat__copy, rename,or__move files. Lastly,it__maybe__agood__ideato__createa__backupcopy__ofthe__entirefolder__ofany__filesyour__program touches,just__incase__youneed__tocompletely__restorethe__original files.Once__youre__certainthe__programworks__as intended,delete__the print(filename)line__anduncomment__the os.unlink(filename) line. Then,run__theprogram__againto__actuallydelete__the files.Deleting__tothe__RecycleBin__Pythons__built-in shutil.rmtree()function__irreversiblydeletes__filesand__fold ers.This__makesthe__functiondangerous__to use,because__abug__coulddelete__OrganizingFiles__247Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__manyother__files.Compressing__afile__reducesits__size,which__isuseful__whentransferring__itover__the internet.And__sincea__ZIPfile__canalso__containmultiple__filesand__subfolders,it__sa__handyway__topackage__severalfiles__into one.This__single file,called__anarchive__file,can__then be, say,attached__toan__email.Your__Pythonprograms__cancreate__orextract__fromZIP__filesusing__functions__inthe__zipfile module.Creating__andAdding__toZIP__FilesTo__createyour__owncompressed__ZIP files,you__mustopen__theZipFile__objectin__writemode__bypassing__'w'as__thesecond__argument. (Notethe__capitalletters__Z 250Chapter__11Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__file1.txt__(about 213 bytes;highly__repetitivedata__isalso__highly compressible).The__compresslevelkeyword__argument (addedin__Python 3.7and__later)can__beset__toany__valuefrom__0to__9,with__9being__theslowest__butmost__compressed level.If__youdon__tspecify__thiskeyword__argument,the__defaultis__6.The__zipfile.ZipFile()function__opensa__ZIPfile__ina__with statement,in__amanner__similarto__howthe__open()function__opens files.This__ensuresthat__the close()method__isautomatically__calledwhen__theexecution__leavesthe__withstatement__s block.Keep__inmind__that,just__aswith__writingto__files,write__modewill__eraseall__existingcontents__ofa__ZIP file.If__youwant__tosimply__addfiles__toan__existingZIP__file,pass__'a'as__thesecond__argumentto__zipfile.ZipFile()to__openthe__ZIPfile__inappend__mode.Reading__ZIPFiles__Toread__thecontents__ofa__ZIP file,you__mustfirst__createa__ZipFileobject__bycalling__the zipfile.ZipFile()function__andpassing__theZIP__files__filename.Note__thatzipfile__isthe__nameof__thePython__module,and__ZipFile()is__thename__ofthe__function.For__example,enter__thefollowing__intothe__interactive shell: >>>import__zipfile >>>example_zip__= zipfile.ZipFile('example.zip') >>> example_zip.namelist() ['file1.txt']Organizing__Files 251Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__example.zipto__thecurrent__working directory. Optionally,you__canpass__afolder__nameto__extractall()to__haveit__extractthe__filesinto__afolder__otherthan__thecurrent__working directory.If__thefolder__passedto__the extractall()method__doesnt__exist,Python__willcreate__it.For__instance,if__youreplaced__thecall__at 1with__example_zip.extractall('C:\\spam),the__codewould__extractthe__filesfrom__exam ple.zipinto__anewly__created C:\spam folder.The__extract()method__forZipFile__objectswill__extracta__singlefile__fromthe__ZIP file.Continue__theinteractive__shellexample__byentering__the following: >>> example_zip.extract('file1.txt') 'C:\\Users\\Al\\Desktop\\file1.txt' >>> example_zip.extract('file1.txt', 'C:\\some\\new\\folders') 'C:\\some\\new\\folders\\file1.txt' >>> example_zip.close() 252Chapter__11Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsinto__#a__ZIPfile__whosefilename__incrementsimport__zipfile,os__frompathlib__importPath__def backup_to_zip(folder): #Back__upthe__entirecontents__of "folder"into__aZIP__file.folder__= Path(folder) #Make__surefolder__isa__Path object,not__string. #Figure__outthe__ZIPfilename__thiscode__should use,based__on #what__filesalready__exist. 1number__= 1 2while__True:zip_filename__= Path(folder.parts[-1] + '_' + str(number) + '.zip')if__not zip_filename.exists():break__number =number__+ 1 3 # TODO:Create__theZIP__file.Organizing__Files 253Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsshould__bebacked__up.The__functionwill__determinewhat__filenameto__usefor__theZIP__fileit__will create. Then,it__willcreate__the file,walk__thefolder__folder,and__addeach__ofthe__subfoldersand__filesto__theZIP__file.Write__TODOcomments__forthese__stepsin__thesource__codeto__remindyourself__todo__themlater__3.The__first task,naming__theZIP__file,uses__thebase__nameof__theabsolute__pathof__folder.If__thefolder__beingbacked__upis__C:\Users\Al\spam,the__ZIPfile__sname__shouldbe__spam_N.zip,where__Nis__1the__firsttime__yourun__thepro__gram,N__is 2the__second time,and__so on.You__candetermine__whatN__shouldbe__bychecking__whether spam_1.zipalready__exists,then__checkingwhether__spam_2.zipalready__exists,and__so on.Use__avariable__namednumber__forN__1,and__keepincrementing__itinside__theloop__thatcalls__exists()to__checkwhether__thefile__exists 2.The__firstnonexis__tentfilename__foundwill__causethe__loopto__break,since__itwill__havefound__thefilename__ofthe__new ZIP.Step__2:Create__theNew__ZIPFile__Next,let__screate__theZIP__file.Make__yourprogram__looklike__the following: # backup_to_zip.py -Copies__anentire__folderand__itscontents__into #a__ZIPfile__whosefilename__increments --snip-- #Create__theZIP__file. print(f'Creating {zip_filename}...')backup_zip__= zipfile.ZipFile(zip_filename, 'w') # TODO:Walk__theentire__foldertree__andcompress__thefiles__ineach__folder. print('Done.') backup_to_zip(Path.home() / 'spam')Now__thatthe__newZIP__files__nameis__storedin__thezip_filename__variable,you__cancall__zipfile.ZipFile()to__actuallycreate__theZIP__file.Be__sureto__pass 'w'as__thesecond__argumentto__openthe__ZIPfile__inwrite__mode.We__llalso__removethe__TODOfrom__the comment,as__weve__finishedwriting__thecode__forthis__section. 254Chapter__11Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsinto__#a__ZIPfile__whosefilename__increments --snip-- #Walk__theentire__foldertree__andcompress__thefiles__ineach__folder. 1for__folder_name, subfolders,filenames__in os.walk(folder):folder_name__= Path(folder_name) print(f'Addingfiles__infolder__{folder_name}...') #Add__allthe__filesin__thisfolder__tothe__ZIP file. 2for__filenamein__filenames: print(f'Addingfile__{filename}...') backup_zip.write(folder_name / filename) backup_zip.close() print('Done.') backup_to_zip(Path.home() / 'spam')Use__os.walk()in__afor__loop 1.On__each iteration,the__functionwill__returnthe__iterations__currentfolder__name,the__subfoldersin__that folder,and__thefilenames__inthat__folder.The__nestedfor__loopcan__gothrough__eachfile__namein__thefilenames__list 2.Each__ofthese__isadded__tothe__ZIP file.When__yourun__this program,it__shouldproduce__outputthat__lookssome__thinglike__this:Creating__spam_1.zip...Adding__filesin__spam...Adding__file file1.txt... Done.The__secondtime__yourun__it,it__willput__allthe__filesin__thespam__folderinto__aZIP__filenamed__spam_2.zip,and__so on.Ideas__forOther__ProgramsYou__canwalk__adirectory__treeand__addfiles__tocompressed__ZIParchives__inseveral__other programs.For__example,you__couldwrite__programsthat__dothe__following:Walk__adirectory__treeand__archivejust__fileswith__certain extensions,such__as .txtor__.py,and__nothing else.Walk__adirectory__treeand__archiveevery__fileexcept__the .txtand__.py ones.Only__archivethe__foldersin__adirectory__treethat__usethe__mostdisk__spaceor__havebeen__modifiedsince__theprevious__archive.Organizing__Files 255Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterdiscusses__howto__runprograms__fromthe__commandline__terminal.The__commandline__canbe__intimidating,with__itscryptic__commandsand__utterlack__of user-friendly presentation,and__mostusers__stayaway__from it.But__thereare__somegenuine__benefitsto__becomingfamiliar__with it,and__its__nomore__challengingthan__anyof__theprogram__mingyou__vedone__so far.Once__youve__writtena__Pythonprogram__toautomate__some task,having__toopen__Muevery__timeyou__wantto__runit__canbe__a burden.The__commandline__isa__moreconvenient__wayto__executePython__scripts (especiallyif__youshare__yourprograms__withfriends__or co-workerswho__dont__have Mu,or__even 12DE__SIG__NING__ANDDE__PLOY__INGCOM__MANDLIN__EPROG__RAMS 258Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter (andprogramming__in general)uses__alot__ofterms__thatmean__aprogram__orsome__slightvariation__ofthe__term.You__couldaccurately__callall__ofthe__followingitems__a program.But__thereare__subtledifferences__betweenwhat__thesenames__mean:A__programis__acomplete__pieceof__software,large__or small,with__instructions__thata__computercarries__out.A__scriptis__aprogram__thatan__interpreterruns__fromits__source-codeform__ratherthan__froma__compiled, machine-code form.This__isa__veryloose__term.Python__programsare__oftencalled__scriptseven__thoughPython__codecan__becompiled__likeother__languages (asyou__lllearn__inCompiling__PythonPrograms__withPyInstaller__onpage__XX).A__commandis__aprogram__thatis__oftenrun__froma__text-basedterminal__anddoesn__thave__agraphical__userinterface__(GUI).All__configurationis__doneup__frontby__specifyingcommand__linearguments__beforerunning__thecommand__(althoughinteractive__commandsmay__sometimesinterrupt__theiroperation__withan__Areyou__sure? Y/Nquestion__forthe__user).Both__dirand__ls,explained__inThe__cd, pwd, dir,and__lsCommands__onpage__XX,are__examplesof__commands.A__shellscript__isa__singletext__filethat__convenientlyruns__severalbundled__terminalcommands__inone__batch.This__way,a__usercan__runone__shellscript__insteadof__manuallyentering__severalcommands__individually.On__macOSand__Linux,shell__scriptfiles__havea__.shfile__extension (orno__extension),while__Windowsuses__theterm__batchfile__forshell__scriptswith__a .batfile__extension.An__applicationis__aprogram__thathas__aGUI__andcontains__multiplerelated__features.Excel__andFirefox__areexamples__of applications.Applications__usuallyhave__severalfiles__thatan__installerprogram__setsup__onyour__computer (andthat__anuninstaller__programcan__remove),rather__thanconsisting__ofjust__asingle__executablefile__copiedto__a computer.App__isa__commonname__formobile__phoneand__tablet applications,but__theterm__canbe__usedfor__desktopapplications__as well.A__webapp__isa__program__thatruns__ona__web server,and__whichusers__interactwith__overthe__internetthrough__aweb__browser.You__rewelcome__tonitpick__aboutprecise__definitions;these__explanationsshould__merelygive__youa__generalsense__ofthe__terms usage.If__youwant__tobecome__familiarwith__more terminology,my__bookBeyond__theBasic__Stuffwith__Python (chapter.Designing__andDeploying__CommandLine__Programs 259Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,we__llassume__thePython__programyou__wantto__runis__named yourScript.pyand__thatit__slocated__ina__Scriptsfolder__underyour__home folder.You__dont__needto__openMu__toaccess__thePython__interactive shell.From__aterminal__window,you__canenter__pythonon__Windowsor__python3on__macOSand__Linuxto__start it. (Youshould__thensee__itsfamiliar__>>> prompt.)To__runone__ofyour__.pyPython__filesfrom__the terminal,enter__itsfilepath__afterpython__or python3either__inits__absolute form,like__python C:\Users\al\ Scripts\yourScript.py,or__inits__relative form,like__python yourScript.py,if__the 260Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__the CWD: C:\Users\al>dir --snip-- 08/26/2036 06:42PM__171,304 _recursive-centaur.png 08/18/2035 11:25AM__1,278_viminfo__08/13/2035 12:58AM____pycache__ 77 File(s) 83,805,114bytes__108 Dir(s) 149,225,267,200bytes__freeWhile__navigatingthe__filesystem__inthe__terminal,you__lloften__bouncebetween__cdto__changedirectories__and dir/lsto__seethe__contentsof__thedirec__tory.You__canlist__allthe__executablefiles__inthe__CWDby__runningdir__*.exeon__Windowsand__file * |grep__executableon__macOSand__Linux.Once__youare__inthe__foldercontaining__a program,you__canrun__itin__thefollowing__ways:On__Windows,enter__theprogram__namewith__orwithout__the .exeexten__sion: example.exe.On__macOSand__Linux,enter__./followed__bythe__program name: ./example.Designing__andDeploying__CommandLine__Programs 261Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__thePATH__environment variable,run__echo %PATH%on__Windowsor__echo $PATHon__macOSand__Linux.The__valuestored__inPATH__isa__longstring__composedof__foldernames__separatedby__asemicolon__(on Windows)or__acolon__(onmacOS__and Linux).For__example,on__Ubuntu Linux,the__PATHenvironment__variablemay__looklike__the following: al@al-virtual-machine:~$echo__$PATH /home/al/.local/bin:/home/al/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/ usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/binIf__youwere__toenter__python3into__theLinux__terminalwith__this PATH,Linux__wouldcheck__fora__programnamed__python3in__the /home/al/.local/binfolder__first,then__inthe__/home/al/bin folder,and__so on.It__wouldeventually__find python3in__/usr/binand__run that.The__PATHenvironment__variableis__convenient__becauseyou__canjust__dropa__programin__afolder__onthe__PATHto__spareyourself__from cd-ingto__itsfolder__everytime__youwant__torun__it.Note__thatthe__terminalwindow__doesnt__searchsubfolders__undera__PATH folder.If__C:\Users\al\Scriptsis__listedin__the PATH,running__spam.exewill__runa__C:\Users\al\Scripts\spam.exefile__butnot__a C:\Users\al\Scripts\eggs\spam.exe file.PATH__EditingSo__far,you__mayhave__beensaving__your .pyfiles__tothe__mu_codefolder__thatthe__Mueditor__usesby__default. However,I__recommendcreating__aScripts__folder 262Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(Introductionto__makeyour__operatingsystem__showthem__by default.When__yourun__pythonor__python3from__the terminal,you__llstill__runyour__originalPython__installations__interpreter.To__usethe__virtualenvironment__sPython__version,you__mustactivate__it.Do__soby__runningthe__C:\Users\al\Scripts\. venv\Scripts\activate.batscript__on Windows: C:\Users\al\Scripts>cd .venv\Scripts C:\Users\al\Scripts\.venv\Scripts>activate.bat (.venv) C:\Users\al\Scripts\.venv\Scripts>where python.exe C:\Users\Al\Scripts\.venv\Scripts\python.exe C:\Users\Al\AppData\Local\Programs\Python\Python313\python.exe C:\Users\Al\AppData\Local\Programs\Python\Python312\python.exe 264Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(contents.The__followingsections__tellyou__howto__deployyour__scriptafter__youve__setup__thevirtual__environmentand__addedyour__Scriptsfolder__to PATH.Installing__PythonPackages__withPip__Pythoncomes__witha__commandline__packagemanager__programcalled__pip (writtenin__lowercaseunless__its__atthe__startof__a sentence).Pip__isa__recursiveacronym__forpip__installs package.While__Pythons__standardlibrary__comeswith__modulessuch__as sys, random,and__os,there__arealso__hundredsof__thousandsof__third-partypackages__youcan__findon__PyPI (pronounced pie-pee-eyeand__not pie-pie),the__PythonPackage__Index,at__https://pypi .org.In__Python,a__packageis__acollection__ofPython__codemade__availableon__PyPI,and__amodule__isan__individual__.pyfile__containingPython__code.You__installpackages__fromPyPI__thatcontain__modules,and__youimport__moduleswith__animport__statement.While__pipis__aprogram__onits__own,it__seasier__torun__itthrough__thePython__interpreterby__runningpython__mpip__onWindows__or python3m__pipon__macOSand__Linux,rather__thanrunning__thepip__(on Windows)or__pip3 (onmacOS__and Linux)program__directly.This__preventserrors__inthe__rarecases__whereyou__havemultiple__Python installations,your__PATHis__misconfig ured,and__pip/pip3is__installingto__adifferent__Pythoninterpreter__thanthe__onethat__runswhen__youenter__python/python3.DON__TUSE__PIPWITH__ANACONDAIf__youve__installedthe__Anacondadistribution__ofPython__insteadof__theregular__distributionfrom__https://python .org,you__shouldavoid__usingpip__inyour__conda environments. Instead,use__the conda-specificpackage__managerthrough__theconda__command.To__installa__packagefrom__PyPI,enter__thefollowing__intothe__terminal: C:\Users\al>pythonm__pipinstall__package_nameRemember__torun__python3if__onmacOS__orLinux__insteadof__pythonfor__thesevarious__commands.Also__notethat__youll__needto__runthis__fromthe__terminal window,and__notfrom__thePython__interactive shell. 266Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8is__anexample__ofthis__kindof__program.The__designof__thisprogram__becomesespecially__usefulonce__youve__deployedit__followingthe__instructionsin__DeployingPython__Programson__page XX.Just__highlightthe__input text,press__ctrl-Cto__copy it,and__runthe__program.The__resultswill__beon__the clipboard,ready__topaste__wherever needed.Later__inthis__chapterwe__lllook__attwo__projects,the__ccwdcommand__andthe__Clipboard Recorder,that__makeuse__ofthe__clipboard.Colorful__Textwith__BextYou__canprint__colorfultext__usingthe__third-partyBext__packagebuilt__ontop__ofJonathan__Hartleys__Colorama package.Install__Bextwith__pipby__followingthe__instructionsin__Appendix A.Bext__onlyworks__inprograms__runfrom__ater__minal window,and__notfrom__Muor__mostother__code editors.To__have print()produce__colorful text,call__the fg()and__bg()functions__tochange__the (fore ground)text__coloror__thebackground__colorwith__astring__argumentsuch__as 'black', 'red', 'green', 'yellow', 'blue', 'magenta', 'purple', 'cyan',or__'white'.You__canalso__pass 'reset'to__changethe__colorback__tothe__terminalwindow__sdefault__color.For__example,enter__thefollowing__intothe__interactive shell: >>>import__bext >>> bext.fg('red')Designing__andDeploying__CommandLine__Programs 271Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11,runs__thecls__program (on Windows)or__theclear__program (onmacOS__and Linux).The__oddsyntax__hereis__anexample__ofPython__sconditional__expressions (alsocalled__ternaryoperators__inother__languages).The__syntaxis__value1if__conditionelse__value2,which__evaluatesto__value1if__conditionis__Trueand__value2if__conditionis__False.In__our case,the__conditionalexpression__evaluatesto__'cls'if__thecondition__os.name == 'nt'is__True; otherwise,it__evaluatesto__'clear'.Conditional__expressions__(and one-linersin__general)often__produceunreadable__codeand__areusually__best avoided,but__thisis__asimple__enough case.Sound__andText__NotificationTerminal__programsexisted__beforethe__richaudio__thattoday__scomputers__pro vide. Today,there__sno__reasonyour__text-basedprograms__mustbe__silent.There__are, however,good__reasonsto__keepsounds__toa__minimumor__toexclude__them altogether.Sounds__canprovide__notificationthat__atask__iscomplete__ora__problem__hasoccurred__whenthe__useris__busylooking__atother__windows. But,like__colorful text,it__seasy__tooveruse__soundsto__thepoint__of annoyance.The__usermay__alreadybe__doinga__taskthat__involvesplaying__audio,or__perhapsthey__rein__anonline__meetingthat__thesound__wouldrudely__interrupt.And__ifthe__users__computeris__muted,they__wont__hearthe__soundnotification__anyway.If__youjust__needto__playa__simpleaudio__file,you__canuse__theplaysound__third-party package.Once__its__installed,you__canplay__anaudio__fileby__callingthe__playsoundmodule__s playsound()function__andpassing__thefilepath__ofan__MP3or__WAVaudio__file.Download__the hello.mp3file__from https://autbor .com /hello .mp3 (oruse__yourown__file)and__enterthe__followinginto__theinteractive__shell: >>>import__playsound >>> playsound.playsound('hello.mp3')The__playsound()function__wont__returnuntil__theaudio__filehas__finished playing;that__is,the__functionblocks__untilthe__audiohas__finished.Keep__inmind__thatthis__willhalt__yourprogram__fora__whileif__yougive__ita__longaudio__fileto__play.If__playsound()raises__exceptions (whichhappens__ifthe__filenamecontains__oddcharacters__suchas__anequal__sign),try__passinga__Pathobject__ofthe__audiofile__insteadof__a string. Similarly,you__maywant__tolimit__thetext__producedby__your program.Under__theUnix__philosophyof__command design,piping__thetext__outputof__onecommand__toanother__iseasier__ifthe__commandoutputs__onlyrelevant__Designingand__DeployingCommand__LinePrograms__273Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19.) However,if__youaren__tpiping__theoutput__toanother__command but,as__ahuman__user,want__tosee__more information,many__commands__accepta__-vor__--verbosecommand__lineargument__toenable__thisverbose__mode.Other__commandstake__theopposite__approachand__floodthe__outputwith__information,but__offera__-qor__--quietcommand__lineargument__tooffer__aquiet__modeof__notext__output instead. (Thiscould__doubleas__away__tomute__soundnotifications__as well.)Or__better yet,make__silencethe__defaultbehavior__andhave__--verboseor__--beepenable__soundor__alert beeps.If__yourprogram__doesnt__requirethis__levelof__sophistication,you__canignore__this consideration. However,once__youstart__sharingyour__programswith__otherswho__mayuse__itin__cleverways__youdidn__t foresee,offering__theseoptions__goesa__longway__towardmaking__yourprograms__user-friendly.A__Short Program:Snowstorm__Lets__createa__text-basedsnowstorm__animation.Our__programuses__blocktext__charactersthat__fillout__thetop__half-block,bottom__half-block,and__fullblock__ofa__singlecharacter__cell.These__textcharacters__arereturned__asstrings__by chr(9600), chr(9604),and__chr(9608), respectively,and__ourprogram__storesthem__inthe__constants TOP, BOTTOM,and__FULLto__makeour__codemore__readable.Enter__thefollowing__codeinto__afile__named snowstorm.py:import__os, random, time,sys__TOP = chr(9600) #Character__9600is__' 'BOTTOM__= chr(9604) #Character__9604is__' 'FULL__= chr(9608) #Character__9608is__' ' #Set__thesnowstorm__densityto__thecommand__line argument:DENSITY__= 4 #Default__snowdensity__is 4%if__len(sys.argv) > 1:DENSITY__= int(sys.argv[1])def__clear(): os.system('cls'if__os.name == 'nt'else__'clear')while__True: clear() #Clear__theterminal__window. #Loop__overeach__rowand__column:for__yin__range(20):for__xin__range(40):if__random.randint(0, 99) < DENSITY: #Print__snow: print(random.choice([TOP, BOTTOM]), end='') 274Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12Automate__theBoring__Stuffwith__Python, 3rdedition__(contents: @call %HOMEDRIVE%%HOMEPATH%\Scripts\.venv\Scripts\activate.bat @python %HOMEDRIVE%%HOMEPATH%\Scripts\yourScript.py %* @pause @deactivateThe__batchfile__canbe__named anything,but__its__easierto__rememberif__ithas__thesame__nameas__thePython__script.This__batchfile__runsthree__com mands.The__firstcommand__activatesthe__virtualenvironment__youcreated__foryour__Scripts folder.The__@symbol__atthe__startmakes__thecommand__itselfnot__appearin__theterminal__window.The__%HOMEDRIVE%environment__variableis__'C:'and__the %HOMEPATH%environment__variableis__thepath__toyour__home folder,like__'\Users\al'. (Thetilde__[~]doesn__trepresent__thehome__folderon__Windows.)When__combined,this__providesthe__pathto__thevirtual__environment__activationscript__nomatter__whatyour__username is. (Thisis__helpfulif__youshare__thesefiles__witha__co-workerfor__themto__runon__their computer.)Note__thatthe__callis__necessary;if__abatch__file (like yourScript.bat)runs__anotherbatch__file (like activate.bat)without__call,the__restof__thefirst__batchfile__scommands__wont__be run. Next,the__batchfile__runs python.exe,which__thenruns__yourScript.py.The__%*causes__thebatch__fileto__forwardany__commandline__argumentsit__receivedto__yourPython__program.It__sa__goodidea__toalways__includethe__%*in__caseyou__lateradd__commandline__argumentsto__yourPython__program.The__thirdcommand__runsthe__pause command,which__causesWindows__todisplay__Pressany__keyto__continueand__waitfor__theuser__topress__a key.This__preventsthe__terminalwindow__fromimmediately__closingafter__thePython__programfinishes__sothat__youcan__seeany__remainingprinted__output.If__yourprogram__hasno__printed output,you__canomit__this line. Finally,the__@deactivateline__deactivatesthe__virtualenvironment__incase__youran__thisbatch__filefrom__theterminal__andthe__terminalwindow__remainsopen__afterfinishing__thePython__program.With__thebatch__fileset__up,now__youcan__runyour__Pythonscript__bypress__ingthe__Windowskey__+R__keycombination__tobring__upthe__Rundialog__boxand__enteringyourScript__(followedby__anycommand__line arguments)to__runthe__yourScript.bat script. Or,if__youhave__aterminal__window open,you__canjust__enteryourScript__inthe__terminalfrom__any folder.This__isfar__quickerthan__runningit__froma__codeeditor__like Mu.Designing__andDeploying__CommandLine__Programs 277Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterand__deploythem__foreasy__use.A__Short Program:Copying__theCurrent__WorkingDirectory__Whilethe__pwdcommand__onmacOS__andLinux__willprint__thecurrent__working__directory,it__ssometimes__usefulto__copythis__valueto__theclipboard__forpasting__elsewhere.For__example,on__Windows,I__constantlyfind__myselfcopy__ingthe__currentworking__directoryfrom__aterminal__sothat__Ican__pasteit__ina__SaveFile__dialogbox__tosave__afile__inthat__same directory.Although__Icould__usethe__mouseto__selectthe__currentworking__directoryfrom__theWindows__promptto__copy (or,on__macOSand__Linux,run__thepwd__commandto__printthe__workingdirectory__andselect__thattext__to copy),this__requiresseveral__stepsfor__whatcould__bea__one-step process.My__ideais__towrite__aprogram__namedccwd__(forcopy__currentworking__directory). First,I__llenter__whereccwd__onWindows__andwhich__ccwdon__macOSand__Linuxto__makesure__thereisn__tcurrently__acommand__withthe__same name,then__maybealso__doa__quickinternet__searchfor__ccwdto__be sure.The__nameccwd__isshort__enoughto__typebut__also unique.As__anadditional__feature,say__theterminal__scurrent__workingdirectory__wasset__to C:\Users\al\Scripts,but__whatI__wantedcopied__tothe__clipboardwas__C:\Users\al.I__couldjust__runthe__cd .. command,then__ccwd,then__cdScripts__toreturn__to C:\Users\al\Scripts.But__itwould__beeasier__ifI__couldpass__arelative__filepathto__ccwdas__acommand__line argument.For__example,ccwd__..would__copy C:\Users\alto__theclipboard__whenthe__currentworking__directorywas__C:\Users\al\Scripts.You__dont__haveto__specifythis__commandline__argument (theprogram__defaultsto__thecurrent__workingdirectory__ifnone__is given),but__its__availableas__afeature__ifthe__userwants__it.These__tinyimprovements__mayseem__trivial,but__onlineretailers__have one-clickbuying__featureson__theirwebsites__becausethey__knowthat__slightimprovements__toconvenience__canhave__amajor__effect.We__lluse__thePyperclip__packageto__handlethe__clipboard,so__besure__toinstall__thisinto__theScripts__folders__virtual environment.Create__anew__filein__Muand__enterthe__following content:import__pyperclip, os,sys__if len(sys.argv) > 1: os.chdir(sys.argv[1])pyperclip__.copy(os .getcwd()) 280Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13,you__lllearn__howto__scrapeall__thelinks__forthe__HTMLsource__ofthe__page.But__lets__sayyou__onlyneed__tocopy__someof__them,and__ahuman__mustdecide__whichones__ona__case-by-case basis.)You__couldfollow__these steps: 1. Right-clicka__linkin__aweb__browser. 2.Select__theCopy__Linkor__CopyLink__Addressitem__fromthe__context menu. 3.Switch__tothe__spreadsheet app. 4.Press__ctrl-Vto__pastethe__link. 5.Switch__backto__theweb__browser. 282Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(contents.if__content != previous_content: #If__it'sdifferent__fromthe__previous,print__it: print(content)previous_content__=content__time.sleep(0.01) #Pause__toavoid__hoggingthe__CPU.except__KeyboardInterrupt:pass__Lets__lookat__eachpart__ofthis__program,starting__withthe__beginning:import__pyperclip,time__print('Recording clipboard... (Ctrl-Cto__stop)')previous_content__= ''This__programcopies__andpastes__textfrom__the clipboard,so__well__needto__importthe__pyperclip module.We__llalso__usethe__timemodule__s sleep()func__tionto__keepthe__programfrom__hoggingthe__CPU.The__programdisplays__aquick__messageto__saythat__itis__runningand__remindsthe__userthat__ctrl-Ccauses__theprogram__to stop.The__programwill__knowthat__theclipboard__contents__havechanged__bykeeping__trackof__whatthe__contentswere__previouslywith__aprevious_content__variable,which__isinitially__setto__ablank__string. try:while__True:content__= pyperclip.paste() #Get__clipboard contents.The__bulkof__theprogram__existsin__aninfinite__while loop,which__itselfis__insidea__try block.When__theuser__presses ctrl-C,Python__raisesa__Designingand__DeployingCommand__LinePrograms__283Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__theclipboard__andnotes__eachtime__theuser__copiesnew__textto__it.Within__the loop,the__firststep__isto__collectthe__texton__theclipboard__bycalling__pyperclip.paste().if__content != previous_content: #If__it'sdifferent__fromthe__previous,print__it: print(content)previous_content__=content__Ifthe__currentcontent__onthe__clipboardis__differentfrom__theprevious__content,then__theprogram__printsthe__currentcontent__andupdates__previous_content__to content.This__setsup__theloop__forthe__nexttime__theuser__copiesnew__textto__the clipboard. time.sleep(0.01) #Pause__toavoid__hoggingthe__CPU.If__theclipboard__contentsare__thesame__asthe__previouslyobtained__clipboard__contents,we__couldhave__ourprogram__do nothing. However,this__program__caneasily__executethis__looptens__ofthousands__oftimes__a second,and__its__unlikelythat__theuser__willbe__updatingthe__clipboardthat__frequently. (Theyd__probablywear__outthe__ctrland__Ckeys__ontheir__keyboardif__they tried.)To__preventthe__programfrom__hoggingthe__CPUby__runningthis__unproductiveloop__asfast__as possible,we__introducea__0.01-seconddelay__sothat__theloop__checksfor__clipboardupdates__amere__100times__a second.except__KeyboardInterrupt:pass__Thelast__partof__theprogram__isthe__except clause,which__usesPython__spass__statement.This__statementliterally__does nothing,but__Pythonis__expecting__atleast__oneline__inthe__blockthat__followsthe__except statement.This__iswhat__thepass__statementwas__created for.When__theuser__presses ctrl-C,the__executionmoves__tothis__exceptclause__andproceeds__tothe__endof__thepro__gram,where__it terminates.With__thisapp__running,the__usercan__copyseveral__thingswithout__havingto__switchback__andforth__between apps.Small__programslike__thiscan__makeyour__workflowmuch__easier,especially__ifyou__haveto__dothis__workevery__day.Now__lets__deploythis__programon__eachoperating__system.Windows__Savethe__Pythonfile__as C:\Users\al\Scripts\cliprec.py (changingal__toyour__username).In__thesame__Scripts folder,create__a cliprec.batfile__withthe__following__content: @call %HOMEDRIVE%%HOMEPATH%\Scripts\.venv\Scripts\activate.bat @python %HOMEDRIVE%%HOMEPATH%\Scripts\cliprec.py %* 284Chapter__12Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,you__learnedhow__totake__yourprograms__outof__thecode__editor__anddeploy__themso__thatusers__canrun__themquickly__and conveniently.You__alsolearned__moreguidelines__abouthow__todesign__programsthat__have text-baseduser__interfacesinstead__ofmore__moderngraphical__ones.While__aGUI__isuser__friendly,TUIs__aresimpler__to code.When__youneed__toautomate__tasksfor__yourself,making__yourprogram__looklike__aprofessional__applicationisn__tworth__theextra__effort.You__justneed__somethingthat__works.That__said,there__areseveral__waysyou__candesign__yourprogram__tobe__easyto__use. Often,this__involvesthe__commandline__terminal,which__manyusers__arent__familiar with.It__maytake__awhile__tolearn__commandline__concepts__suchas__navigatingthe__filesystem__withcd__and dir/ls,the__PATHenviron__ment variable,and__commandline__arguments.But__theterminal__allowsyou__tovery__quicklyissue__commandsand__run programs,especially__afteryou__finish__writingthe__programsand__deploy them.This__chapteralso__coveredseveral__third-party packages.The__Bextpack__agelets__youadd__colorful text,position__the cursor,and__clearthe__screen.The__PyMsgBoxpackage__createsGUI__boxesfor__alertsor__basicinput__withoutusing__theterminal__window.Because__youmay__oneday__runprograms__thatrequire__incompatibleversions__ofthe__same package,it__sbest__torun__scriptsin__separate__virtual environments.You__cancreate__virtualenvironments__withthe__venvmodule__thatcomes__with Python.Virtual__environmentsare__activatedfrom__the terminal,and__canprevent__youfrom__breakingexisting__programsby__givingyou__aseparate__placeto__install packages. Finally,the__PyInstallerpackage__allowsyou__tocompile__your .pyfiles__intoexecutable__programs.They__maybe__severalmegabytes__in size,but__youcan__sharethese__programswith__co-workerswho__mightnot__havePython__(andthe__third-partypackages__yourprogram__uses)on__their computer.This__chapterdidn__tcover__manyprogramming__language concepts; rather,it__coveredhow__tomake__yourprograms__usableand__convenienton__a day-to-day basis.At__this point,you__knowenough__Pythonsyntax__tocreate__basicprograms__(althoughthere__salways__moreto__learn!).In__PartII__ofthis__book,you__llexplore__several third-partypackages__thatextend__thecapabilities__ofyour__Python programs.Practice__Questions 1.What__commandlists__foldercontents__on Windows?What__abouton__macOSand__Linux? 2.What__doesthe__PATHenvironment__variable contain? 3.What__doesthe____file__variable__contain? 4.What__commanderases__thetext__fromthe__terminalwindow__on Windows?What__abouton__macOSand__Linux? 5.How__doyou__createa__newvirtual__environment? 6.What__commandline__argumentshould__youpass__toPyInstaller__whencompiling__programs?Designing__andDeploying__CommandLine__Programs 287Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11Phone__Numberand__EmailAddress__Extractorfrom__Chapter 9Add__Bulletsto__WikiMarkup__fromChapter__8Interactive__ChessboardSimulator__fromChapter__7Any__otherprograms__youve__createdand__wantto__easilylaunch__orshare__withothers__Automatethe__BoringStuff__with Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,you__lllearn__aboutthe__following modules,which__makeit__easyto__scrapeweb__pagesin__Python:webbrowser__Comeswith__Pythonand__opensa__browserto__aspecific__pagerequests__Downloadsfiles__andweb__pagesfrom__theinternet__BeautifulSoup__(bs4)Parses__HTML,the__formatthat__webpages__arewritten__in,to__extractthe__informationyou__wantSelenium__Launchesand__controlsa__web browser,such__asby__fillingin__formsand__simulatingmouse__clicksPlaywright__Launchesand__controlsa__web browser;newer__thanSelenium__andhas__someadditional__featuresHTTP__andHTTPS__Whenyou__visita__website,its__web address,such__as https://autbor .com /example3 .html,is__knownas__auniform__resourcelocator__(URL).The__HTTPSin__theURL__standsfor__HypertextTransfer__Protocol Secure,the__protocolthat__yourweb__browseruses__toaccess__websites.The__packagesin__thischapter__allowyour__scriptsto__accessweb__serversthrough__this protocol.More__precisely,HTTPS__isan__encryptedversion__of HTTP,so__itprotects__yourprivacy__whileyou__usethe__internet.If__youwere__using HTTP,identity__thieves,national__intelligence agencies,and__yourinternet__serviceprovider__couldview__thecontent__ofthe__webpages__you visited,including__anypass__wordsand__creditcard__informationyou__submit.Using__avirtual__privatenetwork__(VPN)could__keepyour__internetservice__providerfrom__viewingyour__internet traffic; however,now__theVPN__providerwould__beable__toview__your traffic.An__unscrupulousVPN__providercould__thensell__informationabout__whatwebsites__youvisit__todata__brokers. (TomScott__discusseswhat__aVPN__doesand__doesnot__providein__his video,This__VideoIs__Sponsoredby__VPN. )By__contrast,any__webpage__contentyou__viewwith__HTTPSwill__beencrypted__and hidden.Websites__usedto__useHTTPS__onlyfor__pagesthat__sentpasswords__andcredit__card numbers,but__nowadays,most__websitesencrypt__all traffic.Keep__in mind, though,that__theidentity__ofthe__websiteyou__visitcan__stillbe__known;no__onewill__beable__tosee__exactlywhat__youdownload__fromCatPhotos__.com,but__theywill__seethat__youwere__connectingto__theCatPhotos__.comwebsite__andcan__figureout__thatyou__wereprobably__lookingat__photosof__cats.The__Tor Browser,which__usesthe__Toranonymization__network,can__provide__trueanonymous__browsing,and__youcan__downloadit__from https://www .torproject .org /download /.Web__Scraping 291Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__your clipboard.This__way,you__donly__haveto__copythe__addressto__aclipboard__andrun__thescript__forthe__mapto__loadfor__you.We__canput__theaddress__directlyinto__theOpenStreetMap__URL,so__allwe__needis__the webbrowser.open() function.This__iswhat__yourprogram__does:Gets__astreet__addressfrom__thecommand__linearguments__orclipboard__Opensthe__webbrowser__tothe__OpenStreetMappage__forthat__addressThis__meansyour__codeneeds__todo__the following:Read__thecommand__linearguments__from sys.argv.Read__theclipboard__contents.Call__the webbrowser.open()function__toopen__theweb__browser.Open__anew__fileeditor__taband__saveit__as showmap.py.Step__1:Figure__Outthe__URLBy__followingthe__instructionsin__Chapter 12,set__upa__showmap.pyfile__sothat__whenyou__runit__fromthe__command line,like__so . . . C:\Users\al>showmap__777Valencia__St,San__Francisco,CA__94110 . . .the__scriptwill__usethe__commandline__argumentsinstead__ofthe__clip board.If__thereare__nocommand__line arguments,then__theprogram__willknow__touse__thecontents__ofthe__clipboard.To__do so,you__needto__figureout__whatURL__touse__fora__givenstreet__address.When__youload__https://www .openstreetmap .orgin__thebrowser__andsearch__foran__address,the__URLin__theaddress__barlooks__somethinglike__this: https://www .openstreetmap .org /search ?query =777%20Valencia%20St%2C%20 San%20Francisco%2C%20CA%2094110#map =19 /37 .75897 / -122 .42142.We__cantest__thatthe__URLdoesn__tneed__the #mappart__bytaking__itout__ofthe__addressbar__andvisiting__thatsite__toconfirm__itstill__loads properly. So,your__programcan__beset__toopen__aweb__browserto__https://www .openstreetmap .org / 292Chapter__13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 24.Accessing__aWeather__APIThe__appsyou__useare__designedto__interactwith__human users. However,you__canwrite__programsto__interactwith__otherprograms__throughtheir__applicationprogramming__interface (API),which__isthe__specificationthat__defineshow__onepiece__ofsoftware__(suchas__yourPython__program)can__communicatewith__anotherpiece__ofsoftware__(suchas__theweb__serverfor__aweather__site).Online__servicesoften__have APIs.For__example,you__couldwrite__aPython__scriptto__postto__yoursocial__mediaaccounts__ordownload__new photos.In__thissec__tion,we__llwrite__ascript__thataccesses__weatherinformation__fromthe__freeOpenWeather__website.Almost__allonline__servicesrequire__youto__registeran__emailaddress__touse__their API.Even__ifthe__APIis__free,they__mayhave__limitsto__howmany__APIrequests__youcan__makeper__houror__day.If__youre__worriedabout__receivingspam__email,you__canuse__a temporary,disposable__emailaddress__servicesuch__as https://10minutemail .com.Keep__inmind__thatyou__shoulduse__suchservices__onlyto__registerfor__onlineaccounts__youdon__tcare__about,as__anunscrupu__lousemail__servicecould__takecontrol__ofyour__onlineaccount__bymaking__apassword__resetrequest__inyour__name.To__start,sign__upfor__afree__accountat__https://openweathermap .org.The__freeaccount__tierlimits__youto__making 60API__requestsper__minute.This__ismore__thanenough__foryour__smallor__medium-sizedprogramming__projects.If__yourprogram__needsmore__thanthis__limit (say,because__its__processingrequests__fromhundreds__ofsimultaneous__visitorsto__your website),you__canpurchase__apaid__account tier.Online__serviceswill__giveyou__anAPI__key,which__issort__ofa__passwordthat__identifiesyour__accountin__yourAPI__requests.Keep__thisAPI__keya__secret!Anyone__withthis__keycan__makeAPI__requestscredited__toyour__account.If__youwrite__aprogram__thatuses__anAPI__key,consider__havingthe__programread__atext__filethat__containsthe__keyinstead__ofincluding__theAPI__keydirectly__inyour__source code.This__way,you__canshare__yourprogram__withothers__(whocan__signup__fortheir__ownAPI__key)without__worryingabout__exceedingthe__APIrequest__limitsof__your account.Many__HTTPAPIs__delivertheir__responsesas__onelarge__string.This__stringis__oftenformatted__asJSON__or XML.Chapter__18covers__JSONand__XMLin__more detail,but__for now,you__justneed__toknow__that json.loads(response.text)returns__aPython__datastructure__oflists__anddictionaries__containingthe__JSONdata__in response.text.The__examplesin__thischapter__storethis__datain__avari__ablenamed__response_data,but__thisis__anarbitrary__choice,and__youcan__useany__variablename__youd__like.All__onlineservices__documenthow__touse__their API.OpenWeather__provides__itsdocumentation__at https://openweathermap .org /api.After__youve__loggedin__toyour__accountand__obtainedyour__APIkey__fromthe__MyAPI__keyspage__at https://home .openweathermap .org /api _keys,use__itin__thefollowing__interactive 298Chapter__13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19discusses__Pythons__datetimemodule__inmore__detail. response_data['list'][0]['main']Holds__adictionary__withkeys__like 'temp', 'feels_like', 'humidity',and__others.Web__Scraping 301Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterassumes__youhave__somebasic__experiencewith__HTML,but__ifyou__needa__beginnertuto__rial,I__suggestone__ofthe__following sites: https://developer .mozilla .org /en -US /docs /Learn /HTML https://www .freecodecamp .org /news /html -coding -introduction -course -for -beginners https://www .khanacademy .org /computing /computer -programming /html -cssIn__this section,you__llalso__learnhow__toaccess__yourweb__browsers__powerful__Developer Tools,which__makescraping__informationfrom__theweb__much easier.Exploring__theFormat__AnHTML__fileis__aplaintext__filewith__the .htmlfile__extension.The__textin__thesefiles__issurrounded__byHTML__tags,which__arewords__enclosedin__anglebrackets__(<>).The__tagstell__thebrowser__howto__formatthe__web page.A__starting__tagand__closingtag__canenclose__sometext__toform__anHTML__element.The__textto__displayis__thecontent__betweenthe__startingand__closing tags.For__example,the__followingHTML__willdisplay__Hello, world!in__the browser,with__Helloin__bold: Hello, world! 302Chapter__13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,to__findthe__element__inthe__string.The__CSSselector__syntaxused__inthis__stringspecifies__whichHTML__elementsto__retrievefrom__aweb__page.The__fullselector__syntaxis__beyondthe__scopeof__this book,but__youcan__obtainthe__selectorfrom__thebrowser__Developer Tools,as__wedid__here.XPath__isanother__syntaxfor__selectingHTML__elements,but__isalso__beyondthe__scopeof__this book.Keep__inmind__thatwhen__awebsite__changesits__layout,you__llneed__toupdate__theHTML__tagsyour__scripts check.This__canhappen__withlittle__orno__warning,so__besure__tokeep__aneye__onyour__programin__caseit__suddenlydisplays__errorsabout__notbeing__ableto__find elements.In__general,it__sbetter__touse__awebsite__sAPI__ifit__offers one,as__its__muchless__likelyto__changethan__thewebsite__itself.Parsing__HTMLwith__BeautifulSoup__BeautifulSoup__isa__packagefor__extractinginformation__froman__HTML page.You__lluse__thename__beautifulsoup4to__installthe__packagebut__theshorter__modulename__bs4to__import it.In__this section,we__lluse__BeautifulSoup__toparse__(that is,analyze__andextract__theparts__of)the__HTMLfile__at https://autbor .com /example3 .html,which__hasthe__following content:Example__WebsiteTitle__ExampleWebsite__This <p>tag__putscontent__intoa__single paragraph.This__textis__alink__tobooks__byAl__Sweigart.Learn__toprogram__in Python! Username: Password:Web__Scraping 307Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12for__howto__easilyrun__programson__youroperating__system.Ideas__forSimilar__ProgramsThe__benefitof__tabbedbrowsing__isthat__youcan__easilyopen__linksin__newtabs__toperuse__later.A__programthat__automaticallyopens__severallinks__atonce__canbe__anice__shortcutto__dothe__following:Open__allthe__productpages__aftersearching__ashopping__sitesuch__as Amazon.Open__allthe__linksto__reviewsfor__asingle__product.Open__theresult__linksto__photosafter__performinga__searchon__aphoto__sitesuch__asFlickr__or Imgur.Project__8:Download__XKCDComics__Blogs,web__comics,and__otherregularly__updatingwebsites__usuallyhave__afront__pagewith__themost__recent post,as__wellas__aPrevious__buttonon__thepage__thattakes__youto__theprevious__post.That__postwill__alsohave__aPrevious__button,and__so on,creating__atrail__fromthe__mostrecent__pageto__thefirst__poston__the site.If__youwanted__acopy__ofthe__sites__contentto__readwhen__youre__not online,you__couldmanually__navigateover__everypage__andsave__each one.But__thisis__prettyboring__work,so__lets__writea__programto__doit__instead. XKCD,shown__inFigure__13-5,is__apopular__geekwebcomic__witha__websitethat__fitsthis__structure.The__frontpage__at https://xkcd .comhas__aPrev__buttonWeb__Scraping 313Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter that,to__savefiles__youve__downloaded__using requests,you__needto__loopover__thereturn__valueof__theWeb__Scraping 317Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsto__sight-impaired users.Some__browsersshow__thealt__textas__atool__tipif__youhover__themouse__cursorover__the image.The__page.get_by _alt_text('Zophie')call__wouldreturn__theelement__in .If__youjust__needto__obtaina__Locatorobject__viaa__CSS selector,call__the locator()locator__andpass__itthe__selector string.This__issimilar__toSelenium__s find_elements()method__withthe__By.CSS_SELECTOR constant.Table__13-6:Locator__MethodsMethod__Description get_attribute(name)Returns__thevalue__forthe__elements__name attribute,such__as 'https://nostarch .com'for__thehref__attributein__anelement__count()Returns__aninteger__ofthe__numberof__matchingelements__inthis__Locatorobject__nth(index)Returns__aLocator__objectof__thematching__elementgiven__bythe__index.For__example, nth(3)returns__thefourth__matchingelement__sinceindex__0is__thefirst__matching element.first__TheLocator__objectof__thefirst__matching element.This__isthe__sameas__nth(0).last__TheLocator__objectof__thelast__matching element.If__there are, say,five__match elements,this__isthe__sameas__nth(4). all()Returns__alist__ofLocator__objectsfor__eachindividual__matchingelement__inner_text()Returns__thetext__withinthe__element,such__as 'hello'in__hello inner_html()Returns__theHTML__sourcewithin__the element,such__as 'hello'in__hello click()Simulates__aclick__onthe__element,which__isuseful__for link, checkbox,and__buttonelements__is_visible()Returns__Trueif__theelement__is visible; otherwise,returns__False is_enabled()For__input elements,returns__Trueif__theelement__is enabled;oth__erwise,returns__False is_checked()For__checkboxor__radiobutton__elements,returns__Trueif__theele__mentis__selected; otherwise,returns__False bounding_box()Returns__adictionary__withkeys__'x'and__'y'for__theposition__ofthe__elements__top-leftcorner__inthe__page,along__withkeys__'width'and__'height'for__theelement__ssize__SinceLocator__objectscan__representmultiple__elements,you__canobtain__aLocator__objectfor__anindividual__elementwith__the nth() method,passing__theWeb__Scraping 327Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13Automate__theBoring__Stuffwith__Python, 3rdedition__(chapters,we__llintegrate__Pythoninto__twopopular__spreadsheet applications:Microsoft__Exceland__Google Sheets.Excel__isa__popularand__powerfulspreadsheet__applicationfor__Windows.The__openpyxlmodule__allowsyour__Pythonprograms__toread__andmodify__Excelspreadsheet__files.For__example,you__mighthave__theboring__taskof__copyingcertain__datafrom__onespreadsheet__andpasting__itinto__another one.Or__youmight__haveto__gothrough__thousandsof__rowsand__pickout__justa__handfulof__themto__makesmall__editsbased__onsome__criteria.Or__youmight__haveto__lookthrough__hundredsof__spreadsheetsof__department budgets, 14E__XCEL__SPR__EA__DSHEETS__332Chapter__14Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter, however,are__allfrom__the cloud-basedOffice__365 Excel.The__openpyxlmodule__operateson__Excel files,and__notthe__desktopExcel__applicationor__cloud-basedExcel__web app.If__youre__usingthe__cloud-basedOffice__365,you__mustclick__FileSave__AsDownload__aCopy__todownload__a spreadsheet,run__yourPython__scriptto__editthe__spreadsheet file,and__then re-uploadthe__spreadsheetto__Office 365to__seethe__changes.If__youhave__thedesktop__Excel application,you__mustclose__the spreadsheet,run__yourPython__scriptto__editthe__spreadsheet file,and__thenreopen__itin__Excelto__seethe__changes.Python__doesnot__comewith__openpyxl,so__youll__haveto__install it.Appendix__Ahas__informationon__howto__install third-partypackages__withPython__spip__tool.You__canfind__thefull__openpyxldocumentation__at https://openpyxl__.readthedocs .io /en /stable /.You__lluse__severalexample__spreadsheetfiles__inthis__chapter.You__candownload__themfrom__thebook__sonline__materialsat__https://nostarch .com / automatestuff3.Reading__ExcelFiles__First,let__sgo__oversome__basic definitions.An__Excelspreadsheet__documentis__calleda__workbook.A__singleworkbook__issaved__ina__filewith__the .xlsx extension.Each__workbookcan__containmultiple__sheets (alsocalled__worksheets).The__sheetthe__useris__currentlyviewing__(orlast__viewedbefore__closing Excel)is__calledthe__active sheet.Each__sheethas__columns (addressedby__lettersstarting__at A)and__rows (addressedby__numbersstarting__at 1).A__boxat__aparticular__columnand__rowis__calleda__cell.Each__cellcan__containa__numberor__text value.The__gridof__cellsand__theirdata__makesup__a sheet.The__examplesin__thischapter__willuse__aspreadsheet__named example3.xlsxstored__inthe__currentworking__directory.You__caneither__createthe__spreadsheetyourself__ordownload__itfrom__thisbook__sonline__resources.Figure__14-1shows__thetabs__forthe__threesheets__named Sheet1, Sheet2,and__Sheet3.Excel__Spreadsheets 333Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19explains__thedatetime__datatype__further.Specifying__acolumn__byletter__canbe__trickyto__program,especially__becauseafter__column Z,the__columnsstart__usingtwo__letters: AA, AB, AC,and__so on.As__an alternative,you__canalso__geta__cellusing__thesheet__s cell()method__andpassing__integersfor__itsrow__andcolumn__keyword arguments.The__firstrow__orcolumn__integeris__1,not__0.Continue__theinteractive__shellexam__pleby__enteringthe__following: >>> sheet.cell(row=1, column=2) >>> sheet.cell(row=1, column=2).value 'Apples' >>>for__iin__range(1, 8, 2): #Go__throughevery__other row. ... print(i, sheet.cell(row=i, column=2).value) ... 1Apples__3Pears__5Apples__7Strawberries__Usingthe__sheets__cell()method__andpassing__it row=1and__column=2gets__youa__Cellobject__forcell__B1,just__likespecifying__sheet['B1'] did.By__usingthis__cell()method__andits__keyword arguments,we__wrotea__forloop__toprint__thevalues__ofa__seriesof__cells.Say__youwant__togo__downcolumn__Band__printthe__valuein__everycell__withan__oddrow__number.By__passing 2for__the range()function__sstep__parameter,you__canget__cellsfrom__everysecond__row (inthis__case,all__the odd-numbered rows).This__examplepasses__thefor__loops__ivariable__asthe__cell()method__srow__keyword,and__uses 2for__thecol__umnkeyword__argumenton__eachcall__ofthe__method.Note__thatthis__methodaccepts__theinteger__2,not__thestring__'B'.You__candetermine__thesize__ofthe__sheetwith__theWorksheet__objects__max_rowand__max_column attributes.Enter__thefollowing__intothe__interactive shell: >>>import__openpyxl >>>wb__= openpyxl.load_workbook('example3.xlsx') >>>sheet__= wb['Sheet1'] >>> sheet.max_row #Get__thehighest__row number. 7 >>> sheet.max_column #Get__thehighest__column number. 3Note__thatthe__max_columnattribute__isan__integerrather__thanthe__letterthat__appearsin__Excel. 336Chapter__14Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14Automate__theBoring__Stuffwith__Python, 3rdedition__(contentslook__likeFigure__14-2.Figure__14-2:The__censuspopdata.xlsx__spreadsheetExcel__Spreadsheets 339Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__county_datato__it.This__codeimports__theopenpyxl__module,as__wellas__thepprint__module__thatyou__lluse__toprint__thefinal__countydata__1. Then,it__opensthe__340Chapter__14Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__county_datato__it.The__lasttwo__linesof__codeperform__theactual__calculation work,incre__mentingthe__valuefor__tracts 3and__increasingthe__valuefor__pop 4for__thecurrent__countyon__eachiteration__ofthe__for loop.The__othercode__isthere__becauseyou__cannotadd__acounty__dictionaryas__thevalue__fora__stateabbreviation__keyuntil__thekey__itselfexists__in county_data. (That is, county_data['AK']['Anchorage']['tracts'] += 1will__causean__errorif__the 'AK'key__doesnt__exist yet.)To__makesure__thestate__abbreviationkey__existsin__yourdata__structure,you__needto__callthe__setdefault()method__toset__avalue__ifone__doesnot__alreadyexist__forstate__1.Just__asthe__county_datadictionary__needsa__dictionaryas__thevalue__foreach__stateabbreviation__key,each__ofthose__dictionarieswill__needits__owndic__tionaryas__thevalue__foreach__countykey__2.And__eachof__thosedictionaries__inturn__willneed__thekeys__'tracts'and__'pop'that__startwith__theinteger__value 0. (Ifyou__everlose__trackof__thedictionary__structure,look__backat__theexample__dictionaryat__thestart__ofthis__section.)Since__setdefault()will__donothing__ifthe__keyalready__exists,you__cancall__iton__everyiteration__ofthe__forloop__withouta__problem.Step__3:Write__theResults__toa__FileAfter__thefor__loophas__finished,the__county_datadictionary__willcontain__allof__thepopulation__andtract__informationkeyed__bycounty__and state.At__this point,you__couldprogram__morecode__towrite__thisdata__toa__textfile__oranother__Excel spreadsheet.For__now,let__sjust__usethe__pprint.pformat()function__towrite__thecounty_data__dictionaryvalue__asa__massivestring__toa__filenamed__census2010.py.Add__thefollowing__codeto__thebottom__ofyour__program (makingsure__tokeep__it un-indentedso__thatit__staysoutside__thefor__loop): # readCensusExcel.py -Tabulates__countypopulation__andcensus__tracts. --snip-- #Open__anew__textfile__andwrite__thecontents__ofcounty_data__to it. print('Writing results...')result_file__= open('census2010.py', 'w') result_file.write('allData = ' + pprint.pformat(county_data)) result_file.close() print('Done.') 342Chapter__14Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3for__more information.)The__followingexample__createsa__newworkbook__andsets__cell A1to__a 24-pointitalic__font: >>>import__openpyxl >>>from__openpyxl.stylesimport__Font >>>wb__= openpyxl.Workbook() >>>sheet__= wb['Sheet'] 1 >>> italic_24_font = Font(size=24, italic=True) 2 >>> sheet['A1'].font = italic_24_font >>> sheet['A1'] = 'Hello, world!' >>> wb.save('styles3.xlsx')In__this example, Font(size=24, italic=True)returns__aFont__object,which__westore__in italic_24_font 1.The__keywordarguments__to Font()configure__theobject__sstyling__information,and__assigning sheet['A1'].fontthe__italic _24_fontobject__2applies__allof__that font-stylinginformation__tocell__A1.To__setfont__attributes,pass__keywordarguments__to Font().Table__14-2shows__thepossible__keywordarguments__forthe__Font() function.Table__14-2:Keyword__Argumentsfor__FontObjects__Keywordargument__Datatype__Descriptionname__StringThe__font name,such__as 'Calibri'or__'TimesNew__Roman'size__IntegerThe__pointsize__boldBoolean__True,for__boldfont__italicBoolean__True,for__italicfont__Youcan__call Font()to__createa__Fontobject__andstore__thatFont__objectin__a variable.You__thenassign__thatvariable__toa__Cellobject__sfont__attribute.For__example,this__codecreates__variousfont__styles: >>>import__openpyxl >>>from__openpyxl.stylesimport__Font >>>wb__= openpyxl.Workbook() >>>sheet__= wb['Sheet'] >>>bold_font__= Font(name='TimesNew__Roman', bold=True) >>> sheet['A1'].font =bold_font__>>> sheet['A1'] = 'BoldTimes__New Roman'Excel__Spreadsheets 349Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14Automate__theBoring__Stuffwith__Python, 3rdedition__(contents,or__ifyou__wantto__setsizes__ina__largenumber__ofspreadsheet__files,it__smuch__quickerto__writea__Pythonprogram__todo__it.You__canalso__hiderows__andcolumns__from view,or__freezethem__inplace__sothat__theyre__alwaysvisible__onthe__screen,appearing__onevery__pagewhen__youprint__thespreadsheet__(whichis__handyfor__headers).Setting__RowHeight__andColumn__WidthA__Worksheetobject__hasrow_dimensions__andcolumn_dimensions__attributesthat__controlrow__heightsand__column widths.For__example,enter__thefollowing__intothe__interactive shell: >>>import__openpyxl >>>wb__= openpyxl.Workbook() >>>sheet__= wb['Sheet'] >>> sheet['A1'] = 'Tall row' >>> sheet['B2'] = 'Wide column' >>> sheet.row_dimensions[1].height = 70 >>>sheet__.column _dimensions['B'] .width = 20 >>> wb.save('dimensions3.xlsx')A__sheets__row_dimensionsand__column_dimensionsare__dictionary-like values;row_dimensions__containsRowDimension__objects,and__column_dimensionscontains__ColumnDimension objects.In__row_dimensions,you__canaccess__oneof__theobjects__usingthe__numberof__therow__(inthis__case, 1or__2).In__column_dimensions,you__canaccess__oneof__theobjects__usingthe__letterof__thecolumn__(inthis__case,A__or B).The__dimensions3.xlsxspreadsheet__lookslike__Figure 14-6.Figure__14-6:Row__1and__columnB__setto__largerheights__andwidths__352Chapter__14Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,we__lltake__alook__atusing__Pythonto__interactwith__anotherspreadsheet__program:the__popularonline__GoogleSheets__application.Practice__QuestionsFor__thefollowing__questions,imagine__youhave__aWorkbook__objectin__thevari__able wb,a__Worksheetobject__in sheet,and__aSheet__objectin__sheet. 1.What__doesthe__openpyxl.load_workbook()function__return? 2.What__doesthe__wb.sheetnamesworkbook__attribute contain? 3.How__wouldyou__retrievethe__Worksheetobject__fora__sheetnamed__'Sheet1'? 356Chapter__14Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__thespread__sheet. Then,when__writingout__thenew__spreadsheet,use__afor__loopto__copythe__firstN__lines.For__theremaining__lines,add__Mto__therow__numberin__theoutput__spreadsheet.Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__theEZSheets__third-party library,which__presentsyou__witha__simplerway__toperform__common actions,handling__thedetails__ofthe__GoogleSheets__APIso__thatyou__dont__haveto__learn them.Installing__andSetting__UpEZSheets__Youcan__installEZSheets__withthe__pipcommand__linetool__byfollowing__theinstructions__inAppendix__A. 15GOOG__LESHEETS 360Chapter__15Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,I__llsay__yourGoogle__accountand__yourGmail__emailaddress__torefer__tothe__Googleaccount__thatowns__thespreadsheets__yourPython__program accesses.Google__mayslightly__changethe__layoutor__wordingon__itsGoogle__CloudConsole__website. However,the__basicsteps__Ive__outlinedshould__remainthe__same.Creating__aNew__GoogleCloud__Project First,you__needto__setup__aGoogle__Cloud project.In__your browser,go__to https://console .cloud .google .comand__signin__toyour__Googleaccount__withyour__usernameand__password.You__willbe__takento__aGetting__Started page.At__thetop__ofthe__page,click__Selecta__project.In__the pop-upwindow__that appears,click__New Project.This__shouldtake__youto__anew__project page.Google__Cloudwill__generatea__projectname__likeMy__Project 23135for__you,along__witha__randomproject__ID,like__macro-nuance-362516.These__values__wont__bevisible__tousers__ofyour__Python scripts,and__youcan__changethe__projectname__towhatever__nameyou__want,but__youcannot__changethe__project ID.I__justuse__thedefault__namethat__thewebsite__generatesfor__me.You__canleave__thelocation__setto__No organization.Free__Googleaccounts__canhave__upto__12 projects,but__youneed__onlyone__projectfor__allthe__Pythonscripts__youwant__to create.Click__theblue__Createbutton__tocreate__the project.Enabling__theSheets__andDrive__APIsOn__the https://console .cloud .google .com page,click__theNavigation__buttonin__theupper__left. (Theicon__hasthree__horizontalstripes__andis__oftencalled__thehamburger__icon.)Go__toAPIs__&Services__Libraryto__visitthe__APILibrary__page.You__llsee__manyGoogle__APIsfor__Gmail,Google__Maps,Google__Cloud Storage,and__otherGoogle__services.We__needto__allowour__projectto__usethe__GoogleSheets__andGoogle__Drive APIs.EZSheets__usesthe__GoogleDrive__APIto__uploadand__downloadspreadsheet__files.Scroll__down,locate__theGoogle__Sheets API,and__click it,or__enterGoogle__SheetsAPI__intothe__searchbar__tofind__it.This__shouldtake__youto__GoogleSheets__361Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__yourTrash__folderat__https://drive__.google .com /drive /trash.Notice__thatspreadsheets__inthe__Trashfolder__willstill__appearin__thedictionary__returnedby__listSpreadsheets().To__permanentlydelete__your spreadsheet,pass__Truefor__thepermanent__keyword argument: >>> ss.delete(permanent=True) >>> ezsheets.listSpreadsheets() {}In__general,permanently__deletingyour__spreadsheetswith__automatedscripts__isnot__agood__idea,because__its__impossibleto__recovera__spreadsheetthat__abug__inyour__scriptaccidentally__deleted.Even__freeGoogle__Driveaccounts__havegigabytes__ofstorage__available,so__youmost__likelydon__tneed__toworry__aboutfreeing__up space.Google__Sheets 367Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14to__Google Sheets.You__candownload__itfrom__thisbook__sonline__resources.The__firsteight__rowslook__likeTable__15-1.Table__15-1:The__FirstEight__Rowsof__the produceSales3.xlsxSpreadsheet__AB__CD__1PRODUCE__COSTPER__POUNDPOUNDS__SOLDTOTAL__2Potatoes__0. 86 21. 6 18. 58 3Okra__2. 26 38. 6 87.24 4Fava__beans 2. 69 32. 8 88. 23 5Watermelon__0. 66 27.3 18. 02 6Garlic__1.19 4. 9 5. 83 7Parsnips__2. 27 1.1 2. 5 8Asparagus__2. 49 37.9 94. 37To__uploadthis__spreadsheet,put__the produceSales3.xlsxfile__inthe__currentworking__directoryand__enterthe__followinginto__theinteractive__shell: >>>import__ezsheets >>>ss__= ezsheets.upload('produceSales3.xlsx') >>>sheet__= ss.sheets[0] >>> sheet.getRow(1) #The__firstrow__isrow__1,not__row 0. ['PRODUCE', 'COSTPER__POUND', 'POUNDS SOLD', 'TOTAL', '', ''] >>> sheet.getRow(2) ['Potatoes', '0.86', '21.6', '18.58', '', ''] 370Chapter__15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19,you__lllearn__toschedule__yourPython__programsto__runat__regular,specified__times.You__couldwrite__aprogram__thatregularly__checksa__GoogleForms__spreadsheetfor__responsesand__detectany__newentries__ithasn__tseen__before. Then,using__theinformation__inChapter__20,you__canhave__theprogram__sendyou__atext__sothat__youcan__get real-timenotifications__whena__formis__filled out.As__youve__seen,Python__is well-knownas__aglue__languagefor__tyingtogether__multipleexisting__software systems,letting__youcreate__anautomated__processmore__powerfulthan__thesum__ofits__parts.Project__11:Fake__BlockchainCryptocurrency__ScamIn__this project,we__lluse__GoogleSheets__asa__fakeblockchain__totrack__thetransactions__of Boringcoin,a__cryptocurrencyscam__Im__promoting. (Itturns__outthat__investorsand__customersdon__tcare__ifyour__blockchainproduct__usesa__realblockchain__data structure;they__willgive__youmoney__anyway.)The__URL https://autbor .com /boringcoinredirects__tothe__GoogleSheets__URLfor__Boringcoins__blockchain.The__spreadsheethas__three columns:the__senderof__the transaction,the__recipientof__the transaction,and__theamount__ofthe__transaction.The__amountis__deductedfrom__thesender__andadded__tothe__recipient.If__thesender__is 'PRE-MINE',this__moneyis__createdout__ofthin__airand__addedto__therecipient__account.Figure__15-5shows__thisGoogle__Sheet. 376Chapter__15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 15Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9,this__wouldbe__atricky__thingto__code. 16SQ__LITEDATA__BASES__384Chapter__16Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterintroduces__youto__SQLand__databaseconcepts__usingSQLite__(pronouncedeither__sequel-ite, es-cue-lite,or__es-cue-el-ite ),a__lightweightdatabase__includedwith__Python.SQLite__isthe__mostwidely__deployeddatabase__software,as__itruns__onevery__operatingsystem__andis__smallenough__toembed__withinother__applica tions.At__thesame__time,SQLite__ssimplifications__makeit__notablydifferent__fromother__databases.While__largedatabase__softwaresuch__as PostgreSQL, MySQL,Microsoft__SQL Server,and__Oracleare__intendedto__runon__dedicated__serverhardware__accessedover__a network,SQLite__storesthe__entiredatabase__ina__singlefile__onyour__computer.Even__ifyou__realready__familiarwith__SQL databases,SQLite__hasenough__ofits__ownquirks__thatyou__shouldread__thischapter__tolearn__howto__makethe__mostof__it.You__canfind__theonline__SQLitedocumentation__at https://sqlite .org /docs__.htmland__thePython__sqlite3module__documentationat__https://docs .python .org /3 /library /sqlite3 .html.Spreadsheets__vs.Databases__Lets__considerthe__similaritiesand__differencesbetween__spreadsheetsand__databases.In__a spreadsheet,rows__containindividual__records,while__columnsrepresent__thekind__ofdata__storedin__thefields__ofeach__record.For__example,Figure__16-1is__aspreadsheet__ofsome__ofmy__cats.The__columnslist__the name, birthday,fur__color,and__weight (in kilograms)of__each cat.Sqlite__Databases 385Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14and__theEZSheets__libraryfrom__Chapter 15and__leavingit__inan__Excelor__Google spreadsheet.SQLite__vs.Other__SQLDatabases__Ifyou__reused__toworking__withother__SQL databases,you__mightbe__wondering__howSQLite__compares.In__short,SQLite__strikesa__balancebetween__simplicity__and power.It__sa__fullrelational__databasethat__usesSQL__toread__andwrite__massiveamounts__of data,but__itruns__withinyour__Pythonprogram__andoperates__ona__single file.Your__programimports__the sqlite3module__justas__itwould__import sys, math,or__anyother__modulein__thePython__standard library.Here__arethe__maindifferences__betweenSQLite__andother__database software:SQLite__databasesare__storedin__asingle__file,which__youcan__move, copy,or__backup__likeany__other file.SQLite__canrun__oncomputers__withfew__resources,such__asembedded__devicesor__decades-old laptops.SQLite__is serverless;it__doesnt__requirea__backgroundserver__applicationto__constantlyrun__onyour__laptop,or__anydedicated__server hardware.There__areno__networkconnections__involved.From__theperspective__of users,SQLite__doesnt__requireany__installationor__configuration.It__spart__ofthe__Python program.For__faster performance,SQLite__databasescan__existentirely__inmemory__andbe__savedto__afile__beforethe__program exits.While__SQLitecolumns__havedata__types,such__asnumbers__and text,just__asother__SQLdatabases__do,SQLite__doesnt__strictlyenforce__acolumn__sdata__type.There__areno__permissionsettings__oruser__rolesin__SQLite.SQLite__hasno__GRANTor__REVOKEstatements__likein__otherSQL__databases.SQLite__ispublic__domain software;you__canuse__itcommercially__orany__wayyou__wantwithout__restriction.The__maindisadvantage__ofSQLite__isthat__itcan__tefficiently__handlehundreds__orthousands__ofsimultaneous__writeoperations__(say,from__asocial__388Chapter__16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18).If__yourprogram__needsthe__abilityto__storeand__quicklyretrieve__largeamounts__of data,SQLite__isa__betteralternative__toJSON__orspreadsheet__files.Creating__Databasesand__TablesLet__sbegin__bycreating__ourfirst__databaseand__tableusing__SQL.SQL__isa__minilanguage__youcan__workwith__fromwithin__Python,much__likeregex__forregular__expressions.Like__regex,SQL__queriesare__writtenas__Pythonstring__values.And__justas__youcould__writeyour__ownPython__codeto__performthe__text pattern-matchingthat__regularexpressions__perform,you__couldwrite__yourown__customPython__codeto__searchfor__matchingdata__inPython__dictionariesand__lists.But__writingregular__expressionsand__SQLdatabase__queriesmakes__thesetasks__muchsimpler__inthe__long run,even__ifthey__firstrequire__youto__learna__new skill.Let__sexplore__howto__writequeries__thatcre__atetables__ina__new database.We__llcreate__asample__SQLitedatabase__ina__filenamed__example.dbto__storeinformation__about cats.To__createa__database,first__importthe__sqlite3mod__ule. (The 3is__forSQLite__majorversion__3,which__isunrelated__toPython__3.)A__SQLitedatabase__livesin__asingle__file.The__nameof__thefile__canbe__any thing,but__byconvention__wegive__ita__.dbfile__extension.The__extension .sqliteis__alsocommonly__used.A__databasecan__containmultiple__tables,and__eachtable__shouldstore__oneparticular__typeof__data.For__example,one__tablecould__containrecords__of cats,while__anothertable__couldcontain__recordsof__vaccinationsgiven__tospe__cificcats__inthe__first table.You__canthink__ofa__tableas__alist__of tuples,where__eachtuple__isa__table row.The__catstable__isessentially__thesame__as [('Zophie', '2021-01-24', 'black', 5.6), ('Colin', '2016-12-24', 'siamese', 6.2), ...],and__so on.Let__screate__a database,then__createa__tablefor__thecat__data,insert__somecat__recordsinto__it,read__thedata__fromthe__database,and__closethe__database connection.Connecting__toDatabases__Thefirst__stepof__writingSQLite__codeis__gettinga__Connectionobject__forthe__databasefile__bycalling__sqlite3 .connect().Enter__thefollowing__intothe__interactive__shell: >>>import__sqlite3 >>>conn__= sqlite3 .connect('example .db', isolation_level=None)Sqlite__Databases 389Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10explains__howto__usethe__exists()Path__methodand__os.path.exists() function,which__cantell__yourprogram__ifa__fileexists__or not.The__isolation_level=Nonekeyword__argumentcauses__thedatabase__touse__write-ahead logging,or__WAL mode.The__detailsof__WALmode__arebeyond__thescope__ofthis__book,but__in general,always__useWAL__modeis__goodadvice__for beginners.The__sqlite3 .connect()function__returnsa__Connection object,which__westore__ina__variablenamed__connfor__these examples.Each__Connectionobject__connectsto__oneSQLite__database file.You__can,of__course,choose__anyvari__ablename__youd__likefor__thisConnection__object,and__youshould__usemore__descriptivevariable__namesif__yourprogram__opensmultiple__databasesat__thesame__time.But__forsmall__programsthat__connectto__onlyone__databaseat__a time,the__nameconn__iseasy__towrite__anddescriptive__enough. (Thename__conwould__beeven__shorter,but__iseasy__tomisunderstand__as console, content,or__confusingname__fora__variable. )When__yourprogram__isdone__withthe__database,call__conn.close()to__closethe__connection.The__programalso__closesthe__connectionautomatically__whenit__terminates.Creating__TablesAfter__connectingto__a new,blank__database,create__atable__witha__CREATETABLE__SQL query.To__runSQL__queries,you__mustcall__the execute()method__ofConnection__objects.Pass__this conn.execute()method__astring__ofthe__query: >>>import__sqlite3 >>>conn__= sqlite3 .connect('example .db', isolation_level=None) >>> conn.execute('CREATETABLE__IFNOT__EXISTScats__(nameTEXT__NOT NULL,birthdate__TEXT,fur__TEXT,weight_kg__REAL) STRICT')By__convention,SQL__keywords,such__asCREATE__and TABLE,are__writtenusing__uppercase letters. However,SQLite__doesnt__enforce this;the__query 'createtable__ifnot__existscats__(nametext__not null,birthdate__text,fur__text,weight_kg__real) strict'runs__just fine.Table__andcolumn__namesare__also case-insensitive,but__theconvention__isto__makethem__lowercaseand__toseparate__multiplewords__with underscores,as__in weight_kg.The__CREATETABLE__statementraises__a sqlite3.OperationalError:table__catsalready__existsexception__ifyou__tryto__createa__tablethat__alreadyexists__390Chapter__16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.You__canlearn__moreabout__themin__theSQLite__documentation.Creating__Indexesfor__FasterData__ReadingIn__aprevious__section,we__rana__SELECTquery__tofind__recordsbased__onmatch__ing names.You__couldspeed__upthis__searchby__creatingan__indexon__thename__column.A__SQLindex__isa__datastructure__thatorganizes__acolumn__s data.As__a result,queries__withWHERE__clausesthat__usethese__columnswill__perform better.The__downsideis__thatthe__indextakes__upa__littlebit__more storage,so__queriesthat__insertor__updatedata__willbe__slightly slower,because__SQLitemust__alsoupdate__thedata__s index.If__yourdatabase__is large,and__youread__datafrom__itmore__oftenthan__youinsert__orupdate__its data,creating__anindex__maybe__worthwhile. However,you__shouldconduct__testingto__verifythat__theindex__actuallyimproves__performance.To__createindexes__on, say,the__namesand__birthdatecolumns__inthe__cats table,run__thefollowing__CREATEINDEX__queries: >>>import__sqlite3 >>>conn__= sqlite3 .connect('sweigartcats .db', isolation_level=None) >>> conn.execute('CREATEINDEX__idx_nameON__cats (name)') >>> conn.execute('CREATEINDEX__idx_birthdateON__cats (birthdate)')Indexes__require names,and__by convention,we__namethem__afterthe__columnto__whichthey__apply,along__withthe__idx_ prefix.Index__namesare__globalacross__theentire__database,so__ifthe__databasecontains__multipletables__withcolumns__named birthdate,you__mayalso__wantto__includethe__tablein__400Chapter__16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11.If__yoursoftware__isconstantly__readingor__updatingthe__database__s contents, however,you__llneed__touse__theConnection__objects__backup()method__instead.For__example,enter__thefollowing__intothe__interactive shell: >>>import__sqlite3 >>>conn__= sqlite3 .connect('sweigartcats .db', isolation_level=None) >>>backup_conn__= sqlite3 .connect('backup .db', isolation_level=None) >>> conn.backup(backup_conn)The__backup()method__safelybacks__upthe__contentsof__the sweigartcats.dbdatabase__tothe__backup.dbfile__inbetween__theother__queriesbeing__runon__it.Now__thatyour__datais__safelybacked__up,your__catis__freeto__stepon__yourkey__boardas__muchas__it wants.Altering__andDropping__TablesAfter__creatinga__tablein__adatabase__andinserting__rowsinto__it,you__maywant__torename__thetable__orits__columns.You__mayalso__wishto__addor__deletecol__umnsin__the table,or__evendelete__theentire__table itself.You__canuse__anALTER__TABLEquery__toperform__these actions.The__followinginteractive__shellexamples__startwith__afresh__copyof__the sweigartcats.dbdatabase__file.Run__anALTER__TABLERENAME__queryto__renamethe__catstable__to felines: >>>import__sqlite3 >>>conn__= sqlite3 .connect('sweigartcats .db', isolation_level=None) >>> conn.execute('SELECTname__FROMsqlite_schema__WHERE type="table"').fetchall() [('cats',)] >>> conn.execute('ALTERTABLE__catsRENAME__TO felines') #Rename__the table. >>> conn.execute('SELECTname__FROMsqlite_schema__WHERE type="table"').fetchall() [('felines',)] 404Chapter__16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4covers__exceptionhandling__withthe__tryand__except statements.Copying__DatabasesYou__canobtain__acopy__ofa__databaseby__callingthe__iterdump()method__onthe__Connection object.This__methodreturns__aniterator__thatgenerates__thetext__ofthe__SQLitequeries__neededto__re-createthe__database.You__canuse__iteratorsin__forloops__orpass__themto__the list()function__toconvert__themto__alist__of strings.For__example,to__getthe__SQLitequeries__neededto__re-createthe__sweigartcats.db database,enter__thefollowing__intothe__interactive shell: >>>import__sqlite3 >>>conn__= sqlite3 .connect('sweigartcats .db', isolation_level=None) >>>with__open('sweigartcats-queries.txt', 'w', encoding='utf-8')as__fileObj: ...for__linein__conn.iterdump(): ... fileObj.write(line + '\n')This__codecreates__a sweigartcats-queries.txtfile__withthe__followingSQLite__queries,which__can re-createthe__database:BEGIN__TRANSACTION;CREATE__TABLE "cats" (nameTEXT__NOT NULL,birthdate__TEXT,fur__TEXT,weight_kg__REAL) STRICT;INSERT__INTO "cats" VALUES('Zophie','2021-01-24','gray tabby',5.6);INSERT__INTO "cats" VALUES('Miguel','2016-12-24','siamese',6.2);INSERT__INTO "cats" VALUES('Jacob','2022-02-20','orangeand__white',5.5); --snip--INSERT__INTO "cats" VALUES('Spunky','2015-09-04','gray',5.9); 408Chapter__16Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12for__informationabout__thePATH__environmentvariable__andterminal__windows.)The__sqlite3command__ispreinstalled__on macOS.For__UbuntuLinux,run__sudoapt__install sqlite3to__install it. Next,in__aterminal__window,run__sqlite3 example.dbto__connectto__thedatabase__in example.db.If__thisfile__doesnt__exist, sqlite3creates__thisfile__withan__empty database.You__canenter__SQLqueries__intothis__tool,though__unlikethe__queriespassed__to conn.execute()in__Python,they__mustend__witha__semi colon. Also,text__valuesin__SQLitemust__beenclosed__insingle__quotes only;double__quotesare__not allowed.For__example,enter__thefollowing__intothe__terminal window: C:\Users\Al>sqlite3 example.dbSQLite__version 3.xx.xxEnter__".help"for__usage hints. sqlite>CREATE__TABLEIF__NOTEXISTS__cats (nameTEXT__NOT NULL,birthdate__TEXT,fur__TEXT,weight_kg__REAL) STRICT; sqlite>INSERT__INTOcats__VALUES ('Zophie', '2021-01-24', 'gray tabby', 4.7); sqlite>SELECT__*from__cats; Zophie|2021-01-24|gray tabby|4.7As__youcan__seein__this example,the__sqlite3command__linetool__providesa__sortof__SQLiteinteractive__shellfor__youto__enterqueries__atits__sqlite> prompt.The__.helpcommand__displaysadditional__commands,such__as .tables (whichshows__thetables__inthe__database)and__.headers (whichlets__youturn__columnheaders__onor__off): sqlite> .tablescats__sqlite> .headerson__sqlite>SELECT__*from__cats; name|birthdate|fur|weight_kg Zophie|2021-01-24|gray tabby|4.7Sqlite__Databases 409Automate__theBoring__Stuffwith__Python, 3rdedition__(introductionto__databasesin__general.SQLite__databaseslive__ina__singlefile__withouta__dedicated server.They__cancontain__multipletables__(whichyou__canthink__ofas__analogousto__spread sheets),and__eachtable__cancontain__multiple columns.To__edita__tables__val ues,you__canperform__theCRUD__operations (for create, read, update,and__delete)with__the INSERT, SELECT, UPDATE,and__DELETE queries.To__changetables__andcolumns__themselves,you__canuse__theALTER__TABLEand__DROPTABLE__queries. Lastly,foreign__keysallow__youto__linkrecords__inmultiple__tablestogether__usinga__techniquecalled__joins.There__sa__lotmore__toSQLite__anddatabases__thancan__becovered__inone__chapter.If__youd__liketo__learnmore__aboutSQL__databasesin__general,I__recommend__Practical SQL, 2ndEdition__(Chapter 16Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterwill__covertwo__of them:PyPDF__and Python-Docx.PDF__DocumentsPDF__standsfor__PortableDocument__Formatand__usesthe__.pdffile__extension.Although__PDFssupport__many features,this__sectionwill__focuson__three 17PDF__ANDWOR__DDOCU__MENTS 414Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterfrom__mybook__onrecursive__algorithms,The__RecursiveBook__ofRecursion__(Chapter1.pdffile__fromthe__onlineresources__at https://nostarch .com /automate -boring -stuff -python -3rd -edition,then__enterthe__following__intothe__interactive shell: >>>import__pypdf 1 >>>reader__= pypdf.PdfReader('Recursion_Chapter1.pdf') 2 >>> len(reader.pages) 18 416Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter1.pdf'TEXT_FILENAME__= 'recursion.txt'text__= '' try:reader__= pypdf.PdfReader(PDF_FILENAME) 1for__pagein__reader.pages: 2text__+= page.extract_text()except__Exception: 3text__= pdfminer.high_level.extract_text(PDF_FILENAME)with__open(TEXT_FILENAME, 'w', encoding='utf-8')as__file_obj: 4 file_obj.write(text)We__usethe__pypdfmodule__toextract__the text,but__ifit__failsfor__aparticu__larPDF__fileand__raisesan__exception,we__fallback__onthe__pdfminer module.Inside__atry__block,we__usea__forloop__1to__iterateover__eachPage__objectin__thePDF__files__PdfReader object.Calling__thePage__objects__extract_text()method__2returns__astring__thatwe__canconcatenate__tothe__text variable.When__theloop__finishes,text__willcontain__asingle__stringof__theentire__textof__the PDF.If__thePDF__filehas__anunconventional__formatthat__PyPDFcan__tunder__stand,we__cantry__using pdfminer.high_level,an__oldermodule__includedin__thisbook__s third-party packages.The__modules__extract_text()function__obtainsthe__PDFs__contentsas__asingle__string,rather__thanoperating__onepage__ata__time 3. Finally,we__canuse__the open()function__andthe__write()method__coveredin__Chapter 10to__writethe__stringto__atext__file 4. Post-Processingwith__AIThe__textextraction__wejust__performedisn__t perfect.The__PDFfile__formatis__infamouslyconvoluted__andwas__originallydesigned__forprinting__documents,not__formaking__themmachine__readable.Even__ifthere__areno__problemswith__the extraction,the__textlayout__is fixed:the__stringwill__containnewline__characters__aftereach__rowof__textand__hyphenatedwords__atthe__endsof__rows.For__instance,the__extractedtext__fromour__examplePDF__lookslike__this: 1WHAT__IS RECURSION?PDF__andWord__Documents 417Automate__theBoring__Stuffwith__Python, 3rdedition__(chapternumber__1from__thestart__ofthe__text,which__wasnt__my intention.You__mayhave__torefine__theprompt__tocorrect__any misunderstandings.If__youdon__thave__accessto__an LLM,the__PyPDFdocumentation__hasa__listof__post-processingtips__withcode__snippetsat__https://pypdf .readthedocs .io /en /latest__/user /post -processing -in -text -extraction .html. 418Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter PDF.Open__anew__fileeditor__taband__savethe__following__codeas__extractpdfimages.py:import__pypdfPDF_FILENAME__= 'Recursion_Chapter1.pdf'reader__= pypdf.PdfReader(PDF_FILENAME) 1image_num__= 0 2for__i,page__in enumerate(reader.pages): print(f'Readingpage__{i+1} - {len(page.images)}images__found...') try: 3for__imagein__page.images: 4with__open(f'{image_num}_page{i+1}_{image.name}', 'wb')as__file: 5 file.write(image.data) print(f'Wrote {image_num}_page{i+1}_{image.name}...') 6image_num__+= 1except__Exceptionas__exc: 7 print(f'Skippedpage__{i+1}due__to error: {exc}')The__outputof__thisprogram__willlook__like this:Reading__page 1 - 7images__found...Wrote__0_page1_Im0.jpg...Wrote__1_page1_Im1.png... --snip--Reading__page 7 - 1images__found...Skipped__page 7due__to error:not__enoughimage__data --snip--Reading__page 17 - 0images__found...Reading__page 18 - 0images__found...The__imagesin__aPDF__documentoften__havegeneric__names,like__Im0.jpgor__Im1.png,so__weuse__avariable__counternamed__image_num 1along__withthe__pagenumber__toassign__themunique__names. First,we__loopover__eachPage__objectin__thepages__attributeof__thePdfReader__object.Recall__thatPython__s enumerate()function__2returns__integerindexes__andthe__listitem__ofthe__list-like__objectwe__pass it.Each__Pageobject__hasan__imagesattribute__thatwe__lliter__ateover__aswell__3.Inside__that second,nested__forloop__thatiterates__overthe__Imageobjects__inthe__images attribute,we__call open()and__usean__f-stringto__providethe__filename__4.This__filenameis__madeup__ofthe__integerin__theimage_num__counter,the__page number,and__thestring__inthe__nameattribute__ofthe__Image object.Because__istarts__at 0while__PDFpage__numbersstart__at 1,we__use i+1to__storePDF__andWord__Documents 419Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter PDF,and__showedan__errormessage__instead. Meanwhile,you__maybe__surprisedthat__PyPDFextracts__small,blank__imagesused__asbackground__or spacers.When__workingwith__PDFs,you__lloften__requirehuman__reviewto__ensurethat__theoutput__is acceptable.Creating__PDFsfrom__OtherPages__PyPDFs__counterpartto__PdfReaderis__PdfWriter,which__cancreate__newPDF__files.But__PyPDFcannot__writearbitrary__textto__aPDF__likePython__canwith__plaintext files. Instead,PyPDF__s PDF-writingcapabilities__arelimited__tocopy__ing, merging, cropping,and__transformingpages__fromother__PDFsinto__new ones.The__codein__thisinteractive__shellexample__createsa__copyof__thesample__chapterPDF__withjust__thefirst__five pages: >>>import__pypdf 1 >>>writer__= pypdf.PdfWriter() 2 >>> writer.append('Recursion_Chapter1.pdf', (0, 5)) >>>with__open('first_five_pages.pdf', 'wb')as__file: 3 ... writer.write(file) ... (False, <_io.BufferedWriter name='first_five_pages.pdf'>) First,we__createa__PdfWriterobject__bycalling__pypdf.PdfWriter() 1.The__PdfWriterobject__inthe__writervariable__representsa__blankPDF__documentwith__zero pages. Then,the__PdfWriterobject__s append()method__copiesthe__firstfive__pagesfrom__thesample__chapter PDF,which__weidentify__bythe__'Recursion_ Chapter1.pdf'filename__2. (Despitethe__identical name,the__PdfWriterobject__s append()method__differsfrom__the append()list__method.)The__secondargument__tothis__methodis__thetuple__(0, 5),which__tellsthe__PdfWriterobject__tocopy__pagesstarting__atpage__index 0 (thefirst__pagein__thePdfWriter__object),up__tobut__notincluding__pageindex__5.PyPDF__considersindex__0to__bethe__first page,even__thoughPDF__applicationscall__itpage__1. Finally,to__writethe__contentsof__thePdfWriter__objectto__aPDF__file,call__open()with__thefilename__and 'wb' mode,and__thenpass__theFile__objectto__the write()method__ofthe__PdfWriterobject__3.This__shouldgenerate__anew__PDF file.The__tupleprovided__to append()can__containeither__twoor__three integers.If__athird__integeris__provided,the__methodskips__thatnumber__of pages. 420Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter1.pdf', [0, 1, 2, 3, 4])This__codewould__alsocopy__thefirst__fivepages__ofthe__PDFdocument__tothe__PdfWriter object.Note__that append()interprets__tuplesand__listarguments__differently;the__tuple (0, 5)tells__append()to__copypages__atindex__0up__tobut__notincluding__pageindex__5,but__thelist__[0, 5]would__tell append()to__individuallycopy__pageindex__0and__thencopy__pageindex__5.This__differencein__meaningbetween__tuplesand__listsis__unconventional,and__youwon__tsee__itin__otherPython__libraries,but__its__partof__PyPDFs__design.The__append()method__addsthe__copiedpages__tothe__endof__thePdfWriter__object.To__insertcopied__pagesbefore__the end,call__the merge()method__instead.The__merge()method__hasan__additionalinteger__argumentthat__specifies__whereto__insertthe__pages.For__example,look__atthis__code: >>> writer.merge(2, 'Recursion_Chapter1.pdf', (0, 5))This__codecopies__thepages__atindex__0up__tobut__notincluding__index 5and__insertsthem__wherepage__index 2 (thethird__page)is__inthe__PdfWriterobject__in writer.The__originalpage__atindex__2,and__allother__pages,get__shiftedback__afterthe__insertedset__of pages.Rotating__PagesWe__canalso__rotatethe__pagesof__aPDF__in 90-degreeincrements__withthe__rotate()method__ofPage__objects.Pass__either 90, 180,or__270as__anargument__tothis__methodto__rotatethe__page clockwise,and__either -90, -180,or__-270to__rotatethe__page counterclockwise.Rotating__pagesis__usefulif__youhave__manyPDFs__that are,for__whatever reason,already__incorrectlyrotated__andyou__needto__rotatethem__back,or__elseneed__torotate__onlya__fewselect__pagesin__aPDF__document.PDF__appsoften__haverotation__featuresthat__youcan__useto__manually__correct PDFs,but__Pythonallows__youto__quicklyapply__rotationsto__manyPDFs__toautomate__thisboring__task.For__example,enter__thefollowing__intothe__interactiveshell__torotate__thepages__ofthe__samplechapter__PDF: >>>import__pypdf >>>writer__= pypdf.PdfWriter()PDF__andWord__Documents 421Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter1.pdf') 1 >>>for__iin__range(len(writer.pages)): ... 2 writer.pages[i].rotate(90) ... {'/ArtBox': [21, 21, 525, 687], '/BleedBox': [12, 12, 534, 696], --snip-- >>>with__open('rotated.pdf', 'wb')as__file: ... writer.write(file) ... (False, <_io.BufferedWriter name='rotated.pdf'>)We__createa__newPdfWriter__objectand__copythe__pagesof__thesample__chapterPDF__to it. Then,we__usea__forloop__toloop__overeach__page number.The__callto__len(writer.pages)returns__thenumber__ofpages__1as__an integer.The__expression writer.pages[i]accesses__eachPage__objecton__aniteration__ofthe__for loop,and__the rotate(90)method__call 2rotates__thispage__inthe__PdfWriter object.The__resultingPDF__shouldconsist__ofall__pagesrotated__90degrees__clock wise,as__shownin__Figure 17-2.Figure__17-2:The__rotated.pdf__filewith__thepage__rotated 90degrees__clockwisePyPDF__cant__rotatedocuments__inincrements__otherthan__90 degrees. 422Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterPDF__withblank__pagesat__theend__andon__page 3: >>>import__pypdf >>>writer__= pypdf.PdfWriter() >>> writer.append('Recursion_Chapter1.pdf') 1 >>> writer.add_blank_page() {'/Type': '/Page', '/Resources': {}, '/MediaBox': [0.0, 0.0, 546, 708], '/Parent': IndirectObject(1, 0, 2629126028624)} 2 >>>writer__.insert_blank___page(index =2) {'/Type': '/Page', '/Parent': NullObject, '/Resources': {}, '/MediaBox': RectangleObject([0.0, 0.0, 546, 708])} >>>with__open('with_blanks.pdf', 'wb')as__file: ... writer.write(file) #Save__thewriter__objectto__a PDFfile. ... (False, <_io.BufferedWriter name='with_blanks.pdf'>)After__copyingall__thepages__fromthe__samplechapter__PDFto__thePdfWriter__object,the__add_blank_page()method__addsa__blankpage__tothe__endof__thedoc__ument.The__insert_blank_page()method__insertsa__blankpage__atpage__index 2 (whichis__thethird__page,as__pageindex__0is__thefirst__page).This__methodrequires__thatyou__specifythe__indexparameter__name.You__caneither__leavethese__pagesblank__oradd__contentto__them later,such__asoverlays__and watermarks,as__thenext__section explains.Adding__Watermarksand__OverlaysPyPDF__canalso__overlaythe__contentsof__onepage__ontop__of another,which__isuseful__foradding__a logo, timestamp,or__watermarkto__a page.In__PyPDF,a__stampor__overlayis__contentplaced__ontop__ofthe__pages__existing content,while__awatermark__orunderlay__iscontent__placedunderneath__thepage__sexist__ing content.Download__watermark.pdffrom__thebook__sonline__resourcesand__placethe__PDFin__thecurrent__workingdirectory__alongwith__thesample__chapter PDF. Then,enter__thefollowing__intothe__interactive shell: >>>import__pypdf >>>writer__= pypdf.PdfWriter() >>> writer.append('Recursion_Chapter1.pdf') 1 >>>watermark_page__= pypdf.PdfReader('watermark.pdf').pages[0] >>>for__pagein__writer.pages: 2 ... page.merge_page(watermark_page, over=False) ... >>>with__open('with_watermark.pdf', 'wb')as__file: ... writer.write(file) ... (False, <_io.BufferedWriter name='with_watermark.pdf'>)PDF__andWord__Documents 423Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterPDF__ina__newPdfWriter__object,saved__inthe__writer variable.We__alsoobtain__thePage__objectfor__thefirst__pageof__thewatermark__PDFand__storeit__inthe__watermark_page variable.The__forloop__thenloops__overall__thePage__objectsin__thePdfWriter__objectand__appliesthe__watermarkby__passingit__to merge_page(). (Dont__confuse__the merge_page()method__ofPage__objectswith__the merge()method__ofPdfWriter__objectsdiscussed__earlierin__this chapter.)The__merge_page()method__alsohas__anover__keyword argument.Pass__Truefor__thisargument__tocreate__astamp__or overlay,or__passFalse__tocreate__awatermark__or underlay.After__modifyingthe__PdfWriterobject__spages__inthe__loop,the__codethen__savesit__as with_watermark.pdf.Figure__17-3shows__theoriginal__watermarkPDF__andtwo__pagesfrom__thesample__chapterPDF__withthe__watermark applied.Figure__17-3:The__watermarkPDF__(left)and__pageswith__theadded__watermark (center, right)The__merge_page()method__isuseful__formaking__broadchanges__toPDF__documents,such__asmerging__thecontents__oftwo__pages.Encrypting__andDecrypting__PDFsPDFs__allowyou__toencrypt__their contents,making__them unreadable.The__encryptionis__onlyas__strongas__thepassword__you choose,so__createa__password__thatuses__differentcharacter__types,isn__ta__wordin__the dictionary,and__hasaround__14to__16 characters.Keep__inmind__thatPDFs__haveno__password__reset mechanism;if__youforget__the password,the__PDFwill__beforever__unreadableunless__youcan__guess it.The__encrypt()method__ofPdfWriter__objectsaccepts__apassword__stringand__astring__thatselects__theencryption__algorithm.The__'AES-256'argument__implements__arecommended__modernencryption__algorithm,so__well__alwaysuse__that.Enter__thefollowing__intothe__interactiveshell__tocreate__anencrypted__copyof__thesample__chapter PDF: >>>import__pypdf >>>writer__= pypdf.PdfWriter() >>> writer.append('Recursion_Chapter1.pdf') 424Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11.)Call__Pythons__sort()list__methodto__alphabetizethe__filenames.Create__aPdfWriter__objectfor__theoutput__PDF.Loop__overeach__PDF file,creating__aPdfReader__objectfor__it.From__thePdfReader__object,copy__tothe__outputPDF__allthe__pagesafter__thefirst__page.Write__theoutput__PDFto__a file.Open__anew__fileeditor__tabfor__thisproject__andsave__itas__combine_pdfs.py.Step__1:Find__AllPDF__Files First,your__programneeds__toget__alist__ofall__fileswith__the .pdfextension__inthe__currentworking__directoryand__sort them.Make__yourcode__looklike__the following: # combine_pdfs.py -Combines__allthe__PDFsin__thecurrent__workingdirectory__#into__asingle__PDF 1import__pypdf,os__#Get__allthe__PDF filenames.pdf_filenames__= []for__filenamein__os.listdir('.'): 426Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterwill__focuson__Wordfor__Windows.Also__notethat__whilethe__browser-based 428Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 17Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,I__recommendsearching__for pdfplumber, ReportLab, pdfrw, PyMuPDF, pdfkit,and__borbon__thePyPI__website. Unfortunately,reading__textfrom__PDFdocuments__mightnot__alwaysresult__ina__perfecttranslation__toa__string,because__thefile__formatis__complicated__andsome__PDFsmight__notbe__readableat__all.The__pdfminer.sixpack__ageis__afork__ofa__no-longer-maintainedpdfminer__packagethat__focuseson__extractingtext__from PDFs.This__chapterused__pdfminer.sixas__afallback__mechanismif__youre__unableto__extracttext__froma__particularPDF__file.Word__documentsare__more reliable,and__youcan__readthem__withthe__python-docxpackage__sdocx__module.You__canmanipulate__textin__Worddocu__mentsvia__Paragraphand__Run objects.These__objectscan__alsobe__given styles,though__theymust__befrom__thedefault__setof__stylesor__fromstyles__alreadyin__the document.You__canadd__new paragraphs, headings, breaks,and__picturesto__theends__of documents.Many__ofthe__limitationsthat__comewith__workingwith__PDFsand__Worddoc__umentsoccur__becausethese__formatsare__meantto__displaynicely__forhuman__readers,rather__thanbe__easyto__parseby__software.The__nextchapter__takesa__lookat__someother__commonformats__forstoring__information: CSV, JSON, XML, YAML,and__TOML files.These__formatswere__designedfor__useby__com puters,and__youll__seethat__Pythoncan__workwith__themmuch__more easily.PDF__andWord__Documents 437Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 11,write__ascript__thatwill__gothrough__everyPDF__ina__folder (andits__subfolders)and__encryptthe__PDFsusing__apassword__providedon__thecommand__line.Save__eachencrypted__PDFwith__an _encrypted.pdfsuffix__addedto__theoriginal__filename.Before__deletingthe__original file,have__theprogram__attemptto__readand__decryptthe__newfile__toensure__thatit__wasencrypted__correctly. Then,write__aprogram__thatfinds__allencrypted__PDFsin__afolder__(andits__subfolders)and__createsa__decryptedcopy__ofthe__PDFusing__aprovided__password.If__thepassword__is incorrect,the__programshould__printa__messageto__theuser__andcontinue__tothe__next PDF.Custom__InvitationsSay__youhave__atext__fileof__guest names.This__guests.txtfile__hasone__nameper__line,as__follows: Prof.Plum__MissScarlet__438Chapter__17Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10,create__alist__ofword__stringsby__readingthis__file. Then,loop__overeach__wordin__this list,passing__itto__the decrypt() method.You__shouldtry__boththe__uppercaseand__lowercaseforms__ofeach__word. (Onmy__laptop,going__throughall__88,000uppercase__andlowercase__wordsfrom__thedictionary__filetakes__acouple__of minutes.This__iswhy__youshouldn__tuse__asimple__Englishword__foryour__passwords.)Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10,it__seasier__touse__Pythons__modulesto__handle them,just__aswe__usedthe__BeautifulSoup__modulein__Chapter 13to__handle HTML-formatted text.Each__formathas__itsown__use case: Comma-separatedvalues__(CSV,pronounced__see-ess-vee )is__asimpli__fiedspreadsheet__format,and__worksbest__forstoring__avariable__numberof__rowsof__datathat__sharethe__same columns. 18 CSV,J__SON,A__NDXMLF__ILE__S 440Chapter__18Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__thebasics__ofthese__formatssyntax__andthe__Pythoncode__towork__with them.The__CSVFormat__Eachline__ina__CSVfile__(whichuses__the .csvfile__extension)represents__arow__ina__spreadsheet,and__commasseparate__thecells__inthe__row.For__example,the__spreadsheet example3.xlsxincluded__inthe__onlineresources__at https://nostarch .com /automate -boring -stuff -python -3rd -editionwould__looklike__thisin__aCSV__file: 4/5/2035 13:34,Apples,73 4/5/2035 3:41,Cherries,85 4/6/2035 12:46,Pears,14 4/8/2035 8:59,Oranges,52 4/10/2035 2:07,Apples,152 4/10/2035 18:10,Bananas,23 4/10/2035 2:40,Strawberries,98I__lluse__thisfile__inthis__chapters__CSVinteractive__shell examples.Download__itor__enterthe__textinto__atext__editorand__saveit__as example3.csv.You__canthink__ofCSV__filesas__alist__oflists__of values.Python__codecould__representthe__example3.csvcontent__asthe__value [['4/5/2035 13:34', 'Apples', '73'], ['4/5/2035 3:41', 'Cherries', '85'], ... ['4/10/2035 2:40', 'Strawberries', '98']].CSV__filesare__simple,lacking__manyof__thefeatures__ofan__Excelspread__sheet.For__example, they:Don__thave__multipledata__types;every__valueis__astring__Dont__havesettings__forfont__sizeor__colorDon__thave__multipleworksheets__Cant__specifycell__widthsor__cellheights__Cant__mergecells__Cant__haveembedded__imagesor__chartsThe__advantageof__CSVfiles__is simplicity.Many__appsand__programminglanguages__support them,you__canview__themin__texteditors__(including Mu),and__theyre__astraightforward__wayto__representspreadsheet__data.Because__CSVfiles__arejust__text files,you__mightbe__temptedto__readthem__asa__stringand__thenprocess__thatstring__usingthe__techniquesyou__learnedin__Chapter 8.For__example,because__eachcell__ina__CSVfile__isseparated__by CSV, JSON,and__XMLFiles__441Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__the row.To__getthe__row number,use__thereader__objects__line_num attribute,which__storesan__integer.If__yourCSV__filecontains__columnheaders__inthe__first row,you__coulduse__line_numto__checkwhether__youre__onrow__1and__runa__continueinstruction__toskip__the headers.Unlike__Pythonlist__indexes,line__numbersin__line_numbegin__at 1,not__0.You__canloop__overthe__readerobject__only once.To__rereadthe__CSV file,you__mustcall__open()and__csv.reader()again__tocreate__anotherreader__object.Writing__CSVFiles__A csv.writerobject__letsyou__writedata__toa__CSV file.To__createa__writer object,use__the csv.writer() function.Enter__thefollowing__intothe__interactive shell: >>>import__csv 1 >>>output_file__= open('output.csv', 'w', newline='') 2 >>>output_writer__= csv.writer(output_file) >>> output_writer.writerow(['spam', 'eggs', 'bacon', 'ham']) 21 >>> output_writer.writerow(['Hello, world!', 'eggs', 'bacon', 'ham']) 32 >>> output_writer.writerow([1, 2, 3.141592, 4]) 16 >>> output_file.close() CSV, JSON,and__XMLFiles__443Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18Automate__theBoring__Stuffwith__Python, 3rdedition__(contents:spam__eggsbacon__ham Hello, world!eggs__baconham__1 2 3.141592 4Tabs__nowseparate__thecells__inthe__spreadsheet.Handling__HeaderRows__ForCSV__filesthat__containheader__rows,it__soften__moreconvenient__towork__withthe__DictReaderand__DictWriterobjects__ratherthan__thereader__andwriter__objects.While__readerand__writerread__andwrite__toCSV__filerows__byusing__lists,DictReader__andDictWriter__performthe__samefunctions__usingdictionar__ies,treating__thevalues__inthe__firstrow__asthe__keys.Download__exampleWithHeader3.csvfrom__thebook__sonline__resourcesfor__thenext__example.This__fileis__thesame__as example3.csvexcept__itincludes__Timestamp, Fruit,and__Quantityas__columnheaders__inthe__first row.To__readthe__file,enter__thefollowing__intothe__interactive shell: >>>import__csv >>>example_file__= open('exampleWithHeader3.csv') >>>example_dict_reader__= csv.DictReader(example_file) 1 >>>example_dict_data__= list(example_dict_reader) >>>example_dict_data__[{'Timestamp': '4/5/2035 3:41', 'Fruit': 'Cherries', 'Quantity': '85'}, {'Timestamp': '4/6/2035 12:46', 'Fruit': 'Pears', 'Quantity': '14'}, {'Timestamp': '4/8/2035 8:59', 'Fruit': 'Oranges', 'Quantity': '52'}, {'Timestamp': '4/10/2035 2:07', 'Fruit': 'Apples', 'Quantity': '152'}, {'Timestamp': '4/10/2035 18:10', 'Fruit': 'Bananas', 'Quantity': '23'}, {'Timestamp': '4/10/2035 2:40', 'Fruit': 'Strawberries', 'Quantity': '98'}] >>>example_file__= open('exampleWithHeader3.csv') >>>example_dict_reader__= csv.DictReader(example_file) 2 >>>for__rowin__example_dict_reader: ... print(row['Timestamp'], row['Fruit'], row['Quantity']) ... 4/5/2035 13:34Apples__73 4/5/2035 3:41Cherries__85 4/6/2035 12:46Pears__14 4/8/2035 8:59Oranges__52 CSV, JSON,and__XMLFiles__445Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__theCSV__file,and__rewritethe__contentswithout__thefirst__rowto__afile__ofthe__same name.This__willreplace__theold__contentsof__theCSV__filewith__the new,headless__contents.WARNING__As always,whenever__youwrite__aprogram__thatmodifies__files,be__sureto__backup__thefiles__first,in__caseyour__programdoesn__twork__theway__youexpect__it to.You__dont__wantto__accidentallyerase__youroriginal__files.At__ahigh__level,the__programmust__dothe__following:Find__allthe__CSVfiles__inthe__currentworking__directory.Read__thefull__contentsof__each file.Write__the contents,skipping__thefirst__line,to__anew__CSV file.At__thecode__level,this__meansthe__programwill__needto__dothe__following:Loop__overa__listof__filesfrom__os.listdir(),skipping__the non-CSV files.Create__aCSV__readerobject__andread__thecontents__ofthe__file,using__theline_num__attributeto__figureout__whichline__to skip.Create__aCSV__writerobject__andwrite__the read-indata__tothe__new file.For__this project,open__anew__fileeditor__windowand__saveit__asremoveCsv__Header.py. CSV, JSON,and__XMLFiles__447Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercan__parse (that is,read__and understand)text__writtenin__theseformats__tocreate__Pythondata__structuresfrom__their text.These__human-readableplaintext__formatsdon__tmake__themost__efficientuse__ofdisk__spaceor__memory,but__theyhave__theadvantage__ofbeing__easyto__viewand__editin__atext__editorand__arelanguage__neutral,as__programswritten__inany__languagecan__reador__writetext__files.By__contrast,the__shelve module,covered__inChapter__10,can__storeall__Pythondata__typesin__binaryshelf__files,but__otherlanguages__dont__havemodules__toload__thisdata__intotheir__programs. 450Chapter__18Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,I__llrepresent__thefollowing__Pythondata__structure,which__storespersonal__detailsabout__someonenamed__Alice,in__eachof__these formats,so__youcan__compareand__contrast them: { "name": "Alice Doe", "age": 30, "car": None, "programmer": True, "address": { "street": "100Larkin__St.", "city": "San Francisco", "zip": "94102" }, "phone": [ { "type": "mobile", "number": "415-555-7890" }, { "type": "work", "number": "415-555-1234" } ] }These__textformats__havetheir__ownhistories__andoccupy__specificniches__inthe__computing ecosystem.If__youhave__tochoose__adata__serializationformat__forstoring__your data,keep__inmind__thatJSON__issimpler__thanXML__andmore__widelyadopted__than YAML,and__thatTOML__ischiefly__usedas__afor__matfor__configuration files. Lastly,coming__upwith__yourown__dataserializa__tionformat__mightbe__tempting,but__its__alsoreinventing__the wheel,and__youwould__haveto__writeyour__ownparser__foryour__custom format.It__sbetter__tosimply__choosean__existing format.JSON__JSONstores__informationas__JavaScriptsource__code,though__many non-JavaScript__applicationsuse__it.In__particular,websites__oftenmake__theirdata__availableto__programmersin__theJSON__formatthrough__APIslike__theOpenWeather__APIcovered__inChapter__13.We__save JSON-formattedtext__inplaintext__fileswith__the .jsonfile__extension.Here__isthe__exampledata__structure__formattedas__JSON text: { "name": "Alice Doe", "age": 30, "car": null, "programmer": true, "address": { "street": "100Larkin__St.", "city": "San Francisco", CSV, JSON,and__XMLFiles__451Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18,and__involvesnesting__openingand__closingtags__insideangle__bracketsthat__containother__content.These__tagsare__called elements.SVG__imagefiles__aremade__upof__textwritten__in XML.The__RSSand__Atomweb__feedformats__arealso__writtenin__XML,and__MicrosoftWord__documentsare__justZIP__filesthat__havethe__.docxfile__extension__andcontain__XML files.We__store XML-formattedtext__inplaintext__fileswith__the .xmlfile__exten sion.Here__sthe__exampledata__structureformatted__as XML:Alice__Doe 30true__100Larkin__St.San__Francisco 94102mobile__415-555-7890work__415-555-1234In__this example,the__elementhas__subelements , ,and__so on.The__andsubelements__arechild__elements,and__istheir__parent element.Valid__XMLdocuments__musthave__asingle__rootelement__thatcontains__allthe__other elements,such__asthe__elementin__this 454Chapter__18Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13can__findelements__ina__webpage__s HTML,a__languagecalled__XPathcan__locateelements__inan__XML document.These__conceptsare__beyondthe__scopeof__this chapter,but__youcan__learnabout__themin__thePython__documentationat__https://docs .python .org /3 /library /xml__.etree .elementtree .html.Python__sXML__moduleshave__noway__toconvert__XMLtext__toa__Pythondata__structure. However,the__third-partyxmltodict__moduleat__https://pypi .org /project /xmltodict /can__do this.The__fullinstallation__instructionsare__inAppendix__A.Here__isan__exampleof__its use: >>>import__xmltodict >>>xml_string__= """Alice Doe30true__100Larkin__St.San Francisco94102mobile__415-555-7890work 415-555-1234""" >>>python_data__= xmltodict.parse(xml_string) >>>python_data__{'person': {'name': 'Alice Doe', 'age': '30', 'programmer': 'true', 'car': {'@xsi:nil': 'true', '@xmlns:xsi': 'http://www .w3 .org /2001/ 458Chapter__18Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercan__helpyou__writePython__programsthat__canalso__interactwith__anyapps__thatuse__them.Practice__Questions 1.What__aresome__featuresthat__Excelspreadsheets__havebut__CSVspread__sheetsdon__t? 2.What__doyou__passto__csv.reader()and__csv.writer()to__createreader__andwriter__objects? 3.What__modesdo__Fileobjects__forreader__andwriter__objectsneed__tobe__opened in? 4.What__methodtakes__alist__argumentand__writesit__toa__CSV file? 5.What__dothe__delimiterand__lineterminatorkeyword__arguments do? 6.Of__CSV, JSON,and__XML,which__formatscan__beeasily__editedwith__atext__editor application? 7.What__functiontakes__astring__ofJSON__dataand__returnsa__Pythondata__structure? 8.What__functiontakes__aPython__datastructure__andreturns__astring__ofJSON__data? 9.Which__dataserialization__formatresembles__HTML,with__tagsenclosed__inangle__brackets? 10.How__doesJSON__writeNone__values? 11.How__doyou__writeBoolean__valuesin__JSON?Practice__Program: Excel-to-CSVConverter__Excelcan__savea__spreadsheetto__aCSV__filewith__afew__mouse clicks,but__ifyou__hadto__converthundreds__ofExcel__filesto__CSVs,it__wouldtake__hoursof__clicking.Using__theopenpyxl__modulefrom__Chapter 14,write__aprogram__thatreads__allthe__Excelfiles__inthe__currentworking__directoryand__outputsthem__asCSV__files. 460Chapter__18Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13of__myother__book,Beyond__theBasic__Stuffwith__Python (Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13.)Intermittently__checkhow__longa__programhas__beenrunning__andoffer__theuser__achance__tocancel__tasksthat__aretaking__too long.The__datetimeModule__Thetime__moduleis__usefulfor__gettinga__Unixepoch__timestampto__work with.But__ifyou__wantto__displaya__datein__amore__convenient format,or__doarith__meticwith__dates (for example,figuring__outwhat__datewas__205days__agoor__whatdate__is 123days__from now),you__shoulduse__thedatetime__module.The__datetimemodule__hasits__owndatetime__data type.The__datetimevalues__representa__specificmoment__in time.Enter__thefollowing__intothe__interactive__shell: >>>import__datetime 1 >>> datetime.datetime.now()Keeping__Time,Scheduling__Tasks,and__LaunchingPrograms__467Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Contentsto__findthe__pathto__theexecutable__file.)The__run()function__willblock__untilthe__launchedprogram__closes.Pass__theprogram__tolaunch__asa__stringof__theexecutable__programs__filepathinside__a list,keeping__inmind__thatthe__launchedprogram__willbe__runin__aseparate__process,not__inthe__sameprocess__asyour__Python program.On__aWindows__computer,enter__thefollowing__intothe__interactive shell: >>>import__subprocess >>> subprocess.run(['C:\\Windows\\System32\\calc.exe']) CompletedProcess(args=['C:\\Windows\\System32\\calc.exe'], returncode=0)On__Ubuntu Linux,enter__the following: >>>import__subprocess >>> subprocess.run(['/usr/bin/gnome-calculator']) CompletedProcess(args=['/usr/bin/gnome-calculator'], returncode=0)On__macOS,enter__the following: >>>import__subprocess >>> subprocess.run(['open', '/System/Applications/Calculator.app']) CompletedProcess(args=['open', '/System/Applications/Calculator.app'], returncode=0)Notice__thatmacOS__requiresyou__torun__theopen__programand__passit__acommand__lineargument__ofthe__programyou__wantto__launch. 474Chapter__19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12covers__theplaysound__moduleto__playsound__filesof__various formats,the__quickand__easyway__todo__thisis__tolaunch__whateverapplication__theuser__alreadyuses__toplay__sound files.The__operatingsystem__willfigure__outfrom__the .wavfile__extensionwhich__applicationit__shouldlaunch__toplay__the file.This__.wavfile__couldeasily__besome__othersound__file format,such__as .mp3or__.ogg.You__canuse__anysound__fileon__yourcomputer__toplay__atthe__endof__the countdown,or__download alarm.wavfrom__https://autbor .com /alarm .wav.Add__thefollowing__toyour__code: # https://autbor .com /simplecountdown .py -A__simplecountdown__script --snip-- #At__theend__ofthe__countdown,play__asound__file. #subprocess.run(['start', 'alarm.wav'], shell=True) #Windows__#subprocess.run(['open', 'alarm.wav']) #macOS__andLinux__Afterthe__whileloop__finishes, alarm.wav (orthe__soundfile__you choose)will__playto__notifythe__userthat__thecountdown__is over.Uncomment__the subprocess.run()call__foryour__operating system.On__Windows,be__sureto__include 'start'in__thelist__youpass__to run().On__macOSand__Linux,pass__'open'instead__of 'start'and__remove shell=True.Instead__ofplaying__asound__file,you__couldsave__atext__filesomewhere__witha__messagelike__Break time!and__use subprocess.run()to__openit__atthe__endof__the countdown.This__willeffectively__createa__pop-upwindow__witha__message.Or__youcould__usethe__webbrowser.open()function__toopen__aspecific__websiteat__theend__ofthe__countdown.Unlike__somefree__countdownapplication__youd__find online,your__owncountdown__programs__alarmcan__beanything__you want!Ideas__forSimilar__ProgramsA__countdownessentially__producesa__simpledelay__beforecontinuing__thepro__grams__execution.You__coulduse__thesame__approachfor__otherapplications__and features,such__asthe__following:Use__time.sleep()to__givethe__usera__chanceto__press ctrl-Cto__cancelan__action,such__asdeleting__files.Your__programcan__printa__Press ctrl-Cto__cancelmessage__andthen__handleany__KeyboardInterruptexceptions__withtry__andexcept__statements.For__a long-term countdown,you__canuse__timedeltaobjects__tomeasure__thenumber__of days, hours, minutes,and__secondsuntil__somepoint__(a birthday?an__anniversary?)in__the future.Summary__TheUnix__epoch (January 1, 1970,at__midnight, UTC)is__astandard__reference__timefor__manyprogramming__languages,including__Python.While__theKeeping__Time,Scheduling__Tasks,and__LaunchingPrograms__479Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterso__thatit__usesthe__rjust()and__ljust()string__methodsto__prettifythe__output. (Thesemethods__werecovered__inChapter__8.)Instead__ofoutput__suchas__this . . .Lap__#1: 3.56 (3.56)Lap__#2: 8.63 (5.07)Lap__#3: 17.68 (9.05)Lap__#4: 19.11 (1.43) . . .the__outputshould__looklike__this:Lap__# 1: 3.56 ( 3.56)Lap__# 2: 8.63 ( 5.07) 480Chapter__19Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 8to__copythe__textoutput__tothe__clipboardso__thatthe__usercan__quicklypaste__theoutput__toa__textfile__or email.Friday__the 13thFinder__Fridaythe__13this__consideredan__unluckyday__bythose__withtriskaideka__phobia (thoughpersonally__Icelebrate__itas__alucky__day).With__leapyears__andmonths__ofvarying__lengths,it__canbe__hardto__figureout__whenthe__nextFriday__the 13this__coming.Write__two programs.The__firstprogram__shouldcreate__adatetime__objectfor__thecurrent__dayand__atimedelta__objectof__one day.If__thecurrent__dayis__aFriday__the 13th,it__shouldprint__themonth__and year. Then,it__shouldadd__thetimedelta__objectto__thedatetime__objectto__setit__tothe__next day,and__repeatthe__check.Have__itrepeat__untilit__hasfound__thenext__tenFriday__the 13th dates.The__secondprogram__shoulddo__thesame__thingexcept__subtractthe__timedelta object.This__programwill__findall__ofthe__pastmonths__andyears__witha__Fridaythe__13th,and__stopwhen__itreaches__theyear__1.Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 20Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterfeatures__theEZGmail__module,a__simpleway__tosend__andread__emailsfrom__Gmail accounts,as__wellas__thefree__ntfyservice__thatpro__videspush__notificationsbetween__devices.WARNING__Ihighly__recommendthat__youset__upa__separateemail__accountfor__anyscripts__thatsend__orreceive__emails.This__willprevent__bugsin__yourprograms__fromaffecting__yourper__sonalemail__account (bydeleting__emailsor__accidentallyspamming__your contacts,for__example).It__sa__goodidea__tofirst__doa__dryrun__bycommenting__outthe__codethat__actually__sendsor__deletesemails__andreplacing__itwith__atemporary__print() call.This__way,you__cantest__yourprogram__beforerunning__itfor__real.The__GmailAPI__Gmailowns__closeto__one-thirdof__theemail__clientmarket__share,and__mostlikely__youhave__atleast__oneGmail__email address.Because__ofGmail__saddi__tionalsecurity__and anti-spam measures,controlling__aGmail__accountis__betterdone__throughthe__EZGmailmodule__thanthrough__thesmtplib__andimaplib__modulesin__Pythons__standard library.I__wroteEZGmail__towork__ontop__ofthe__officialGmail__APIand__providefunctions__thatmake__iteasy__touse__Gmailfrom__Python.For__fullinstructions__oninstalling__EZGmail,see__Appendix A.Enabling__theAPI__Beforeyou__write code,you__mustfirst__signup__fora__Gmailemail__accountat__https://gmail .com. Then,you__mustset__upthe__GmailAPI__foryour__accountthrough__theGoogle__Cloudconsole__at https://console .cloud .google .com.These__stepsare__identicalto__thesteps__forsetting__upEZSheets__detailedin__Chapter 15,so__Iwon__trepeat__themin__this chapter.Create__anew__projectand__makesure__toenable__theGmail__APIinstead__ofthe__GoogleSheets__API.On__step 2of__theOAuth__consentscreen__configuration,add__the https://mail .google .comscope__tolet__yourPython__scriptsread__andsend__email.When__youre__done,you__shouldhave__acredentials__fileand__atoken__file. Then,in__theinteractive__shell,enter__thefollowing__code: >>>import__ezgmail >>>ezgmail__.init()If__noerror__appears,EZGmail__hasbeen__correctly installed.Sending__MailOnce__EZGmailis__configured,you__shouldbe__ableto__sendemail__witha__singlefunction__call: >>>import__ezgmail >>>ezgmail__.send('recipient@example .com', 'Subject line', 'Bodyof__the email')Sending__Email, Texts,and__PushNotifications__483Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 20Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 20Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13covers__theuse__ofthe__Requestslibrary__tomake__HTTP requests,and__well__useit__hereto__interactwith__thefree__onlineservice__ntfy (pronouncednotify__andalways__writtenin__lowercase)at__https://ntfy .sh.The__ntfyservice__isfree__anddoesn__trequire__any sign-upor__registration.Before__weget__started,install__thentfy__appon__yourmobile__phoneso__thatyou__canreceive__notifications.This__appis__freeand__canbe__foundin__theapp__storesfor__Androidand__iPhone.You__canalso__receivenotifications__inyour__webbrowser__bygoing__to https://ntfy .sh /app.These__appscheck__withthe__ntfyservice__forany__messagessent__toa__topic.You__canthink__ofa__topicas__achat__roomor__groupchat__name.Anyone__inthe__worldcan__sendmessages__toa__topic,and__anyonein__theworld__cansub__scribeto__atopic__toread__these messages.If__youwant__tosend__messagesto__just yourself,use__asecret__topicwith__random letters.Treat__thistopic__nameas__apassword__andshare__itonly__withthose__youintend__toread__the messages.This__chapterwill__usethe__topic AlSweigartZPgxBQ42in__theexample__code,though__Irecommend__youuse__yourown__secrettopic__thatcontains__asuffix__ofrandom__lettersand__numbers.Topics__are case-sensitive,and__evenif__youkeep__thetopic__a secret,do__notuse__ntfyto__sendsensitive__informationsuch__aspass__wordsor__creditcard__numbers.Sending__NotificationsSending__apush__notificationto__everyonewho__issubscribed__toa__topicrequires__nothingmore__thanmaking__anHTTP__requestto__thentfy__web server.This__488Chapter__20Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterwith__yourown__random,secret__topic: >>>import__requests >>>requests__.post('https://ntfy .sh /AlSweigartZPgxBQ42', 'Hello, world!')Note__thatwe__call requests.post()to__makea__POSTHTTP__requestto__senda__notification.This__isdifferent__fromthe__requests.get()function__coveredin__Chapter 13to__downloadweb__pages.Anyone__subscribedto__thetopic__AlSweigartZPgxBQ42will__receivethe__message__Hello, world!within__afew__seconds (thoughsometimes__messagesmay__bedelayed__bya__few minutes).You__canalso__viewthese__yourselfat__https://ntfy .sh /AlSweigartZPgxBQ42.The__ntfyservice__hassome__limitations.Free__usersare__limitedto__250messages__per day,and__messagescan__be 4,096bytes__insize__at most.Flooding__messagesto__varioustopics__mayresult__inyour__IPaddress__becomingtempo__rarily blocked.You__canobtain__apaid__accountto__increasethese__limitson__thentfy__website.Paid__ntfyaccounts__canset__reservedtopics__andlimit__whoposts__to them.If__youdon__thave__permissionto__postto__areserved__topic,you__llget__aresponse__toyour__requests.post()function__call.Within__the 4,096-byte limit,your__messagescan__takeon__any format.Note__thatthere__isno__wayto__determinewho__posteda__messageto__a topic,so__youmay__wantto__includeTo__andFrom__labelswithin__thetext__ofyour__mes sage.Better__yet,you__coulddo__sousing__JSONor__someother__dataserializa__tionformat__coveredin__Chapter 18.If__youwant__yourPython__programsto__sendyou__a notification,these__arethe__onlytwo__linesof__codeyou__needonce__youhave__thentfy__appinstalled__onyour__phoneand__havesubscribed__tothe__topic.You__refree__torun__yourPython__programand__stepaway__for coffee,knowing__thatyou__llreceive__anoti__ficationon__yourphone__whenyour__programhas__finishedits__boring task.Transmitting__MetadataWhile__themessage__yousend__isa__freeformtext__string value,ntfy__canoption__allyattach__metadata values,such__asa__title,a__priority level,and__tags,to__each message.A__titleis__similarto__anemail__subject line,and__mostapps__displayit__abovethe__messagetext__ina__larger font.A__prioritylevel__rangesfrom__1 (thelow__est priority)to__5 (the highest),with__3being__the default.A__higherpriority__doesnt__delivermessages__any faster;it__justallows__subscribersto__configuretheir__notificationapps__todisplay__onlymessages__ofa__certainpriority__or higher.Tags__arekeywords__thatsubscribers__canuse__tofilter__messages.Tags__canalso__bethe__nameof__anemoji__todisplay__nextto__themessage__title.You__canfind__alist__ofthese__emojisat__https://docs .ntfy .sh /publish /#tags -emojis.Sending__Email, Texts,and__PushNotifications__489Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19covers__time-related functions. since=wZ22cjyKXw1FRetrieves__allmessages__afterthe__messagethat__hadthe__IDof__'wZ22cjyKXw1F'. 490Chapter__20Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18).Continue__theprevious__interactiveshell__example: >>>import__json >>>notifications__= [] >>>for__json_textin__resp.text.splitlines(): ... notifications.append(json.loads(json_text)) ... >>> notifications[0]['message'] 'Hello, world!' >>> notifications[1]['message'] 'Therent__istoo__high!'The__json.loads()function__convertsthe__JSONtext__fromntfy__intoa__Python dictionary.Let__slook__ateach__ofthe__keyvalue__pairs: "id":"wZ22cjyKXw1F"The__'id'key__svalue__isa__uniqueidentification__stringthat__canhelp__differentiatemultiple__notificationseven__ifthey__havethe__same text. "time":1797823712The__'time'key__svalue__isa__Unixepoch__timestampof__whenthe__notificationwas__created.Calling__str(datetime.datetime .fromtimestamp(1797823712))returns__the human-readablestring__'2026 -12-20 21:28:32'. "expires":1797866912The__'expires'key__svalue__isa__Unixepoch__timestamp__ofwhen__thenotification__willbe__deletedfrom__thentfy__server. "event":"message"The__'event'key__svalue__canbe__either 'message', 'open', 'keepalive',or__'poll_request'.These__eventtypes__areexplained__inthe__online documentation,but__for now,you__reprobably__onlyinterested__in 'message' events. "topic":"AlSweigartZPgxBQ42"The__topicpart__ofthe__URLis__repeatedin__the 'topic'key__s value. "title":"Important:Read__this!"If__thenotification__hasa__title,there__willbe__a 'title'key__withit__asa__string value. "message":"Therent__istoo__high!"The__'message'key__svalue__isa__stringof__thenotification__s text. "priority":5If__thenotification__hasa__priority,there__willbe__a 'priority'key__withan__integervalue__from 1to__5.Sending__Email, Texts,and__PushNotifications__491Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 20Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13showed__youhow__touse__therequests__moduleto__scrapedata__from https://weather .gov.Write__aprogram__thatruns__justbefore__youwake__upin__themorning__andchecks__whetherrain__isin__theforecast__forthat__day.If__so,have__theprogram__textyou__areminder__topack__anumbrella__beforeleaving__the house.Auto__UnsubscriberWrite__aprogram__thatscans__youremail__account,finds__allthe__unsubscribelinks__inall__your emails,and__automaticallyopens__themin__a browser.This__programwill__haveto__login__toyour__Gmail account.You__canuse__BeautifulSoup__(coveredin__Chapter 13)to__checkfor__anyinstance__wherethe__wordunsubscribe__occurswithin__anHTML__link tag.Once__youhave__alist__ofthese__URLs,you__canuse__webbrowser.open()to__automaticallyopen__allof__theselinks__ina__browser.You__llstill__haveto__manuallygo__throughand__completeany__additionalsteps__tounsubscribe__yourselffrom__these lists.In__most cases,this__involvesclicking__alink__to confirm.But__thisscript__savesyou__fromhaving__togo__throughall__ofyour__emailslooking__forunsubscribe__links. Email-BasedComputer__ControlWrite__aprogram__thatchecks__anemail__orntfy__accountevery__15minutes__forany__instructionsyou__sendit__andexecutes__thoseinstructions__automatically.For__example,BitTorrent__isa__peer-to-peerdownloading__system.Using__freeBitTorrent__softwaresuch__as qBittorrent,you__candownload__largemedia__fileson__yourhome__computer.If__yousend__theprogram__a (completely legal,not__atall__piratical)BitTorrent__link,the__programwill__eventuallycheck__itsemail__orlook__forntfy__notifications,find__this message,extract__the link,and__thenlaunch__qBittorrentto__startdownloading__the file.This__way,you__canhave__yourhome__computerbegin__downloadswhile__youre__away,and__finishthe__(completely__legal,not__atall__piratical)download__bythe__timeyou__return home.Chapter__19covered__howto__launchprograms__onyour__computerusing__the subprocess.Popen() function.For__example,the__followingcall__wouldlaunch__theqBittorrent__program,along__witha__torrent file:qbProcess__= subprocess.Popen(['C:\\ProgramFiles__(x86)\\qBittorrent\\ qbittorrent.exe', 'shakespeare_complete_works.torrent'])Of__course,you__llwant__theprogram__tomake__surethe__emailscome__from you.In__particular,you__mightwant__torequire__thatthe__emailscontain__apass__word,since__itis__fairlytrivial__forhackers__tofake__afrom__addressin__emails.The__programshould__deletethe__emailsit__findsso__thatit__doesnt__repeatinstructions__everytime__itchecks__theemail__account.As__anextra__feature,Sending__Email, Texts,and__PushNotifications__493Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 5)to__writea__textfile__logthat__youcan__checkif__errorscome__up.The__qBittorrentprogram__(aswell__asother__BitTorrent applications)has__afeature__thatenables__itto__quitautomatically__afterthe__download completes.Chapter__19explained__howyou__candetermine__whena__launchedapplication__hasquit__withthe__wait()method__forPopen__objects.The__wait()method__callwill__blockuntil__qBittorrenthas__stopped,and__thenyour__programcan__emailor__textyou__anotification__thatthe__downloadhas__completed.There__areplenty__ofpossible__featuresyou__couldadd__tothis__project.If__youget__stuck,you__candownload__anexample__implementationof__thispro__gramfrom__https://nostarch .com/automate-boring-stuff-python-3rd-edition.Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__theuse__ofPillow__toenable__Pythonto__automaticallyedit__hundredsor__thousandsof__imageswith__ease.This__chapteralso__covers Matplotlib,a__popularlibrary__formaking__professional-looking graphs.Matplotlib__isrich__infeatures__andcustomizable__options,and__thereare__manybooks__entirelydedicated__to it. Here,we__llcover__thebasics__ofgenerating__graphimages__with Matplotlib. 21MAK__INGGRA__PHSAND__MANIP__UL__ATING__IMAG__ES__496Chapter__21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,I__llassume__youve__importedPillow__sImage__moduleand__storedthe__Zophieimage__ina__variablenamed__cat_im.Be__surethat__the zophie.pngfile__isin__thecurrent__workingdirectory__sothat__the Image.open()function__canfind__it. Otherwise,you__llhave__tospecify__thefull__absolutepath__inthe__functions__string argument.Working__withthe__ImageData__TypeAn__Imageobject__hasseveral__usefulattributes__thatgive__youbasic__informationabout__theimage__filefrom__whichit__was loaded:its__widthand__height,the__500Chapter__21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__theclipboard__asan__Image object.With__zophie.pngin__thecurrent__working directory,enter__thefollowing__intothe__interactive shell: >>>from__PILimport__Image >>>im__= Image.open('zophie.png') >>>import__pyperclipimg >>>pyperclipimg__.copy(im) >>> #Paste__theclipboard__contentsto__agraphics__program. >>> #Now__copya__newimage__tothe__clipboard. >>>pasted_im__= pyperclipimg.paste() >>> pasted_im.show() #Shows__theimage__fromthe__clipboard.In__this code,we__firstopen__the zophie.pngimage__asan__Image object,then__passit__topyperclipimg__.copy()to__copyit__tothe__clipboard.You__canverify__thatthe__copyworked__bypasting__theimage__intoa__graphics program. Next,copy__anew__imagefrom__agraphics__programor__by right-clickingan__imagein__yourweb__browserand__copying it.Calling__pyperclipimg.paste()returns__thisimage__asan__Imageobject__inthe__pasted_im variable.You__canverify__thatthe__pasteworked__byviewing__itwith__pasted_im.show().The__pyperclipimgmodule__canbe__usefulas__away__tolet__usersinput__andoutput__imagedata__toyour__Python programs.Creating__Graphswith__MatplotlibDrawing__yourown__graphsusing__Pillowis__possiblebut__wouldrequire__alot__of work.The__Matplotliblibrary__createsa__widevariety__ofgraphs__foruse__inprofessional__publications.In__this chapter,we__llcreate__basicline__graphs,bar__graphs,scatter__plots,and__pie charts,but__Matplotlibis__ableto__createmore__complex 3Dgraphs__as well.You__canfind__thefull__documentationat__https://matplotlib__.org.Install__Matplotlibby__followingthe__instructionsin__Appendix A.Line__Graphsand__ScatterPlots__Lets__startby__creatinga__2Dline__graphwith__two axes,x__and y.A__linegraph__isideal__forshowing__changesin__onemeasure__over time.In__Matplotlib,the__520Chapter__21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(chapters,you__wrotePython__programsto__dealwith__plaintext files, spreadsheets, PDFs,and__other formats.With__Pillow,you__veextended__yourprogramming__powersto__processingimages__as well!Practice__Questions 1.What__isan__RGBA value? 2.How__canyou__getthe__RGBAvalue__of 'CornflowerBlue'from__thePillow__module? 3.What__isa__box tuple? 4.What__functionreturns__anImage__object for, say,an__imagefile__named zophie.png? 5.How__canyou__findout__thewidth__andheight__ofan__Imageobject__s image? 6.What__methodwould__youcall__toget__theImage__objectfor__the lower-leftquarter__ofa__100 100 image? 7.After__makingchanges__toan__Image object,how__couldyou__saveit__asan__image file? 8.What__modulecontains__Pillows__shape-drawing code? 9.Image__objectsdo__nothave__drawing methods.What__kindof__object does?How__doyou__getthis__kindof__object? 10.Which__Matplotlibfunctions__createa__line graph,scatter__plot,bar__graph,and__pie chart? 11.How__canyou__savea__Matplotlibgraph__asan__image? 12.What__doesthe__plt.show()function__do,and__whycan__tyou__callit__twicein__a row?Practice__ProgramsFor__practice,write__programsto__dothe__following tasks.Tile__MakerWrite__aprogram__thatproduces__atiled__imagefrom__asingle__image,much__liketiles__ofcat__facesin__Figure 21-6.Your__programshould__havea__make_tile()function__withthree__arguments:a__stringof__theimage__filename,an__integerfor__howmany__timesit__shouldbe__tiled horizontally,and__aninteger__forhow__manytimes__itshould__betiled__vertically.The__make_tile()function__shouldreturn__alarger__Imageobject__ofthe__tiled image.You__willuse__the paste()meth__odsas__partof__this function.For__example,if__zophie_the_cat.jpgwas__a 20 50-pixel image,calling__make _tile('zophie_the_cat.jpg', 6, 10)should__returna__120 500image__withMaking__Graphsand__ManipulatingImages__527Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 17,you__createdcustom__invitationsfrom__alist__ofguests__ina__plaintext file.As__anadditional__project,use__Pillowto__createimages__thatwill__serveas__customseating__cardsfor__your guests.For__eachof__theguests__listedin__the guests.txtfile__fromthe__books__online resources,gen__eratean__imagefile__withthe__guests__nameand__someflowery__decoration.A__publicdomain__flowerimage__isalso__availablein__thebook__s resources.To__ensurethat__eachseating__cardis__thesame__size,add__ablack__rectangleto__theedges__ofthe__invitation image;that__way,when__youprint__the image,you__llhave__aguideline__for cutting.The__PNGfiles__thatPillow__producesare__setto__72pixels__per inch,so__a 4 5-inchcard__wouldrequire__a 288 360pixel__image.Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__PyTesseract,the__Pythonpackage__thatworks__withthe__opensource__TesseractOCR__engine.We__llalso__lookat__thefree__NAPS2 application,which__Pythoncan__runto__applyTesseract__OCRto__PDF files. 22R__ECOGNIZ__INGTEXT__INIM__AGE__S 530Chapter__22Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12covered__howto__modifythe__PATHenvironment__variable.macOS__TheHomebrew__packagemanager__caninstall__Tesseracton__macOS.Navigate__to https://docs .brew .shto__install Homebrew.Install__Tesseractby__openinga__terminalwindow__andrunning__brewinstall__tesseract,then__runbrew__install tesseract-langto__install non-Englishlanguage__packs.Linux__Toinstall__Tesseracton__Linux,open__aterminal__windowand__runsudo__aptinstall__tesseract-ocr.You__llhave__toenter__theadministrator__passwordto__runthis__command.To__installthe__languagepacks__forevery__language,run__sudo apt-getinstall__tesseract-ocr-allfrom__the terminal.To__installjust__thelanguage__packsyou__want,replace__allwith__a three-characterISO__639language__code,such__asfra__for French,deu__for German,or__jpnfor__Japanese.PyTesseract__Afterinstalling__theTesseract__OCR engine,you__caninstall__thelatest__versionof__PyTesseractby__followingthe__instructionsin__Appendix A.PyTesseract__alsoinstalls__thePillow__image library.Recognizing__Textin__Images 531Automate__theBoring__Stuffwith__Python, 3rdedition__(introductionof__mybook__TheBig__Bookof__SmallPython__Projects (Chapter 22Automate__theBoring__Stuffwith__Python, 3rdedition__(CHAPTER V.Iv__wason__adreary__nightof__November,that__Ibeheld__theaccomplishment__ofmy__toils.With__ananxiety__thatalmost__amountedto__agony,I__collectedthe__instrumentsof__lifearound__me,that__Imight__infusea__sparkof__beinginto__thelifeless__thingthat__layat__my feet.It__wasalready__onein__themorning__;the__rainpattered__dismallyagainst__the panes,and__mycandle__wasnearly__burnt out, when,by__theglimmer__ofthe__half-extinguished light,I__sawthe__dullyellow__eyeof__thecreature__open ;it__breathed hard,and__aconvulsive__Motionagitated__its limbs.It__doesa__prettygood__job,but__producesthe__incorrectlyscanned__characters__'Iv'instead__of 'IT'at__thebeginning__ofthe__paragraphand__'Motion'instead__of 'motion'on__thelast__line. (Theexact__resultsmay__varyas__thelan__guagepacks__are updated.)To__fixthese__issues,try__feedingan__LLMthe__followingsample__promptand__thetext__outputof__thescanned__Frankenstein text:The__followingis__thetext__outputfrom__anOCR__scan.Correct__any spacing,missing__characters,or__inaccuratelyrecognized__charactersfrom__it.Do__notcorrect__spellingor__grammarmistakes__thatexist__inthe__original text.Put__paragraphson__asingle__lineand__undothe__hyphenatedwords__that 534Chapter__22Automate__theBoring__Stuffwith__Python, 3rdedition__(CHAPTER V.Iv__wason__adreary__nightof__November,that__Ibeheld__the . . .When__fedthis__prompt,the__LLMproduced__this output:THE__MODERN PROMETHEUS. 43CHAPTER__V.It__wason__adreary__nightof__Novemberthat__Ibeheld__theaccomplishment__ofmy__toils.With__ananxiety__thatalmost__amountedto__agony,I__collectedthe__instrumentsof__lifearound__me,that__Imight__infusea__sparkof__beinginto__thelifeless__thingthat__layat__my feet.It__wasalready__onein__the morning;the__rainpattered__dismallyagainst__the panes,and__mycandle__wasnearly__burnt out, when,by__theglimmer__ofthe__half-extinguished light,I__sawthe__dullyellow__eyeof__thecreature__open;it__breathed hard,and__aconvulsive__motionagitated__its limbs.The__LLMcorrected__'Iv'to__'It'and__'Motion'to__'motion'.It__alsoremoved__thehyphenated__wordsat__theend__ofeach__lineso__thatthe__newlinescould__be removed.This__makesit__easier to, say,copy__andpaste__thetext__intoa__Worddocument__or email.To__automatethis__process,most__onlineLLMs__haveAPIs__sothat__yourprograms__candirectly__sendprompts__andreceive__responses.Unless__yourun__anLLM__onyour__localmachine__(whichis__beyondthe__scopeof__this book),you__llhave__toregister__forthese__onlineLLM__services.This__maybe__freeor__requirea__subscription fee.Always__rememberthat__LLMsare__proneto__overconfidence.You__shouldalways__verifytheir__output.The__textthey__returnmay__havemissed__somemis__takes,fixed__thewrong__kindsof__mistakes,or__evenintroduced__newmistakes__oftheir__own.You__llstill__needa__humanto__reviewthe__machine output. (Andyou__maywant__asecond__humanto__reviewthe__firsthuman__s work,as__humansoften__makemistakes__to.)Recognizing__Textin__Non-EnglishLanguages__Tesseractassumes__thetext__itis__scanningis__Englishby__default,but__youcan__specifyother__languagesas__well.Installing__Tesseractand__PyTesseracton__pageXX__hasinstructions__forinstalling__non-Englishlanguage__packs.You__cansee__thelanguage__packsyou__haveinstalled__byentering__thefollowing__intothe__interactive shell: >>>import__pytesseractas__tess >>> tess.get_languages() ['afr', 'amh', 'ara', 'asm', 'aze', 'aze_cyrl', 'bel', 'ben', 'bod', 'bos', --snip-- 'ton', 'tur', 'uig', 'ukr', 'urd', 'uzb', 'uzb_cyrl', 'vie', 'yid', 'yor']Recognizing__Textin__Images 535Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 22Automate__theBoring__Stuffwith__Python, 3rdedition__(Contents/MacOS/NAPS2', 'console'].On__Linux,use__thefollowing__instead: naps2_path = ['flatpak', 'run', 'com.naps2.Naps2', 'console'].The__codecreates__anew__filenamed__output.pdfthat__containsa__singlepage__withthe__scannedimage__from frankenstein.png. However,if__youopen__thisfile__ina__PDF application,you__llnotice__thatyou__canhighlight__thetext__andcopy__itto__the clipboard.Many__PDFapplications__willalso__letyou__savethe__PDFas__a .txttext__fileof__theOCR__text.Recognizing__Textin__Images 537Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 19covered__thesubprocess__modulein__more detail.Specifying__Input NAPS2lets__youimport__PDFsand__mostimage__formatsto__createa__finalcombined__PDF.The__applicationhas__itsown__minilanguage__forspecifying__multipleinputs__asa__singlecommand__lineargument__following -i.This__canbecome__quite complicated,but__youcan__thinkof__itas__semicolon delimited,with__Pythonindex__andslice__notation.To__specifymultiple__files,separate__themwith__a semicolon.For__example,passing__'-i', 'cat.png;dog.png;moose.png'creates__aPDF__with cat.pngused__forthe__first page, dog.pngused__forthe__second page,and__moose.pngused__forthe__third page.You__canalso__specifyindividual__pagesin__aPDF__withsyntax__thatis__identical__toPython__slist__slice syntax.Follow__thePDF__filenamewith__squarebrack__etscontaining__thepage__numberto__use.As__in Python, 0represents__thefirst__page.For__example,passing__'-i', 'spam.pdf[0];spam.pdf[5];eggs.pdf'creates__aPDF__withpage__1of__spam.pdf,followed__bypage__6of__spam.pdf,and__thenall__pagesof__eggs.pdf. 538Chapter__22Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,you__learnedhow__toharness__thepower__ofTesseract__toextract__textfrom__images.This__isquite__apowerful__abilitythat__cansave__youhours__ofdata__entry. However,OCR__isnt__magic,and__yourimages__mayneed__preprocessingto__getaccurate__results.Tesseract__isalso__designedto__workwith__typewrittendark__texton__lightbackgrounds__wherethe__textis__level,and__youmust__knowthe__languageof__theimage__stext__toget__good results.Large__languagemodel__AIcan__helpfix__incorrectlyrecognized__characters,but__itsoutput__requireshuman__oversightas__well. Finally,the__opensource__NAPS2application__providesa__wayto__takeseveral__imagesand__combinethem__intoa__singlePDF__withembedded__OCR text.OCR__isan__incrediblebreakthrough__ofcomputer__science,but__youdon__tneed__anadvanced__degreeto__use it.Python__makesOCR__accessibleto__everyone.Practice__Questions 1.What__languagedoes__Tesseractrecognize__by default? 2.Name__aPython__imagelibrary__thatPyTesseract__works with. 3.What__PyTesseractfunction__acceptsan__imageobject__andreturns__astring__ofthe__textin__the image? 4.If__youtake__aphoto__ofa__street sign,will__Tesseractbe__ableto__identifythe__signtext__inthe__photo? 5.What__functionreturns__thelist__oflanguage__packsinstalled__for Tesseract? 6.What__keywordargument__doyou__specifyto__PyTesseractif__animage__contains__bothEnglish__andJapanese__text? 7.What__applicationlets__youcreate__PDFswith__embeddedOCR__text?Practice__Program:Browser__TextScraper__Somewebsites__allowyou__toview__theirtext__contentsbut__makeit__difficultto__saveor__evencopy__andpaste__thetext__toyour__computer.You__maysee__themas__PDFsembedded__withinthe__web page.An__exampleof__thisis__at https://autbor .com /embeddedfrankenstein /,shown__inFigure__22-2.Recognizing__Textin__Images 539Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23can__takescreenshots__andsave__themto__an image,while__thePillow__librarycovered__inChapter__21can__crop images.PyAutoGUI__alsohas__aMouseInfo__applicationfor__findingXY__coordinateson__the screen.Write__aprogram__named ocrscreen.pythat__takesa__screenshot,crops__theimage__tojust__thetext__portionin__the screenshot,then__passesit__onto__PyTesseract__for OCR.The__programshould__appendthe__recognizedtext__tothe__endof__atext__filenamed__output.txt.Here__isa__templatefor__the ocrscreen.py program:import__pyautogui #TODO__-Add__theadditionally__neededimport__statements. #The__coordinatesfor__thetext__portion.Change__as needed:LEFT__= 400TOP__= 200RIGHT__= 1000BOTTOM__= 800 #Capture__a screenshot:img__= pyautogui.screenshot() #Crop__thescreenshot__tothe__text portion:img__= img.crop((LEFT, TOP, RIGHT, BOTTOM)) #Run__OCRon__thecropped__image: #TODO__-Add__thePyTesseract__code here. #Add__theOCR__textto__theend__of output.txt: #TODO__-Call__open()in__appendmode__andappend__theOCR__text. 540Chapter__22Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23,you__llalso__learnhow__youcan__makeyour__scriptsimulate__keypresses__toscroll__theweb__pagefor__you.)Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__onlya__subsetof__PyAutoGUIs__features;you__canfind__thefull__documentationat__https://pyautogui__.readthedocs .io /.To__installthe__latestversion__ofPyAutoGUI__compatiblewith__this book,follow__theinstructions__inAppendix__A.WARNING__Dont__saveyour__programsas__pyautogui.py.If__you do,then__whenyou__runimport__pyautoguiPython__willimport__yourprogram__insteadof__PyAutoGUI,and__youll__geterror__messageslike__AttributeError:module__'pyautogui'has__noattribute__'click'.Setting__UpAccessibility__Appson__macOSAs__asecurity__measure,macOS__doesnt__normallylet__programscontrol__themouse__or keyboard.To__makePyAutoGUI__workon__macOS,you__mustset__theprogram__runningyour__Pythonscript__tobe__anaccessibility__application.Without__this step,your__PyAutoGUIfunction__callswill__haveno__effect.Whether__yourun__yourPython__programsfrom__Mu, IDLE,or__the Terminal,keep__thatapplication__open. Then,open__SystemPreferences__andgo__tothe__Accessibility tab.The__currentlyopen__applicationswill__appearunder__theAllow__theapps__belowto__controlyour__computer label.Check__Mu, IDLE, Terminal,or__whicheverapp__youuse__torun__yourPython__scripts.You__llbe__promptedto__enteryour__passwordto__confirmthese__changes.Staying__onTrack__Beforeyou__jumpinto__aGUI__automation,you__shouldknow__howto__escapeproblems__thatmay__arise.Python__canmove__yourmouse__andtype__keystrokesat__anincredible__speed.In__fact,it__mightbe__toofast__forother__programsto__keepup__with. Also,if__somethinggoes__wrongbut__yourprogram__keepsmov__ingthe__mouse around,it__willbe__hardto__tellexactly__whatthe__programis__doingor__howto__recoverfrom__the problem.Like__theenchanted__broomsfrom__TheSorcerer__sApprentice__sequencein__Disneys__Fantasia,which__keptfilling__(andthen__overfilling)Mickey__stub__with water,your__programcould__getout__ofcontrol__eventhough__its__followingyour__instructions perfectly.Stopping__theprogram__canbe__difficultif__themouse__ismoving__aroundon__its own,preventing__youfrom__clickingthe__MuEditor__windowto__close it.Controlling__theKeyboard__andMouse__543Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21.The__origin,where__xand__yare__both zero,is__atthe__upper-leftcorner__ofthe__screen.The__x-coordinates__increasegoing__tothe__right,and__the y-coordinatesincrease__going down.All__coordinatesare__positive integers;there__areno__negative coordinates. 544Chapter__23Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21,creating__theimage__bycontrolling__themouse__todraw__itin__MSPaint__letsyou__makeuse__ofthis__programs__variousbrush__styles,as__shownin__Figure 23-2on__the right,as__wellas__otheradvanced__features,such__asgradients__orthe__fill bucket.You__canpreselect__thebrush__settingsyourself__(orhave__yourPython__codeselect__these settings)and__thenrun__the spiral-drawing program.Figure__23-2:The__resultsfrom__the pyautogui.drag() example,drawn__withMS__Paints__differentbrushes__Youcould__drawthis__spiralby__hand (or rather,by__mouse),but__youd__haveto__workslowly__tobe__so precise.PyAutoGUI__cando__itin__afew__seconds!Scrolling__Thefinal__PyAutoGUImouse__functionis__scroll(),to__whichyou__passan__integer__argumentfor__howmany__unitsyou__wantto__scrollthe__mouseup__or down.Controlling__theKeyboard__andMouse__549Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsof__the screen.These__functionscan__alsoreturn__aPillow__Imageobject__ofthe__currentscreen__s appearance.If__youve__beenskipping__aroundin__this book,you__llwant__toread__Chapter 21and__installthe__Pillowpackage__beforecontinuing__withthis__section.To__takescreenshots__in Python,call__the pyautogui.screenshot() function.Enter__thefollowing__intothe__interactive shell: >>>import__pyautogui >>>im__= pyautogui.screenshot()The__imvariable__willcontain__theImage__objectof__the screenshot.You__cannow__callmethods__onthe__Imageobject__inthe__im variable,just__likeany__otherImage__object.Chapter__21has__moreinformation__aboutImage__objects.Controlling__theKeyboard__andMouse__551Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter,you__cansee__howeasy__itis__towrite__ascript__that could, say,sign__upfor__billionsof__freeemail__accountsor__floodusers__withharassing__messages.Captchas__mitigatethis__byrequiring__astep__thatonly__ahuman__can pass.Not__allwebsites__implement captchas, however,and__thesesites__canbe__vulnerableto__abuseby__unethical programmers.Learning__tocode__isa__powerfuland__exciting skill,and__youmay__betempted__tomisuse__thispower__forpersonal__gainor__evenjust__toshow__off.But__justas__anunlocked__doorisn__tjustification__for trespass,the__responsibilityfor__yourprograms__fallsupon__you,the__programmer.There__isnothing__cleverabout__circumventingsystems__tocause__harm,invade__privacy,or__gainunfair__advantage.I__hopethat__myefforts__inwriting__thisbook__enableyou__tobecome__yourmost__productive self,rather__thana__mercenary one. 558Chapter__23Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 5to__keepa__logfileof__whatyour__scripthas__done.This__way,if__youhave__tostop__yourscript__halfwaythrough__a process,you__canchange__itto__pickup__fromwhere__itleft__off.Add__asmany__checksas__youcan__toyour__script.Think__abouthow__itcould__failif__anunexpected__pop-upwindow__appearsor__ifyour__computerloses__itsinternet__connection. 562Chapter__23Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovered__manydifferent__functions,here__isa__quicksummary__touse__as reference: moveTo(x, y)Moves__themouse__cursorto__thegiven__x-and__y-coordinates move(xOffset, yOffset)Moves__themouse__cursorrelative__toits__currentposition__dragTo(x, y)Moves__themouse__cursorwhile__theleft__buttonis__helddown__drag(xOffset, yOffset)Moves__themouse__cursorrelative__toits__currentposition__whilethe__leftbutton__isheld__down click(x, y, button)Simulates__aclick__(leftbutton__by default) rightClick()Simulates__a right-buttonclick__middleClick()Simulates__a middle-buttonclick__doubleClick()Simulates__adouble__left-buttonclick__mouseDown(x, y, button)Simulates__pressingthe__givenbutton__atthe__position x,y__mouseUp(x, y, button)Simulates__releasingthe__givenbutton__atthe__position x,y__scroll(units)Simulates__thescroll__wheel;a__positiveargument__scrolls up,and__anegative__argumentscrolls__down write(message)Types__thecharacters__inthe__givenmessage__string write([key1, key2, key3])Types__thegiven__keyboardkey__strings press(key)Presses__thegiven__keyboardkey__string keyDown(key)Simulates__pressingthe__givenkeyboard__key keyUp(key)Simulates__releasingthe__givenkeyboard__keyControlling__theKeyboard__andMouse__563Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 21for__informationon__Image objects) getActiveWindow(), getAllWindows(), getWindowsAt(),and__getWindowsWithTitle()Return__Windowobjects__thatcan__resizeand__repositionapplication__windowson__thedesktop__getAllTitles()Returns__alist__ofstrings__ofthe__titlebar__textof__everywindow__onthe__desktopDisplaying__MessageBoxes__Theprograms__youve__beenwriting__sofar__alltend__touse__plaintextoutput__(withthe__print() function)and__input (withthe__input() function). However,PyAutoGUI__programswill__useyour__entiredesktop__asits__playground.The__text-basedwindow__thatyour__programruns__in,whether__its__Muor__aterminal__window,will__probablybe__lostas__yourPyAutoGUI__programclicks__andinteracts__withother__windows.This__canmake__gettinginput__andoutput__fromthe__userdifficult__ifthe__Muor__terminalwindow__getshidden__underother__windows.To__solve this,PyAutoGUI__includesthe__PyMsgBoxmodule__tocreate__pop-upnotifications__tothe__userand__receiveinput__from them.There__arefour__messagebox__functions: pyautogui.alert(text)Displays__textand__hasa__singleOK__buttonpyautogui__.confirm(text)Displays__textand__hasOK__andCancel__buttons,returning__either 'OK'or__'Cancel'depending__onthe__buttonclicked__pyautogui.prompt(text)Displays__textand__hasa__textfield__forthe__userto__type in,which__itreturns__asa__string pyautogui.password(text)Is__thesame__as prompt(),but__displaysasterisks__sothat__theuser__canenter__sensitiveinformation__suchas__apassword__Thesefunctions__areidentical__tothe__fourcovered__inthe__Pop-UpMessage__Boxeswith__PyMsgBoxin__Chapter 12.Summary__GUIautomation__withthe__PyAutoGUIpackage__allowsyou__tointeract__withapplications__onyour__computerby__controllingthe__mouseand__keyboard.While__thisapproach__isflexible__enoughto__doanything__thata__humanuser__can do,the__downsideis__thatthese__programsare__fairlyblind__towhat__theyare__clickingor__typing.When__writingGUI__automation programs,try__toensure__564Chapter__23Automate__theBoring__Stuffwith__Python, 3rdedition__(contentsto__knowwhether__ithas__gottenoff__track.You__caneven__givePyAutoGUI__ascreenshot__andlet__itfigure__outthe__coordinatesof__thearea__youwant__to click.You__cancombine__allof__thesePyAutoGUI__featuresto__automateany__mindlesslyrepetitive__taskon__your computer.In__fact,it__canbe__downrighthypnotic__towatch__themouse__cursormove__onits__ownand__tosee__textappear__onthe__screen automatically.Why__notspend__thetime__yousaved__bysitting__backand__watchingyour__programdo__allyour__workfor__you?There__sa__certainsatisfaction__thatcomes__fromseeing__howyour__clevernesshas__savedyou__fromthe__boring stuff.Practice__Questions 1.How__canyou__triggerPyAutoGUI__s fail-safeto__stopa__program? 2.What__functionreturns__thecurrent__screen resolution? 3.What__functionreturns__thecoordinates__forthe__mousecursor__scurrent__position? 4.What__isthe__differencebetween__pyautogui.moveTo()and__pyautogui.move()? 5.What__functionscan__beused__todrag__the mouse? 6.What__functioncall__willtype__outthe__charactersof__"Hello, world!"? 7.How__canyou__dokeypresses__forspecial__keys,such__asthe__keyboards__leftarrow__key? 8.How__canyou__savethe__currentcontents__ofthe__screento__animage__filenamed__screenshot.png? 9.What__codewould__seta__two-secondpause__afterevery__PyAutoGUIfunc__tion call? 10.If__youwant__toautomate__clicksand__keystrokesinside__aweb__browser,should__youuse__PyAutoGUIor__Selenium? 11.What__makesPyAutoGUI__error-prone? 12.How__canyou__findthe__sizeof__everywindow__onthe__screenthat__includesthe__wordNotepad__inits__title? 13.How__canyou__make, say,the__Firefoxbrowser__activeand__infront__ofevery__otherwindow__onthe__screen?Practice__ProgramsFor__practice,write__programsto__dothe__following tasks.Controlling__theKeyboard__andMouse__565Automate__theBoring__Stuffwith__Python, 3rdedition__(chaptercovers__a text-to-speech package, pyttsx3,and__aspeech__recognition package, Whisper. Text-to-speechpackages__canconvert__textstrings__intospoken__words,then__sendthem__toyour__computers__speakersor__savethem__toan__audio file.By__addingthis__newdimension__toyour__programs,you__canfree__theuser__fromhaving__toread__textoff__a screen.For__example,a__cookingrecipe__applicationcould__readthe__ingredientslist__aloudas__youmove__throughthe__kitchen,and__yourdaily__scriptcould__scrapenews__articles (oryour__emails)and__thenprepare__an MP3to__playdur__ingyour__morning commute.On__theother__end,speech__recognitiontechnologies__canconvert__audiofiles__ofspoken__wordsinto__textstring__values.You__canuse__thiscapability__to 24 TEXT-TO -SPE__ECHANDS__PEECH__RECOG__NITION__ENG__INE__S 568Chapter__24Automate__theBoring__Stuffwith__Python, 3rdedition__(chapteraren__tlimited__to English,and__workwith__mostwidely__spokenhuman__languages. Text-to-SpeechEngine__Toproduce__spoken audio,the__pyttsx3 third-partypackage__usesyour__operating__systems__built-in text-to-speech engine:Microsoft__SpeechAPI__(SAPI5)on__Windows,NSSpeechSynthesizer__on macOS,and__eSpeakon__Linux.On__Linux,you__mayneed__toinstall__theengine__byrunning__sudoapt__installespeak__froma__terminal window.You__caninstall__pyttsx3by__runningpip__install pyttsx3from__a terminal.Appendix__Ahas__fullinstructions__forinstall__ing third-party packages.The__nameof__thepackage__isbased__onpy__for Python,tts__for text-to-speech,x__becauseit__sextended__fromthe__originalpytts__package,and__3because__its__forPython__3.Generating__SpeechProducing__acomputerized__voiceis__acomplex__topicin__computer science. Fortunately,the__operatingsystem__s text-to-speechengine__doesthe__hardwork__for us,and__interactingwith__thisengine__is straightforward.Open__anew__file editor,enter__thefollowing__code,and__saveit__as hello_tts.py:import__pyttsx3engine__= pyttsx3 .init() engine.say('Hello.How__areyou__doing?') engine.runAndWait() #The__computer speaks.feeling__= input('>') engine.say('Yes.I__amfeeling__' +feeling__+ 'as__well.') engine.runAndWait() #The__computerspeaks__again.After__importingthe__pyttsx3 module,we__callthe__pyttsx3 .init()function__toinitialize__thespeech__engine.This__functionreturns__anEngine__object.We__canpass__astring__oftext__toits__say()method__totell__theengine__whatto__speak,but__theactual__speakingwon__tbegin__untilwe__callthe__runAndWait() method.This__methodblocks__(that is,will__not return)until__thecomputer__hasfin__ishedspeaking__theentire__string.The__programdoesn__tproduce__anytext__output,because__itnever__callsthe__print() function. Instead,you__shouldhear__yourcomputer__speak, Hello.How__areyou__doing? (Makesure__thevolume__isnt__muted.)The__usercan__entera__responsefrom__the keyboard,to__whichthe__computershould__verbally reply, Yes.I__amfeeling__as well. Text-to-Speechand__SpeechRecognition__Engines 569Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 24Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 24Automate__theBoring__Stuffwith__Python, 3rdedition__(chapterwith__whisper.load_model('base', device='cuda').You__canfind__severaladditional__optionsfor__Whisperin__itsonline__documentation.Creating__SubtitleFiles__Inaddition__tothe__transcribed audio,Whisper__sresults__dictionarycontains__timinginformation__thatidentifies__thetext__slocation__inthe__audio file.You__canuse__thistext__andtiming__datato__generatesubtitle__filesthat__othersoftware__can ingest.The__twomost__commonsubtitle__fileformats__areSRT__SubRipSubtitle__(withthe__.srt extension)and__VTTWeb__VideoText__Tracks (withthe__.vttfile__extension).SRT__isan__olderand__morewidespread__standard,while__modernvideo__websitesgenerally__use VTT.The__formatsare__similar.For__example,here__isthe__firstpart__ofan__SRT file: 1 00:00:00,000 --> 00:00:05,640Dinosaurs__area__diversegroup__ofreptiles__ofthe__clade dinosauria.They__first 2 00:00:05,640 --> 00:00:14,960appeared__duringthe__triassic period.Between__245and__233.23million__years ago. --snip--Compare__itwith__thefirst__partof__aVTT__filefor__thesame__subtitles:WEBVTT__00:00.000 --> 00:05.640Dinosaurs__area__diversegroup__ofreptiles__ofthe__clade dinosauria.They__first 00:05.640 --> 00:14.960appeared__duringthe__triassic period.Between__245and__233.23million__years ago. --snip--These__filesboth__indicatethat__thewords__Dinosaursare__adiverse__group . . .appear__betweenthe__startof__thetranscribed__audiofile__(at 0 seconds)and__the 5.640-second mark.Whisper__canalso__outputits__resultsas__TSVdata__(withthe__.tsv extension)or__JSONdata__(withthe__.json extension).TSV__isnt__anofficial__subtitlesfor__mat,but__itmay__beuseful__ifyou__needto__exportthe__textand__timingdata__to, say,another__Pythonprogram__thatcan__readit__usingthe__csvmodule__coveredin__Chapter 18. TSV-formattedsubtitles__looklike__the following: Text-to-Speechand__SpeechRecognition__Engines 573Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 24Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10.We__knowthe__mainpart__ofthe__fileis__'downloaded_content',but__thefile__extensioncould__beany__audio format.The__followingcode__usesPath__objectsto__findthe__exactdownloaded__filename: >>>from__pathlibimport__Path >>>matching_filenames__= list(Path().glob('downloaded_content.*')) >>>downloaded_filename__= str(matching_filenames[0]) >>>downloaded_filename__'downloaded_content.m4a'Setting__thefilename__makesit__easierfor__thecode__touse__thisfile__later,such__asby__runningit__throughWhisper__speech recognition.The__'base'and__'medium'models__createmuch__higher-qualitysubtitles__thanthe__YouTubes__current auto-generated subtitles. Text-to-Speechand__SpeechRecognition__Engines 575Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18),but__wecan__getit__ina__JSON-compatibleform__bycalling__ydl.sanitize() 3.The__dictionarythat__the sanitize()method__returnshas__several keys,including__'title'for__thename__ofthe__video, 'duration'for__thevideo__slength__in seconds,and__so on.Our__codehere__additionallywrites__thisJSON__datato__afile__named metadata.json 4.Summary__Oneof__Pythons__greatstrengths__isits__vastecosystem__of third-partypackages__fortasks__suchas__text-to-speechand__speech recognition.These__packagestake__someof__thehardest__problemsin__computerscience__andmake__themavailable__toyour__programswith__justa__fewlines__of code.The__pyttsx3package__does text-to-speechusing__yourcomputer__sspeech__engineto__createaudio__thatyou__caneither__playfrom__thespeakers__orsave__toa__.wav file.The__Whisperspeech__recognitionsystem__usesseveral__underlyingmodels__totranscribe__thewords__ofan__audio file.These__modelshave__different__sizes;the__smallermodels__transcribefaster__withless__accuracy,while__largermodels__areslower__butmore__accurate.They__workfor__manyhuman__languages,not__just English.Whisper__runson__yourcomputer__anddoesn__tconnect__toonline__serversexcept__todownload__themodel__onfirst__use. 576Chapter__24Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3and__adda__voicefeature__to it.Replace__allof__thefunction__callsto__print()with__callsto__afunction__named speak(). Next,define__the speak()function__toaccept__astring__argument__(justlike__print() did),but__haveit__bothprint__thestring__tothe__screenand__sayit__out loud.For__example,you__llreplace__thisline__ofcode__print('Iam__thinkingof__anumber__between 1and__20.')with__thisline__of code: speak('Iam__thinkingof__anumber__between 1and__20.')To__makefull__useof__the speech-generation feature,let__schange__the 'Yourguess__istoo__low.'and__'Yourguess__istoo__high.'text__tosay__theplayer__s guess.For__example,the__computershould__say,Your__guess, 42,is__too low.You__canalso__adda__voicefeature__toother__projectsin__this book,such__asthe__rock, paper,scissors__game. Text-to-Speechand__SpeechRecognition__Engines 577Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12.A__INS__TAL__LING__TH__IRD__-PA__RTYPACK__AGE__S 580Appendix__AAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 12.Running__pipfrom__VirtualEnvironments__Someoperating__systemsmay__notallow__youto__runpip__withoutfirst__creatingand__activatinga__virtualenvironment__usingPython__s built-invenv__module.For__learningPython__andexperimenting__with code,it__sfine__tocreate__onevirtual__environmentfor__allof__your programs.See__VirtualEnvironments__onpage__XXin__Chapter 12for__more details.Installing__thePackages__Usedin__ThisBook__Becausefuture__changesto__third-partymodules__maybe__incompatiblewith__thebook__scode__examples,I__recommendthat__youinstall__theexact__versionsInstalling__Third-PartyPackages__581Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 23s__PyAutoGUIpackage__on Linux,you__musttake__additional steps.Open__aterminal__windowand__runsudo__apt-getinstall__python3-tkand__sudo apt-getinstall__python3-dev.To__getChapter__8s__pyperclipmodule__workingon__Linux,you__mustrun__sudo apt-getinstall__xclip.You__llneed__thecomputer__sadministrator__password.As__of publication,these__commandsinstall__thefollowing__versionsof__packages: beautifulsoup4 == 4.12.3 matplotlib==3.92 openpyxl==3.1.5 pdfminer.six==20240706 pillow==10.4.0 playsound==1.3.0 playwright==1.47.0 PyPDF==5.0.1 python-docx==1.1.2 pyttsx3 == 2.98 PyYAML==6.0.2 requests==2.32.3 selenium==4.25.0 tomli_w==1.0.0 xmltodict==0.13.0In__addition,the__automateboringstuff3package__alwaysinstalls__thelatest__versionof__thethese__packages:bext__ezgmailezsheets__humrepyautogui__pymsgboxpyperclip__582Appendix__AAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 22and__the openai-whisperpackage__coveredin__Chapter 24are__fairly large,and__somereaders__maynot__wantto__install them,so__Ive__leftthem__outof__the automateboringstuff3pack__age.You__caninstall__themby__runningthe__followingon__Windows: C:\Users\al>pipinstall__pytesseract==0.3.10 C:\Users\al>pipinstall__openai-whisper==20231117On__macOSand__Linux,run__the following: al@Als-MacBook-Pro ~ % pip3install__pytesseract==0.3.10 al@Als-MacBook-Pro ~ % pip3install__openai-whisper==20231117If__youre__on Windows,you__mightsee__anerror__likethis__onewhen__installing__Whisper:A__modulethat__wascompiled__usingNumPy__1.xcannot__berun__inNumPy__2.0.1as__itmay__crashYou__canfix__thisissue__byrunning__pipinstall__"numpy<2"to__downgradeNumPy__toa__compatible version.Be__sureto__includethe__doublequotation__marks. Additionally,the__Whisperpackage__canmake__useof__yourcomputer__sNVIDIA__graphicscard__(GPU)to__performspeech__recognitionfaster__ifyou__runthis__command: C:\Users\al>pipinstall__torchtorchvision__torchaudio --index-url https://download .pytorch .org /whl /cu118Computers__with non-NVIDIAbrand__GPUs,including__all MacBooks,don__tsupport__this feature.Automate__theBoring__Stuffwith__Python, 3rdedition__(chapter.I__highlyrecommend__thatyou__takethe__timeto__workthrough__these problems.Programming__ismore__thanmemorizing__syntaxand__alist__offunction__names.As__whenlearning__aforeign__language,the__morepractice__youput__into it,the__moreyou__willget__outof__it.There__aremany__websiteswith__practiceprogramming__problemsas__well.You__canfind__alist__ofthese__at https://nostarch__.com /automate -boring -stuff -python -3rd -edition.When__itcomes__tothe__practice programs,there__isno__onecorrect__solu tion.As__longas__yourprogram__performswhat__theproject__asks for,you__canconsider__it correct. However,if__youwant__tosee__examplesof__completedproj__ects,they__areavailable__inthe__Downloadthe__filesused__inthe__booklink__at https://nostarch .com /automate -boring -stuff -python -3rd -edition.B__ANSWERSTO__THE__PRAC__TICE__PROBLEMS__584Appendix__BAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 1 1.The__operatorsare__+, -, *,and__/.The__valuesare__'hello', -88.8,and__5. 2.The__stringis__'spam';the__variableis__spam.Strings__alwaysstart__andend__with quotes. 3.The__threedata__typesintroduced__inthis__chapterare__integers, floating-point__numbers,and__strings. 4.An__expressionis__acombination__ofvalues__and operators.All__expressionsevaluate__(that is, reduce)to__asingle__value. 5.An__expressionevaluates__toa__single value.A__statementdoes__not. 6.The__baconvariable__isset__to 20.The__bacon + 1expression__doesnot__reassignthe__valuein__bacon (thatwould__needan__assignment statement:bacon__=bacon__+ 1). 7.Both__expressionsevaluate__tothe__string 'spamspamspam'. 8.Variable__namescannot__beginwith__a number. 9.The__int(), float(),and__str()functions__willevaluate__tothe__integer,float__ing-point number,and__stringversions__ofthe__valuepassed__to them. 10.The__expressioncauses__anerror__because 99is__an integer,and__onlystrings__canbe__concatenatedto__otherstrings__withthe__+ operator.The__correctway__isI__haveeaten__' + str(99) + ' burritos.'Chapter__2 1.True__and False,using__capitalT__and F,with__therest__ofthe__wordin__lowercase. 2. and, or,and__not 3.True__andTrue__is True.True__andFalse__is False.False__andTrue__is False.False__andFalse__is False.True__orTrue__is True.True__orFalse__is True.False__orTrue__is True.False__orFalse__is False.not__Trueis__False.not__Falseis__True. 4.False__FalseTrue__FalseFalse__True 5. ==, !=, <, >, <=,and__>=Answers__tothe__PracticeProblems__585Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 3 1.Press__ctrl-Cto__stopa__programstuck__inan__infinite loop. 2.The__breakstatement__willmove__theexecution__outsideand__justafter__a loop.The__continuestatement__willmove__theexecution__tothe__startof__the loop. 3.They__alldo__thesame__thing.The__range(10)call__rangesfrom__0up__to (butnot__including) 10, range(0, 10)explicitly__tellsthe__loopto__startat__0,and__range(0, 10, 1)explicitly__tellsthe__loopto__increasethe__variableby__1on__each iteration. 4.The__code:for__iin__range(1, 11): print(i) and:i__= 1while__i <= 10: print(i)i__=i__+ 1 5.This__functioncan__becalled__with spam.bacon(). 586Appendix__BAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 4 1.Functions__reducethe__needfor__duplicate code.This__makesprograms__shorter,easier__to read,and__easierto__update. 2.The__codein__afunction__executeswhen__thefunction__is called,not__whenthe__functionis__defined. 3.The__defstatement__defines (that is, creates)a__function. 4.A__functionconsists__ofthe__defstatement__andthe__codein__itsdef__clause.A__functioncall__iswhat__movesthe__programexecution__intothe__function,and__thefunction__callevaluates__tothe__functions__return value. 5.There__isone__global scope,and__alocal__scopeis__createdwhenever__afunc__tionis__called. 6.When__afunction__returns,the__localscope__is destroyed,and__allthe__variables__init__are forgotten. 7.A__returnvalue__isthe__valuethat__afunction__callevaluates__to.Like__any value,a__returnvalue__canbe__usedas__partof__an expression. 8.If__thereis__noreturn__statementfor__a function,its__returnvalue__is None. 9.A__globalstatement__willforce__avariable__ina__functionto__referto__theglobal__variable. 10.The__datatype__ofNone__is NoneType. 11.That__importstatement__importsa__modulenamed__areallyourpetsnamederic. (Thisisn__ta__realPython__module,by__the way.) 12.This__functioncan__becalled__with spam.bacon(). 13.Place__theline__ofcode__thatmight__causean__errorin__atry__clause. 14.The__codethat__couldpotentially__causean__errorgoes__inthe__try clause.The__codethat__executesif__anerror__happensgoes__inthe__except clause. 15.The__random_numberglobal__variableis__setonce__toa__random number,and__therandom_number__variablein__the get_random_dice_roll()function__usesthe__global variable.This__meansthe__samenumber__isreturned__forevery__get _random_dice_roll()function__call.Chapter__5 1.assert__spam >= 10, 'Thespam__variableis__lessthan__10.' 2.Either__assert eggs.lower() != bacon.lower() 'Theeggs__andbacon__variablesare__the same!'or__assert eggs.upper() != bacon.upper(), 'Theeggs__andbacon__variablesare__the same!' 3.assert__False, 'Thisassertion__always triggers.' 4.To__beable__tocall__logging.debug(),you__musthave__thesetwo__linesat__thestart__ofyour__program:import__logging logging.basicConfig(level=logging.DEBUG, format=' %(asctime)s - %(levelname)s - %(message)s')Answers__tothe__PracticeProblems__587Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 6 1.The__emptylist__value,which__isa__listvalue__thatcontains__no items.This__issimilar__tohow__''is__theempty__string value. 2. spam[2] = 'hello' (Noticethat__thethird__valuein__alist__isat__index 2because__thefirst__indexis__0.) 3. 'd' (Notethat__'3' * 2is__thestring__'33',which__ispassed__to int()before__beingdivided__by 11.This__eventuallyevaluates__to 3.Expressions__canbe__usedwherever__valuesare__used.) 4. 'd' (Negativeindexes__countfrom__the end.) 5. ['a', 'b'] 6. 1 7. [3.14, 'cat', 11, 'cat', True, 99] 8. [3.14, 11, 'cat', True] 9.The__operatorfor__listconcatenation__is +,while__theoperator__forreplica__tionis__*. (Thisis__thesame__asfor__strings.) 10.While__append()will__addvalues__onlyto__theend__ofa__list, insert()can__addthem__anywherein__the list. 11.The__delstatement__andthe__remove()list__methodare__twoways__toremove__valuesfrom__a list. 588Appendix__BAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 7 1.Two__curly brackets: {} 2. {'foo': 42} 3.The__itemsstored__ina__dictionaryare__unordered,while__theitems__ina__listare__ordered. 4.You__geta__KeyError error. 5.There__isno__difference.The__inoperator__checkswhether__avalue__existsas__akey__inthe__dictionary. 6.The__expression 'cat'in__spamchecks__whetherthere__isa__'cat'key__inthe__dictionary,while__'cat'in__spam.values()checks__whetherthere__isa__value 'cat'for__oneof__thekeys__in spam. 7. spam.setdefault('color', 'black') 8. pprint.pprint()Chapter__8 1.Escape__charactersrepresent__charactersin__stringvalues__thatwould__otherwise__bedifficult__orimpossible__totype__into code. 2.The__\nescape__characteris__a newline;the__\tescape__characteris__a tab. 3.The__\\escape__characterwill__representa__backslash character. 4.The__singlequote__in Howl'sis__finebecause__youve__useddouble__quotesto__markthe__beginningand__endof__the string. 5.Multiline__stringsallow__youto__usenewlines__instrings__withoutthe__\nescape__character. 6.The__expressionsevaluate__tothe__following: 'e' 'Hello' 'Hello' 'lo world!Answers__tothe__PracticeProblems__589Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 9 1.The__re .compile()function__createsRegex__objects. 2.Raw__stringsare__usedso__thatbackslashes__donot__haveto__be escaped. 3.The__search()method__returnsMatch__objects. 4.The__group()method__returnsstrings__ofthe__matched text. 5.Group__0is__theentire__match,group__1covers__thefirst__setof__parentheses,and__group 2covers__thesecond__setof__parentheses. 6.Periods__andparentheses__canbe__escapedwith__a backslash: \., \(,and__\). 7.If__theregex__hasno__groups,a__listof__stringsis__returned.If__theregex__has groups,a__listof__tuplesof__stringsis__returned. 8.The__|character__signifiesmatching__either,or__betweentwo__groups. 9.The__?character__caneither__meanmatch__zeroor__oneof__thepreceding__groupor__beused__tosignify__nongreedy matching. 10.The__+matches__oneor__more.The__*matches__zeroor__more. 11.The__{3}matches__exactlythree__instancesof__thepreceding__group.The__{3,5}matches__betweenthree__andfive__instances. 12.The__\d, \w,and__\sshorthand__characterclasses__matcha__single digit, word,or__space character, respectively. 13.The__\D, \W,and__\Sshorthand__characterclasses__matcha__singlecharacter__thatis__nota__digit, word,or__space character, respectively. 14.The__.*performs__agreedy__match,and__the .*?performs__anongreedy__match. 15.Either__[0-9a-z]or__[a-z0-9]. 16.Passing__re.Ior__re.IGNORECASEas__thesecond__argumentto__re .compile()will__makethe__matchingcase__insensitive. 17.The__.character__normallymatches__anycharacter__exceptthe__newline character.If__re.DOTALLis__passedas__thesecond__argumentto__re .compile(),then__thedot__willalso__matchnewline__characters. 18.The__sub()call__willreturn__thestring__'X drummers,X__pipers,five__rings,X__hens'. 590Appendix__BAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 10 1.Relative__pathsare__relativeto__thecurrent__working directory. 2.Absolute__pathsstart__withthe__root folder,such__as /or__C:\. 3.On__Windows,it__evaluatesto__WindowsPath('C:/Users/Al').On__otheroperat__ing systems,it__evaluatesto__adifferent__kindof__Pathobject__butwith__thesame__path. 4.The__expression 'C:/Users' / 'Al'results__inan__error,since__youcan__tuse__the /operator__tojoin__two strings. 5.The__os.getcwd()function__returnsthe__currentworking__directory.The__os.chdir()function__changesthe__currentworking__directory. 6.The__.folder__isthe__current folder,and__..is__theparent__folder. 7. C:\bacon\eggsis__thedirectory__name,while__spam.txtis__thebase__name. 8.The__string 'r'for__read mode, 'w'for__write mode,and__'a'for__append mode. 9.An__existingfile__openedin__writemode__iserased__andcompletely__overwritten. 10.The__read()method__returnsthe__files__entirecontents__asa__singlestring__value.The__readlines()method__returnsa__listof__strings,where__eachstring__isa__linefrom__thefile__s contents. 11.A__shelfvalue__resemblesa__dictionary value;it__haskeys__and values,along__with keys()and__values()methods__thatwork__similarlyto__thedictionary__methodsof__thesame__names.Chapter__11 1.The__shutil .copy()function__willcopy__asingle__file,while__shutil .copytree()will__copyan__entire folder,along__withall__its contents. 2.The__shutil.move()function__isused__forrenaming__files,as__wellas__moving them. 3.The__send2trashfunction__willmove__afile__orfolder__tothe__recycle bin,while__shutilwill__permanentlydelete__filesand__folders. 4.The__zipfile.ZipFile()function__isequivalent__tothe__open() function;the__firstargument__isthe__filename,and__thesecond__argumentis__themode__toopen__theZIP__filein__(read, write,or__append).Chapter__12 1.The__dircommand__listsfolder__contentson__Windows.The__lscommand__listsfolder__contentson__macOSand__Linux. 2.The__PATHenvironment__variablecontains__alist__offolders__thatare__checkedwhen__aprogram__nameis__enteredinto__the terminal.Answers__tothe__PracticeProblems__591Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 13 1.The__webbrowsermodule__hasan__open()method__thatwill__launcha__webbrowser__toa__specific URL,and__thats__it.The__requestsmodule__candown__loadfiles__andpages__fromthe__web.The__bs4module__parses HTML. 2.The__requests.get()function__returnsa__Response object,which__hasa__textattribute__thatcontains__thedownloaded__contentas__a string. 3.The__raise_for_status()method__raisesan__exceptionif__thedownload__hadproblems__anddoes__nothingif__thedownload__succeeded. 4.The__status_codeattribute__ofthe__Responseobject__containsthe__HTTPsta__tus code. 5.After__openingthe__newfile__onyour__computerin__'wb'write__binary mode,use__afor__loopthat__iteratesover__theResponse__objects__iter_con tent()method__towrite__outchunks__tothe__file.Here__san__example:saveFile__= open('filename .html', 'wb')for__chunkin__res.iter_content(100000): saveFile.write(chunk) 6.Most__onlineAPIs__returntheir__responsesformatted__asJSON__or XML. 7. F12brings__upthe__developertools__in Chrome.Pressing__ctrl-shift-C (onWindows__and Linux)or__-option-C (onOS__X)brings__upthe__developertools__in Firefox. 8. Right-clickthe__elementin__thepage__andselect__InspectElement__fromthe__menu. 9. '#main' 10. '.highlight' 11. spam.getText() 12. linkElem.attrs 13.The__seleniummodule__isimported__withfrom__seleniumimport__webdriver. 14.The__find_element_*methods__returnthe__firstmatching__elementas__aWebElement__object.The__find_elements_*methods__returna__listof__allmatch__ingelements__asWebElement__objects. 15.The__click()and__send_keys()methods__simulatemouse__clicksand__keyboard__keys, respectively. 592Appendix__BAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 14 1.The__openpyxl.load_workbook()function__returnsa__Workbook object. 2.The__sheetnamesattribute__containsa__listof__stringsof__theworksheet__titles. 3.Run__wb['Sheet1']. 4.Use__wb.active. 5. sheet['C5'].valueor__sheet.cell(row=5, column=3).value 6. sheet['C5'] = 'Hello'or__sheet.cell(row=5, column=3).value = 'Hello' 7. cell.rowand__cell .column 8.They__holdthe__highestcolumn__androw__withvalues__inthe__sheet,respec__tively,as__integer values. 9 .openpyxl__.cell .column_index___from _string('M') 10. openpyxl.cell.get_column_letter(14) 11. sheet['A1':'F1'] 12. wb.save('example3.xlsx') 13.A__formulais__setthe__sameway__asany__value.Set__thecell__svalue__attributeto__astring__ofthe__formula text.Remember__thatformulas__beginwith__theequal__sign (=). 14.Pass__data_only=Truewhen__calling load_workbook()to__makeOpenPyXL__retrievethe__calculatedresults__of formulas. 15. sheet.row_dimensions[5].height = 100 16 .sheet__.column _dimensions['C'] .hidden =True__17.Freeze__panesare__rowsand__columnsthat__willalways__appearon__the screen.They__areuseful__for headers. 18. openpyxl.chart.Reference(), openpyxl.chart.Series(), openpyxl.chart. BarChart(), chartObj.append(seriesObj),and__add_chart()Chapter__15 1.To__accessGoogle__Sheets,you__needa__credentials file,a__tokenfile__forGoogle__Sheets,and__atoken__filefor__Google Drive. 2.EZSheets__has ezsheets.Spreadsheetand__ezsheets.Sheet objects. 3.Call__the downloadAsExcel()Spreadsheet__method. 4.Call__the ezsheets.upload()function__andpass__thefilename__ofthe__Excel file. 5.Read__thevalue__at ss['Students']['B2']. 6.Call__ezsheets.getColumnLetterOf(999).Answers__tothe__PracticeProblems__593Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 16 1.conn__= sqlite3 .connect('example .db', isolation_level=None) 2. conn.execute('CREATETABLE__students (first_name TEXT,last_name__TEXT,favorite_color__TEXT) STRICT') 3.Pass__the isolation_level=Nonekeyword__argumentwhen__calling sqlite3 .connect(). 4.While__INTEGERis__analogousto__Pythons__int type,REAL__isanalogous__toPython__sfloat__type. 5.Strict__modeadds__arequirement__thatevery__columnmust__havea__data type,and__SQLiteraises__anexception__ifyou__tryto__insertdata__ofthe__wrong type. 6.The__*means__selectall__columnsin__the table. 7.CRUD__standsfor__Create, Read, Update,and__Delete,the__fourstandard__operationsthat__databases perform. 8.ACID__standsfor__Atomic, Consistent, Isolated,and__Durable,the__fourproperties__thatdatabase__transactionsshould__have. 9.INSERT__queriesadd__newrecords__to tables. 10.DELETE__queriesdelete__recordsfrom__tables. 11.Without__aWHERE__clause,the__UPDATEquery__appliesto__allrecords__inthe__table,which__mayor__maynot__bewhat__you want. 12.An__indexis__adata__structurethat__organizesa__columns__data,which__takesup__morestorage__butmakes__queries faster. 'CREATEINDEX__idx_birthdateON__cats (birthdate)'would__createan__indexfor__thecats__tables__birthdate column. 13.A__foreignkey__linksrecords__inone__tableto__arecord__inanother__table. 14.You__candelete__atable__namedcats__byrunning__thequery__'DROPTABLE__cats'. 15.The__string ':memory:'is__usedin__placeof__afilename__tocreate__an in-memory__database. 16.The__iterdump()method__cancreate__thequeries__tocopy__a database.You__canalso__copythe__databasefile__itself.Chapter__17 1.A__Fileobject__mustbe__openedin__writemode__bypassing__'w'to__open(). 2.Calling__getPage(4)will__returna__Pageobject__forpage__5,since__page 0is__thefirst__page. 594Appendix__BAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 18 1.In__Excel,spreadsheets__canhave__valuesof__datatypes__otherthan__strings;cells__canhave__different fonts, sizes,or__color settings;cells__canhave__varyingwidths__and heights;adjacent__cellscan__be merged;and__youcan__embedimages__and charts. 2.You__passa__File object,obtained__froma__callto__open(). 3.File__objectsneed__tobe__openedin__read-binary ('rb')mode__forReader__objectsand__write-binary ('wb')mode__forWriter__objects. 4.The__writerow() method. 5.The__delimiterargument__changesthe__stringused__toseparate__cellsin__a row.The__lineterminatorargument__changesthe__stringused__toseparate__rows. 6.All__ofthem__canbe__easilyedited__witha__text editor: CSV, JSON,and__XMLare__plaintext formats. 7. json.loads() 8. json.dumps() 9.XML__sformat__resembles HTML. 10.JSON__representsNone__valuesas__thekeyword__null. 11.Boolean__valuesin__JSONare__writtenin__lowercase:true__and false.Chapter__19 1.A__referencemoment__thatmany__dateand__timeprograms__use.The__momentis__January 1, 1970, UTC. 2. time.time() 3. time.asctime() 4. time.sleep(5)Answers__tothe__PracticeProblems__595Automate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 20 1.The__credentials.jsonand__token.jsonfiles__tellthe__EZGmailmodule__whichGoogle__accountto__usewhen__accessing Gmail. 2.A__messagerepresents__asingle__email,while__a back-and-forthconversa__tioninvolving__multipleemails__isa__thread. 3.Include__the 'has:attachment'text__inthe__stringyou__passto__search(). 4.SMS__emailgateways__arenot__guaranteedto__work,don__tnotify__youif__themessage__was delivered,and__justbecause__theyworked__beforedoes__notmean__theywill__work again. 5.The__Requestslibrary__cansend__andreceive__ntfy notifications.Chapter__21 1.An__RGBAvalue__isa__tupleof__four integers,each__rangingfrom__0to__255.The__fourintegers__correspondto__theamount__of red, green, blue,and__alpha (transparency)in__the color. 2.Calling__ImageColor.getcolor('CornflowerBlue', 'RGBA')will__return (100, 149, 237, 255),the__RGBAvalue__forthe__cornflowerblue__color. 3.A__boxtuple__isa__tuplevalue__offour__integers:the__left-edge x-coordinate,the__top-edge y-coordinate,the__width,and__the height, respectively. 4. Image.open('zophie.png') 5. im.sizeis__atuple__oftwo__integers,the__widthand__the height. 6. im.crop((0, 50, 50, 50)).Notice__thatyou__arepassing__abox__tupleto__crop(),not__fourseparate__integer arguments. 7.Call__the im.save('new_filename.png')method__ofthe__Image object. 8.The__ImageDrawmodule__containscode__todraw__on images. 9.ImageDraw__objectshave__shape-drawingmethods__suchas__point(), line(),or__rectangle().They__arereturned__bypassing__theImage__objectto__the ImageDraw.Draw() function. 10. plt.plot()creates__aline__graph, plt.scatter()creates__a scatterplot, plt. bar()creates__abar__graph,and__plt.pie()creates__apie__chart. 11.The__savefig()method__savesthe__graphas__an image. 12.You__cannotcall__plt.show()twice__ina__rowbecause__itresets__thegraph__data,forcing__youto__runthe__graph-makingcode__againif__youwant__toshow__ita__second time. 596Appendix__BAutomate__theBoring__Stuffwith__Python, 3rdedition__(Chapter 22 1.Tesseract__recognizesEnglish__by default. 2.PyTesseract__workswith__thePillow__image library. 3.The__image_to_string()function__acceptsan__Imageobject__andreturns__a string. 4. No,Tesseract__onlyextracts__textfrom__scanneddocuments__oftypewritten__textand__nottext__from photographs. 5. tess.get_languages()returns__alist__oflanguage__pack strings. 6.You__canpass__the lang='eng+jpn'keyword__argumentto__identifyboth__Englishand__Japanesetext__inan__image. 7. NAPS2can__berun__froma__Pythonscript__tocreate__PDFswith__embeddedOCR__text.Chapter__23 1.Move__themouse__toany__cornerof__the screen. 2.The__pyautogui.size()function__returnsa__tuplewith__twointegers__forthe__widthand__heightof__the screen. 3.The__pyautogui.position()function__returnsa__tuplewith__twointegers__forthe__x-and__y-coordinatesof__themouse__cursor. 4.The__moveTo()function__movesthe__mouseto__absolutecoordinates__onthe__screen,while__the move()function__movesthe__mouserelative__tothe__mouses__current position. 5. pyautogui.dragTo()and__pyautogui.drag() 6. pyautogui.typewrite('Hello world!') 7.Either__passa__listof__keyboardkey__stringsto__pyautogui.write() (suchas__'left')or__passa__singlekeyboard__keystring__to pyautogui.press(). 8. pyautogui.screenshot('screenshot.png') 9. pyautogui.PAUSE = 2 10.You__shoulduse__Seleniumfor__controllinga__webbrowser__insteadof__PyAutoGUI. 11.PyAutoGUI__clicksand__typesblindly__andcannot__easilyfind__outif__its__clickingand__typinginto__thecorrect__windows.Unexpected__pop-upwin__dowsor__errorscan__throwthe__scriptoff__trackand__requireyou__toshut__it down. 12.Call__the pyautogui.getWindowsWithTitle('Notepad') function. 13.Run__w = pyatuogui.getWindowsWithTitle('Firefox'),and__thenrun__w.activate().Chapter__24 1.Call__engine.setProperty('rate', 300),for__example,to__make pyttsx3s__voicespeak__at 300words__per minute.Answers__tothe__PracticeProblems__597Automate__theBoring__Stuffwith__Python, 3rdedition__(Early Access) 2025by__AlSweigart__2.The__pyttsx3module__savesto__theWAV__audio format. 3. No, pyttsx3and__Whisperdo__notrequire__anonline__serviceor__internet access. 4. Yes, pyttsx3and__Whispersupport__languagesother__than English. 5.Whisper__sdefault__modelis__'base'. 6.SRT__(SubRip Subtitle)and__VTTWeb__VideoText__Tracksare__twocom__monsubtitle__file formats. 7. Yes, yt-dlpcan__downloadfrom__hundredsof__videowebsites__otherthan__YouTube.Automate__theBoring__Stuffwith__Python, 3rdedition__(Early Access) 2025by__AlSweigart__